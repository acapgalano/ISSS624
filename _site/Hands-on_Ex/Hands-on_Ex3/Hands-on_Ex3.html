<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ISSS624 - Hands-on Exercise 3: Geographical Segmentation with Spatially Constrained Clustering Techniques</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS624</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex0.html">
 <span class="dropdown-text">Hands-on Exercise 0 (Introduction to Quarto)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex1/Hands-on_Ex1-1.html">
 <span class="dropdown-text">Hands-on Exercise 1.1 (Geospatial Data Wrangling with R)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex1/Hands-on_Ex1-2.html">
 <span class="dropdown-text">Hands-on Exercise 1.2 (Chloropleth Mapping with R)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex2/Hands-on_Ex2.html">
 <span class="dropdown-text">Hands-on Exercise 2 (Global and Local Measures of Spatial Autocorrelation)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html">
 <span class="dropdown-text">Hands-on Exercise 3 (Geographical Segmentation with Spatially Constrained Clustering Techniques)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex4/Hands-on_Ex4.html">
 <span class="dropdown-text">Hands-on Exercise 4 (Calibrating Hedonic Pricing Model with GWR Method)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex1/In-class_Ex1.html">
 <span class="dropdown-text">In-class Exercise 1 (Spatial Weights and Applications)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex2/In-class_Ex2.html">
 <span class="dropdown-text">In-class Exercise 2 (Do functionally similar water points positively co-occur in Nigeria?)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex3/In-class_Ex3.html">
 <span class="dropdown-text">In-class_Exercise 3 (Spatially Constrainted Clustering with ClustGeo)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex4/In-class_Ex4.html">
 <span class="dropdown-text">In-class Exercise 4 (Calibrating Hedonic Pricing Model with GWR Method - Updated)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex5/In-class_Ex5.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html">
 <span class="dropdown-text">Take-home Exercise 1 (Geospatial Analytics for Social Good)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html">
 <span class="dropdown-text">Take-home Exercise 2 (Regionalization with Spatially Constrained Clustering Methods)</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#the-analytical-question" id="toc-the-analytical-question" class="nav-link" data-scroll-target="#the-analytical-question">The Analytical Question</a></li>
  <li><a href="#the-datasets" id="toc-the-datasets" class="nav-link" data-scroll-target="#the-datasets">The Datasets</a></li>
  </ul></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a>
  <ul class="collapse">
  <li><a href="#the-required-r-packages" id="toc-the-required-r-packages" class="nav-link" data-scroll-target="#the-required-r-packages">The Required R Packages</a></li>
  <li><a href="#importing-the-data" id="toc-importing-the-data" class="nav-link" data-scroll-target="#importing-the-data">Importing the Data</a>
  <ul class="collapse">
  <li><a href="#importing-geospatial-data-into-the-r-environment" id="toc-importing-geospatial-data-into-the-r-environment" class="nav-link" data-scroll-target="#importing-geospatial-data-into-the-r-environment">Importing geospatial data into the R environment</a></li>
  <li><a href="#importing-aspatial-data-into-the-r-environment" id="toc-importing-aspatial-data-into-the-r-environment" class="nav-link" data-scroll-target="#importing-aspatial-data-into-the-r-environment">Importing aspatial data into the R environment</a></li>
  <li><a href="#deriving-new-variables-using-dplyr-package" id="toc-deriving-new-variables-using-dplyr-package" class="nav-link" data-scroll-target="#deriving-new-variables-using-dplyr-package">Deriving new variables using <strong><code>dplyr</code></strong> package</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#using-histogram-for-distribution" id="toc-using-histogram-for-distribution" class="nav-link" data-scroll-target="#using-histogram-for-distribution">Using Histogram for Distribution</a>
  <ul class="collapse">
  <li><a href="#original-radio-distribution" id="toc-original-radio-distribution" class="nav-link" data-scroll-target="#original-radio-distribution">Original <code>'RADIO'</code> Distribution</a></li>
  <li><a href="#derived-radio_pr-distribution" id="toc-derived-radio_pr-distribution" class="nav-link" data-scroll-target="#derived-radio_pr-distribution">Derived <code>'RADIO_PR'</code> Distribution</a></li>
  </ul></li>
  <li><a href="#using-chloropleth-map-for-distribution" id="toc-using-chloropleth-map-for-distribution" class="nav-link" data-scroll-target="#using-chloropleth-map-for-distribution">Using Chloropleth Map for Distribution</a>
  <ul class="collapse">
  <li><a href="#joining-geospatial-data-with-aspatial-data" id="toc-joining-geospatial-data-with-aspatial-data" class="nav-link" data-scroll-target="#joining-geospatial-data-with-aspatial-data">Joining geospatial data with aspatial data</a></li>
  <li><a href="#preparing-the-cloropleth-map" id="toc-preparing-the-cloropleth-map" class="nav-link" data-scroll-target="#preparing-the-cloropleth-map">Preparing the cloropleth map</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis">Correlation Analysis</a></li>
  <li><a href="#hierarchy-cluster-analysis" id="toc-hierarchy-cluster-analysis" class="nav-link" data-scroll-target="#hierarchy-cluster-analysis">Hierarchy Cluster Analysis</a>
  <ul class="collapse">
  <li><a href="#extracting-cluster-variables" id="toc-extracting-cluster-variables" class="nav-link" data-scroll-target="#extracting-cluster-variables">Extracting Cluster Variables</a></li>
  <li><a href="#data-standardization" id="toc-data-standardization" class="nav-link" data-scroll-target="#data-standardization">Data Standardization</a>
  <ul class="collapse">
  <li><a href="#min-max-standardization" id="toc-min-max-standardization" class="nav-link" data-scroll-target="#min-max-standardization">Min-Max Standardization</a></li>
  <li><a href="#z-score-standardization" id="toc-z-score-standardization" class="nav-link" data-scroll-target="#z-score-standardization">Z-score standardization</a></li>
  <li><a href="#visualizing-the-standardized-clustering-variables" id="toc-visualizing-the-standardized-clustering-variables" class="nav-link" data-scroll-target="#visualizing-the-standardized-clustering-variables">Visualizing the standardized clustering variables</a></li>
  </ul></li>
  <li><a href="#proximity-matrix" id="toc-proximity-matrix" class="nav-link" data-scroll-target="#proximity-matrix">Proximity Matrix</a></li>
  <li><a href="#computing-hierarchical-clustering" id="toc-computing-hierarchical-clustering" class="nav-link" data-scroll-target="#computing-hierarchical-clustering">Computing Hierarchical Clustering</a></li>
  <li><a href="#the-optimal-clustering-algorithm" id="toc-the-optimal-clustering-algorithm" class="nav-link" data-scroll-target="#the-optimal-clustering-algorithm">The Optimal Clustering Algorithm</a></li>
  <li><a href="#determining-optimal-clusters" id="toc-determining-optimal-clusters" class="nav-link" data-scroll-target="#determining-optimal-clusters">Determining Optimal Clusters</a>
  <ul class="collapse">
  <li><a href="#using-the-gap-statistic-method" id="toc-using-the-gap-statistic-method" class="nav-link" data-scroll-target="#using-the-gap-statistic-method">Using the Gap Statistic method</a></li>
  </ul></li>
  <li><a href="#interpreting-dendograms" id="toc-interpreting-dendograms" class="nav-link" data-scroll-target="#interpreting-dendograms">Interpreting Dendograms</a></li>
  <li><a href="#visually-driven-hierarchal-clustering-analysis" id="toc-visually-driven-hierarchal-clustering-analysis" class="nav-link" data-scroll-target="#visually-driven-hierarchal-clustering-analysis">Visually-driven Hierarchal Clustering Analysis</a>
  <ul class="collapse">
  <li><a href="#transforming-the-data-frame-into-a-matrix" id="toc-transforming-the-data-frame-into-a-matrix" class="nav-link" data-scroll-target="#transforming-the-data-frame-into-a-matrix">Transforming the data frame into a matrix</a></li>
  <li><a href="#plotting-interactive-cluster-heatmap-using-heatmaply" id="toc-plotting-interactive-cluster-heatmap-using-heatmaply" class="nav-link" data-scroll-target="#plotting-interactive-cluster-heatmap-using-heatmaply">Plotting interactive cluster heatmap using <code>heatmaply()</code></a></li>
  </ul></li>
  <li><a href="#mapping-the-clusters" id="toc-mapping-the-clusters" class="nav-link" data-scroll-target="#mapping-the-clusters">Mapping the Clusters</a></li>
  </ul></li>
  <li><a href="#spatially-constrained-clustering-skater-approach" id="toc-spatially-constrained-clustering-skater-approach" class="nav-link" data-scroll-target="#spatially-constrained-clustering-skater-approach">Spatially Constrained Clustering: SKATER Approach</a>
  <ul class="collapse">
  <li><a href="#converting-to-spatialpolygonsdataframe" id="toc-converting-to-spatialpolygonsdataframe" class="nav-link" data-scroll-target="#converting-to-spatialpolygonsdataframe">Converting to SpatialPolygonsDataFrame</a></li>
  <li><a href="#computing-neighbor-list" id="toc-computing-neighbor-list" class="nav-link" data-scroll-target="#computing-neighbor-list">Computing Neighbor List</a></li>
  <li><a href="#computing-minimum-spanning-tree" id="toc-computing-minimum-spanning-tree" class="nav-link" data-scroll-target="#computing-minimum-spanning-tree">Computing Minimum Spanning Tree</a>
  <ul class="collapse">
  <li><a href="#calculating-edge-costs" id="toc-calculating-edge-costs" class="nav-link" data-scroll-target="#calculating-edge-costs">Calculating edge costs</a></li>
  <li><a href="#computing-minimum-spanning-tree-1" id="toc-computing-minimum-spanning-tree-1" class="nav-link" data-scroll-target="#computing-minimum-spanning-tree-1">Computing minimum spanning tree</a></li>
  </ul></li>
  <li><a href="#computing-spatial-constrained-clusters-using-the-skater-method" id="toc-computing-spatial-constrained-clusters-using-the-skater-method" class="nav-link" data-scroll-target="#computing-spatial-constrained-clusters-using-the-skater-method">Computing Spatial Constrained Clusters using the SKATER Method</a></li>
  <li><a href="#visualizing-spatially-constrained-clusters" id="toc-visualizing-spatially-constrained-clusters" class="nav-link" data-scroll-target="#visualizing-spatially-constrained-clusters">Visualizing Spatially Constrained Clusters</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Hands-on Exercise 3: Geographical Segmentation with Spatially Constrained Clustering Techniques</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i></button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<p>This is a hands-on exercise based on <a href="https://r4gdsa.netlify.app/chap05.html" title="R4GDSA: Geographical Segmentation with Spatially Constrained Clustering Techniques">Chapter 5</a> of <a href="https://r4gdsa.netlify.app/">R for Geospatial Data Science and Analytics</a> by Dr.&nbsp;Kam Tin Seong and is a requirement under the class ISS624: Geospatial Analytics and Applications.</p>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<p>The objective of this hands-on exercise is to learn how to delineate homogeneous regions using geographically referenced multivariate data. There are two major analysis, namely: hierarchical cluster analysis and spatially constrained cluster analysis.</p>
<p>This hands-on exercise has the following learning outcomes:</p>
<ul>
<li><p>to convert GIS polygon data into R’s simple feature data.frame by using appropriate functions of <strong><code>sf</code></strong> package of R;</p></li>
<li><p>to convert simple feature data.frame into R’s SpatialPolygonDataFrame object by using appropriate <strong>sf</strong> of package of R;</p></li>
<li><p>to perform cluster analysis by using <code>hclust()</code> of Base R;</p></li>
<li><p>to perform spatially constrained cluster analysis using <code>skater()</code> of Base R; and</p></li>
<li><p>to visualize the analysis output by using <strong><code>ggplot2</code></strong> and <strong><code>tmap</code></strong> package.</p></li>
</ul>
</section>
<section id="the-analytical-question" class="level2">
<h2 class="anchored" data-anchor-id="the-analytical-question">The Analytical Question</h2>
<p>In geobusiness and spatial policy, it is a common practice to delineate the market or planning area into homogeneous regions by using multivariate data. In this hands-on exercise, we are interested to delineate <a href="https://en.wikipedia.org/wiki/Shan_State">Shan State</a>, <a href="https://en.wikipedia.org/wiki/Myanmar">Myanmar</a> into homogeneous regions by using multiple Information and Communication Technology (ICT) measures, namely: Radio, Television, Landline phone, Mobile phone, Computer, and Internet at home.</p>
</section>
<section id="the-datasets" class="level2">
<h2 class="anchored" data-anchor-id="the-datasets">The Datasets</h2>
<ul>
<li><p>Myanmar Township Boundary Data (i.e.&nbsp;<em>myanmar_township_boundaries</em>) : This is a GIS data in ESRI shapefile format. It consists of township boundary information of Myanmar. The spatial data are captured in polygon features. Under GIS Resources &gt; MIMU Geospatial Data.</p></li>
<li><p><em>Shan-ICT.csv</em>: This is an extract of <a href="https://myanmar.unfpa.org/en/publications/2014-population-and-housing-census-myanmar-data-sheet"><strong>The 2014 Myanmar Population and Housing Census Myanmar</strong></a> at the township level.</p></li>
</ul>
<p>Both data sets are download from <a href="http://themimu.info/">Myanmar Information Management Unit (MIMU)</a>.</p>
</section>
</section>
<section id="getting-started" class="level1">
<h1>Getting Started</h1>
<section id="the-required-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="the-required-r-packages">The Required R Packages</h2>
<p>The code chunk below installs and loads the different required packages for this exercise using <code>p_load()</code>:</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(rgdal, spdep, tmap, sf, ggpubr, cluster, factoextra, NbClust, heatmaply, corrplot, psych, tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
🎮 LEVEL UP!
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>NEW LIBRARIES UNLOCKED</strong>!</p>
<ul>
<li><p><a href="https://cran.r-project.org/web/packages/rgdal/index.html"><strong><code>rgdal</code></strong></a> - the GDAL in ‘rgdal’ stands for ‘Geospatial Data Abstraction Library’ which is a translator library for raster and vector geospatial data format; it also has projection/transformation operations from the ‘PROJ’ library</p>
<blockquote class="blockquote">
<p><strong>This library will be retired by the end of 2023!</strong></p>
</blockquote></li>
<li><p><a href="https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html"><strong><code>corrplot</code></strong></a> - used for visualization of the correlation matrix</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/ggpubr/index.html"><strong><code>ggpubr</code></strong></a> - provides easy-to-use functions for creating publication ready plots built on <code>ggplot2</code></p></li>
<li><p><a href="https://cran.r-project.org/web/packages/heatmaply/vignettes/heatmaply.html"><strong><code>heatmaply</code></strong></a> - used to make interactive heatmaps that allow the inspection of specific value by hovering the mouse over a cell</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/cluster/index.html"><strong><code>cluster</code></strong></a> - contains functions for cluster analysis</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/NbClust/versions/3.0.1/topics/NbClust"><strong><code>NbClust</code></strong></a> - used to figure out the best clustering scheme from the different results obtained by varying all combinations of number of clusters, distance measures, and clustering methods</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/factoextra/index.html"><strong><code>factoextra</code></strong></a> - easy-to-use functions to extract and visualize the output of multivariate data analyses</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/psych/index.html"><strong><code>psych</code></strong></a> - general purpose toolbox for personality, psychometric theory and experimental psychology which provides multivariate analysis and scale construction using factor analysis, principal component analysis, cluster analysis and reliability analysis (although others provide basic descriptive statistics)</p></li>
</ul>
</div>
</div>
</section>
<section id="importing-the-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-the-data">Importing the Data</h2>
<section id="importing-geospatial-data-into-the-r-environment" class="level3">
<h3 class="anchored" data-anchor-id="importing-geospatial-data-into-the-r-environment">Importing geospatial data into the R environment</h3>
<p>The code chunk below uses <code>st_read()</code> to import the shapefile containing the administrative boundaries of Myanmar.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, <span class="at">layer =</span> <span class="st">"myanmar_township_boundaries"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ST <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Shan (East)"</span>, <span class="st">"Shan (North)"</span>, <span class="st">"Shan (South)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `myanmar_township_boundaries' from data source 
  `C:\acapgalano\ISSS624\Hands-on_Ex\Hands-on_Ex3\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 330 features and 14 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.17275 ymin: 9.671252 xmax: 101.1699 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
💻 CODE REVIEW!
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>WHAT DOES THE OPERATOR <code>%in%</code> DO?</strong></p>
<p>So in the context of the code chunk above, the records are filtered to only extract those with <code>'ST'</code> equals to either “Shan (East)”, “Shan (North)”, “Shan (South)”.</p>
<p>In the context of our data, <code>'ST'</code> refers to the state, region or union territory, which are the first level administrative boundaries of Myanmar. We are focusing on the “Shan” state of Myanmar.</p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>shan_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 55 features and 14 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 96.15107 ymin: 19.29932 xmax: 101.1699 ymax: 24.15907
Geodetic CRS:  WGS 84
First 10 features:
   OBJECTID           ST ST_PCODE       DT   DT_PCODE        TS  TS_PCODE
1       163 Shan (North)   MMR015  Mongmit MMR015D008   Mongmit MMR015017
2       203 Shan (South)   MMR014 Taunggyi MMR014D001   Pindaya MMR014006
3       240 Shan (South)   MMR014 Taunggyi MMR014D001   Ywangan MMR014007
4       106 Shan (South)   MMR014 Taunggyi MMR014D001  Pinlaung MMR014009
5        72 Shan (North)   MMR015  Mongmit MMR015D008    Mabein MMR015018
6        40 Shan (South)   MMR014 Taunggyi MMR014D001     Kalaw MMR014005
7       194 Shan (South)   MMR014 Taunggyi MMR014D001     Pekon MMR014010
8       159 Shan (South)   MMR014 Taunggyi MMR014D001  Lawksawk MMR014008
9        61 Shan (North)   MMR015  Kyaukme MMR015D003 Nawnghkio MMR015013
10      124 Shan (North)   MMR015  Kyaukme MMR015D003   Kyaukme MMR015012
                 ST_2            LABEL2 SELF_ADMIN ST_RG T_NAME_WIN T_NAME_M3
1  Shan State (North)    Mongmit\n61072       &lt;NA&gt; State   rdk;rdwf      မိုးမိတ်
2  Shan State (South)    Pindaya\n77769       Danu State     yif;w,     ပင်းတယ
3  Shan State (South)    Ywangan\n76933       Danu State      &amp;GmiH       ရွာငံ
4  Shan State (South)  Pinlaung\n162537       Pa-O State  yifavmif;   ပင်လောင်း
5  Shan State (North)     Mabein\n35718       &lt;NA&gt; State     rbdrf;      မဘိမ်း
6  Shan State (South)     Kalaw\n163138       &lt;NA&gt; State       uavm      ကလော
7  Shan State (South)      Pekon\n94226       &lt;NA&gt; State     z,fcHk       ဖယ်ခုံ
8  Shan State (South)          Lawksawk       &lt;NA&gt; State   &amp;yfapmuf    ရပ်စောက်
9  Shan State (North) Nawnghkio\n128357       &lt;NA&gt; State  aemifcsdK    နောင်ချို
10 Shan State (North)   Kyaukme\n172874       &lt;NA&gt; State   ausmufrJ    ကျောက်မဲ
       AREA                       geometry
1  2703.611 MULTIPOLYGON (((96.96001 23...
2   629.025 MULTIPOLYGON (((96.7731 21....
3  2984.377 MULTIPOLYGON (((96.78483 21...
4  3396.963 MULTIPOLYGON (((96.49518 20...
5  5034.413 MULTIPOLYGON (((96.66306 24...
6  1456.624 MULTIPOLYGON (((96.49518 20...
7  2073.513 MULTIPOLYGON (((97.14738 19...
8  5145.659 MULTIPOLYGON (((96.94981 22...
9  3271.537 MULTIPOLYGON (((96.75648 22...
10 3920.869 MULTIPOLYGON (((96.95498 22...</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(shan_sf<span class="sc">$</span>TS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Mongmit"    "Pindaya"    "Ywangan"    "Pinlaung"   "Mabein"    
 [6] "Kalaw"      "Pekon"      "Lawksawk"   "Nawnghkio"  "Kyaukme"   
[11] "Muse"       "Laihka"     "Mongnai"    "Mawkmai"    "Kutkai"    
[16] "Mongton"    "Mongyai"    "Mongkaing"  "Lashio"     "Mongpan"   
[21] "Matman"     "Tachileik"  "Narphan"    "Mongkhet"   "Hsipaw"    
[26] "Monghsat"   "Mongmao"    "Nansang"    "Laukkaing"  "Pangsang"  
[31] "Namtu"      "Monghpyak"  "Konkyan"    "Mongping"   "Hopong"    
[36] "Nyaungshwe" "Hsihseng"   "Mongla"     "Hseni"      "Kunlong"   
[41] "Hopang"     "Namhkan"    "Kengtung"   "Langkho"    "Monghsu"   
[46] "Taunggyi"   "Pangwaun"   "Kyethi"     "Loilen"     "Manton"    
[51] "Mongyang"   "Kunhing"    "Mongyawng"  "Tangyan"    "Namhsan"   </code></pre>
</div>
</div>
<p>As shown above we have 55 features, and each feature represents a township in Myanmar since the <code>'TS'</code> variable is unique for all records. The terms “feature”, “polygon”, and “township” will be used interchangeably in this exercise.</p>
</section>
<section id="importing-aspatial-data-into-the-r-environment" class="level3">
<h3 class="anchored" data-anchor-id="importing-aspatial-data-into-the-r-environment">Importing aspatial data into the R environment</h3>
<p>The code chunk below uses <code>read_csv</code> to import</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ict <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/Shan-ICT.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> District Pcode     District Name      Township Pcode     Township Name     
 Length:55          Length:55          Length:55          Length:55         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
 Total households     Radio         Television    Land line phone 
 Min.   : 3318    Min.   :  115   Min.   :  728   Min.   :  20.0  
 1st Qu.: 8711    1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  
 Median :13685    Median : 2497   Median : 6117   Median : 695.0  
 Mean   :18369    Mean   : 4487   Mean   :10183   Mean   : 929.9  
 3rd Qu.:23471    3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  
 Max.   :82604    Max.   :30176   Max.   :62388   Max.   :6736.0  
  Mobile phone      Computer      Internet at home
 Min.   :  150   Min.   :  20.0   Min.   :   8.0  
 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0  
 Median : 3559   Median : 244.0   Median : 316.0  
 Mean   : 6470   Mean   : 575.5   Mean   : 760.2  
 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5  
 Max.   :48461   Max.   :6705.0   Max.   :9746.0  </code></pre>
</div>
</div>
<p>The summary above confirms that there are 55 townships.</p>
</section>
<section id="deriving-new-variables-using-dplyr-package" class="level3">
<h3 class="anchored" data-anchor-id="deriving-new-variables-using-dplyr-package">Deriving new variables using <strong><code>dplyr</code></strong> package</h3>
<p>The unit of measurement of the variables is number of households. Using these values is not fairs because the townships with relatively higher total number of households will also have higher number of households owning a radio, TV, etc.</p>
<p>In order to overcome this problem, we will derive the penetration rate of each ICT variable by using the code chunk below.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ict_derived <span class="ot">&lt;-</span> ict <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Radio</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">TV_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Television</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">LLPHONE_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">MPHONE_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">COMPUTER_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Computer</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">INTERNET_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ict_derived <span class="ot">&lt;-</span> ict_derived  <span class="sc">%&gt;%</span>  </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">DT_PCODE</span><span class="st">`</span> <span class="ot">=</span><span class="st">`</span><span class="at">District Pcode</span><span class="st">`</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">DT</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">District Name</span><span class="st">`</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TS_PCODE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Township Pcode</span><span class="st">`</span>, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TS</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Township Name</span><span class="st">`</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TT_HOUSEHOLDS</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span>, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">RADIO</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Radio</span><span class="st">`</span>, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TV</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Television</span><span class="st">`</span>, </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">LLPHONE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span>, </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">MPHONE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">COMPUTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Computer</span><span class="st">`</span>, </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">INTERNET</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ict_derived)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   DT_PCODE              DT              TS_PCODE              TS           
 Length:55          Length:55          Length:55          Length:55         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
 TT_HOUSEHOLDS       RADIO             TV           LLPHONE      
 Min.   : 3318   Min.   :  115   Min.   :  728   Min.   :  20.0  
 1st Qu.: 8711   1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  
 Median :13685   Median : 2497   Median : 6117   Median : 695.0  
 Mean   :18369   Mean   : 4487   Mean   :10183   Mean   : 929.9  
 3rd Qu.:23471   3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  
 Max.   :82604   Max.   :30176   Max.   :62388   Max.   :6736.0  
     MPHONE         COMPUTER         INTERNET         RADIO_PR     
 Min.   :  150   Min.   :  20.0   Min.   :   8.0   Min.   : 21.05  
 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0   1st Qu.:138.95  
 Median : 3559   Median : 244.0   Median : 316.0   Median :210.95  
 Mean   : 6470   Mean   : 575.5   Mean   : 760.2   Mean   :215.68  
 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5   3rd Qu.:268.07  
 Max.   :48461   Max.   :6705.0   Max.   :9746.0   Max.   :484.52  
     TV_PR         LLPHONE_PR       MPHONE_PR       COMPUTER_PR    
 Min.   :116.0   Min.   :  2.78   Min.   : 36.42   Min.   : 3.278  
 1st Qu.:450.2   1st Qu.: 22.84   1st Qu.:190.14   1st Qu.:11.832  
 Median :517.2   Median : 37.59   Median :305.27   Median :18.970  
 Mean   :509.5   Mean   : 51.09   Mean   :314.05   Mean   :24.393  
 3rd Qu.:606.4   3rd Qu.: 69.72   3rd Qu.:428.43   3rd Qu.:29.897  
 Max.   :842.5   Max.   :181.49   Max.   :735.43   Max.   :92.402  
  INTERNET_PR     
 Min.   :  1.041  
 1st Qu.:  8.617  
 Median : 22.829  
 Mean   : 30.644  
 3rd Qu.: 41.281  
 Max.   :117.985  </code></pre>
</div>
</div>
<p>The new variables we created two code chunks ago (<code>'RADIO_PR'</code>, <code>'TV_PR'</code>, <code>'LLPHONE_PR'</code>, <code>'MPHONE_PR'</code>, <code>'COMPUTER_PR'</code>, and <code>'INTERNET_PR'</code>) are now in our new dataframe ‘ict_derived’.</p>
</section>
</section>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory Data Analysis</h1>
<section id="using-histogram-for-distribution" class="level2">
<h2 class="anchored" data-anchor-id="using-histogram-for-distribution">Using Histogram for Distribution</h2>
<section id="original-radio-distribution" class="level3">
<h3 class="anchored" data-anchor-id="original-radio-distribution">Original <code>'RADIO'</code> Distribution</h3>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">"#704276"</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"#704276"</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="callout-important callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
🌸 FIRST IMPRESSIONS!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the histogram above, it seems that most townships have around 10,000 households with radios, but there are a few townships that have around 30,000 households with radios. The data on households with radios looks skewed to the right.<br>
The succeeding bloxplot shows that there are 2 townships that are minor outliers and 1 township is a major outlier affecting the observed skewness from the histogram.</p>
</div>
</div>
</section>
<section id="derived-radio_pr-distribution" class="level3">
<h3 class="anchored" data-anchor-id="derived-radio_pr-distribution">Derived <code>'RADIO_PR'</code> Distribution</h3>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
🌸 NEW OBSERVATION!
</div>
</div>
<div class="callout-body-container callout-body">
<p>The new histogram using <code>'RADIO_PR'</code> which was derived is visually more well-distributed than the original one using <code>'RADIO'</code>. It looks closer to a normal distribution.</p>
<p>The new boxplot using <code>'RADIO_PR'</code> now only has one outlier compared to the three points earlier. The median is now closer to the center as well.</p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>radio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>tv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">TV</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>llphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">LLPHONE</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>mphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">MPHONE</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>computer <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">COMPUTER</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>internet <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">INTERNET</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(radio, tv, llphone, mphone, computer, internet, </span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>radio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>tv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">TV_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>llphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">LLPHONE_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>mphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">MPHONE_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>computer <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">COMPUTER_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>internet <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">INTERNET_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(radio, tv, llphone, mphone, computer, internet, </span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
</section>
<section id="using-chloropleth-map-for-distribution" class="level2">
<h2 class="anchored" data-anchor-id="using-chloropleth-map-for-distribution">Using Chloropleth Map for Distribution</h2>
<section id="joining-geospatial-data-with-aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="joining-geospatial-data-with-aspatial-data">Joining geospatial data with aspatial data</h3>
<p>Before being able to make a chloropleth map of the different variables across the different townships, we need to join our aspatial data to the geospatial data. The code chunk below using <code>left_join()</code> to join ‘shan_sf’ and ‘ict_derived’ into one simple feature dataframe. The column <code>'TS_PCODE'</code> is used as the unique identifier to join the objects.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(shan_sf, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                     ict_derived, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by=</span><span class="fu">c</span>(<span class="st">"TS_PCODE"</span><span class="ot">=</span><span class="st">"TS_PCODE"</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(shan_sf, <span class="st">"data/rds/shan_sf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We also right the resulting dataframe into an RDS file using <code>write_rds()</code> .</p>
</section>
<section id="preparing-the-cloropleth-map" class="level3">
<h3 class="anchored" data-anchor-id="preparing-the-cloropleth-map">Preparing the cloropleth map</h3>
<p>The code chunk below uses <code>qtm()</code> function to quickly prepare the chloropleth map of <code>'RADIO_PR'</code>.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf, <span class="st">"RADIO_PR"</span>, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill.palette =</span> <span class="st">"RdPu"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>The code chunk below shows both the chloropleth map of <code>'TT_HOUSEHOLDS'</code> and <code>'RADIO'</code> to show the relationship between number of households and number of households with radios.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>TT_HOUSEHOLDS.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"TT_HOUSEHOLDS"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Total households"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdPu"</span>) <span class="sc">+</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>RADIO.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"RADIO"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Number Radio "</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdPu"</span>) <span class="sc">+</span> </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(TT_HOUSEHOLDS.map, RADIO.map,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
🌸 FIRST IMPRESSION!
</div>
</div>
<div class="callout-body-container callout-body">
<p>It seems that the townships with more households, also have more radios. But logically, of course there would be some sort of bias between higher households and having a higher number of radios. So we should look at the <code>'RADIO_PR'</code> variable instead.</p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>TT_HOUSEHOLDS.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"TT_HOUSEHOLDS"</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Total households"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdPu"</span>) <span class="sc">+</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>RADIO_PR.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span> </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"RADIO_PR"</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Radio PR"</span>,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdPu"</span>) <span class="sc">+</span> </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(TT_HOUSEHOLDS.map, RADIO_PR.map,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(RADIO.map, RADIO_PR.map,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
🌸 NEW OBSERVATION!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Comparing the chloropleth map of the number of radios to that of the radio PR, there is an obvious difference to the mapping visually. As an example, the top left township seems to have a lower number of household with radios, however when considering per 1000 households, it actually has one of the highest radio penetration rates. There are also townships with the opposite case where they have high number of radios but low radio penetration rates.</p>
</div>
</div>
</section>
</section>
</section>
<section id="correlation-analysis" class="level1">
<h1>Correlation Analysis</h1>
<p>Before we perform cluster analysis, it is important for us to ensure that the cluster variables are not highly correlated.</p>
<p>The <code>cor()</code> function is used to measure the correlation coefficient between all our variables from ‘ict_derived’.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>cluster_vars.cor <span class="ot">=</span> <span class="fu">cor</span>(ict_derived[,<span class="dv">12</span><span class="sc">:</span><span class="dv">17</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below uses the <code>corrplot.mixed()</code> function to visualize and analyze the correlation of the input variables. It’s a special function used for mixed visualization style, where we can set the visual methods for the lower and upper triangle separately.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(cluster_vars.cor,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper =</span> <span class="st">"number"</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.pos =</span> <span class="st">"lt"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">"l"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.col =</span> <span class="st">"#cb6a82"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>The correlation plot above shows that <code>'COMPUTER_PR'</code> and <code>'INTERNET_PR'</code> are highly correlated. (This makes sense, since if you think about it, when you get a computer, you also install internet connection.) This suggest that only one of them should be used in the cluster analysis instead of both.</p>
</section>
<section id="hierarchy-cluster-analysis" class="level1">
<h1>Hierarchy Cluster Analysis</h1>
<section id="extracting-cluster-variables" class="level2">
<h2 class="anchored" data-anchor-id="extracting-cluster-variables">Extracting Cluster Variables</h2>
<p>The code chunk below, uses <code>st_set_geometry()</code> to extract the data.frame from the simple features object by setting it to <strong>’NULL</strong>’. Using <code>select()</code> we get only the variables needed including the township name.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>cluster_vars <span class="ot">&lt;-</span> shan_sf <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="st">"TS.x"</span>, <span class="st">"RADIO_PR"</span>, <span class="st">"TV_PR"</span>, <span class="st">"LLPHONE_PR"</span>, <span class="st">"MPHONE_PR"</span>, <span class="st">"COMPUTER_PR"</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        TS.x RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
1    Mongmit 286.1852 554.1313   35.30618  260.6944    12.15939
2    Pindaya 417.4647 505.1300   19.83584  162.3917    12.88190
3    Ywangan 484.5215 260.5734   11.93591  120.2856     4.41465
4   Pinlaung 231.6499 541.7189   28.54454  249.4903    13.76255
5     Mabein 449.4903 708.6423   72.75255  392.6089    16.45042
6      Kalaw 280.7624 611.6204   42.06478  408.7951    29.63160
7      Pekon 318.6118 535.8494   39.83270  214.8476    18.97032
8   Lawksawk 387.1017 630.0035   31.51366  320.5686    21.76677
9  Nawnghkio 349.3359 547.9456   38.44960  323.0201    15.76465
10   Kyaukme 210.9548 601.1773   39.58267  372.4930    30.94709</code></pre>
</div>
</div>
<p>Because of the correlation analysis done earlier, we did not include <code>'INTERNET_PR'</code> in our clustering variables.</p>
<p>The code chunk below changes the row ID to township names.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(cluster_vars) <span class="ot">&lt;-</span> cluster_vars<span class="sc">$</span><span class="st">"TS.x"</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               TS.x RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
Mongmit     Mongmit 286.1852 554.1313   35.30618  260.6944    12.15939
Pindaya     Pindaya 417.4647 505.1300   19.83584  162.3917    12.88190
Ywangan     Ywangan 484.5215 260.5734   11.93591  120.2856     4.41465
Pinlaung   Pinlaung 231.6499 541.7189   28.54454  249.4903    13.76255
Mabein       Mabein 449.4903 708.6423   72.75255  392.6089    16.45042
Kalaw         Kalaw 280.7624 611.6204   42.06478  408.7951    29.63160
Pekon         Pekon 318.6118 535.8494   39.83270  214.8476    18.97032
Lawksawk   Lawksawk 387.1017 630.0035   31.51366  320.5686    21.76677
Nawnghkio Nawnghkio 349.3359 547.9456   38.44960  323.0201    15.76465
Kyaukme     Kyaukme 210.9548 601.1773   39.58267  372.4930    30.94709</code></pre>
</div>
</div>
<p>Instead of row numbers, we now have the township name as the unique identifier of each row. Now we can remove the column <code>'TS.'</code> using the code chunk below.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>shan_ict <span class="ot">&lt;-</span> <span class="fu">select</span>(cluster_vars, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shan_ict, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
Mongmit   286.1852 554.1313   35.30618  260.6944    12.15939
Pindaya   417.4647 505.1300   19.83584  162.3917    12.88190
Ywangan   484.5215 260.5734   11.93591  120.2856     4.41465
Pinlaung  231.6499 541.7189   28.54454  249.4903    13.76255
Mabein    449.4903 708.6423   72.75255  392.6089    16.45042
Kalaw     280.7624 611.6204   42.06478  408.7951    29.63160
Pekon     318.6118 535.8494   39.83270  214.8476    18.97032
Lawksawk  387.1017 630.0035   31.51366  320.5686    21.76677
Nawnghkio 349.3359 547.9456   38.44960  323.0201    15.76465
Kyaukme   210.9548 601.1773   39.58267  372.4930    30.94709</code></pre>
</div>
</div>
</section>
<section id="data-standardization" class="level2">
<h2 class="anchored" data-anchor-id="data-standardization">Data Standardization</h2>
<p>In general, multiple variables will be used in cluster analysis. It is not unusual that the range of values we work with per variable will be different. For example, comparing percentages and counts. In order to avoid a cluster analysis result that is biased to clustering variables with large values, it is useful to standardise the input variables before performing cluster analysis.</p>
<section id="min-max-standardization" class="level3">
<h3 class="anchored" data-anchor-id="min-max-standardization">Min-Max Standardization</h3>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
📖 LECTURE REVIEW!
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is a common standardization technique where the maximum value gets transformed into a 1 and the minimum value gets transformed to 0. All variable will then be scaled to to values that are decimal values between 0 and 1. The formula is as follows:</p>
<p><span class="math display">\[
MM(x_{ij}) = \dfrac{x_{ij}-x_{min}}{x_{max}-x_{min}}
\]</span></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>shan_ict.std <span class="ot">&lt;-</span> <span class="fu">normalize</span>(shan_ict)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan_ict.std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    RADIO_PR          TV_PR          LLPHONE_PR       MPHONE_PR     
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.2544   1st Qu.:0.4600   1st Qu.:0.1123   1st Qu.:0.2199  
 Median :0.4097   Median :0.5523   Median :0.1948   Median :0.3846  
 Mean   :0.4199   Mean   :0.5416   Mean   :0.2703   Mean   :0.3972  
 3rd Qu.:0.5330   3rd Qu.:0.6750   3rd Qu.:0.3746   3rd Qu.:0.5608  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
  COMPUTER_PR     
 Min.   :0.00000  
 1st Qu.:0.09598  
 Median :0.17607  
 Mean   :0.23692  
 3rd Qu.:0.29868  
 Max.   :1.00000  </code></pre>
</div>
</div>
<p>According to the summary, the range of values for all PRs is between 0-1.</p>
</section>
<section id="z-score-standardization" class="level3">
<h3 class="anchored" data-anchor-id="z-score-standardization">Z-score standardization</h3>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
📖 LECTURE REVIEW!
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is used for standardizing scores on the same scale by dividing a score’s deviation by the standard deviation in a data set. This should be used when all variables are assumed to come from some normal distribution.</p>
<p><span class="math display">\[
Z(x_{ij}) = \dfrac{x_{ij}-\bar{x}_j}{\sigma_j}
\]</span></p>
</div>
</div>
<p>The code chunk below uses the <code>scale()</code> function to perform z-score standardization on the our clustering variables.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>shan_ict.z <span class="ot">&lt;-</span> <span class="fu">scale</span>(shan_ict)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(shan_ict.z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            vars  n mean sd median trimmed  mad   min  max range  skew kurtosis
RADIO_PR       1 55    0  1  -0.04   -0.06 0.94 -1.85 2.55  4.40  0.48    -0.27
TV_PR          2 55    0  1   0.05    0.04 0.78 -2.47 2.09  4.56 -0.38    -0.23
LLPHONE_PR     3 55    0  1  -0.33   -0.15 0.68 -1.19 3.20  4.39  1.37     1.49
MPHONE_PR      4 55    0  1  -0.05   -0.06 1.01 -1.58 2.40  3.98  0.48    -0.34
COMPUTER_PR    5 55    0  1  -0.26   -0.18 0.64 -1.03 3.31  4.34  1.80     2.96
              se
RADIO_PR    0.13
TV_PR       0.13
LLPHONE_PR  0.13
MPHONE_PR   0.13
COMPUTER_PR 0.13</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
🎮 LEVEL UP!
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>NEW FUNCTION UNLOCKED:</strong> <a href="https://www.programmingr.com/statistics/describe-in-r/"><code>describe()</code></a></p>
<p>This function accepts any data type and produces a contingency table supplying information about the data. The content depends on the data structure being analyzed. In this case, we’re being given summary statistics for each variable.</p>
</div>
</div>
</section>
<section id="visualizing-the-standardized-clustering-variables" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-standardized-clustering-variables">Visualizing the standardized clustering variables</h3>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values"</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>shan_ict_s_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.std)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_s_df, </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>) <span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max"</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>shan_ict_z_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.z)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_z_df, </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>) <span class="sc">+</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score"</span>)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
🌸 NEW OBSERVATION!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visually, from first look, the weight of the count leans the left half of the graph. Applying the standardization techniques seemed to create a normal distribution where there’s greatest count is towards the center of the graph.</p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"#e3879e"</span>) <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values"</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>shan_ict_s_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.std)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_s_df, </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"#e3879e"</span>) <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max"</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>shan_ict_z_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.z)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_z_df, </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"#e3879e"</span>) <span class="sc">+</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score Standardization"</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
</section>
<section id="proximity-matrix" class="level2">
<h2 class="anchored" data-anchor-id="proximity-matrix">Proximity Matrix</h2>
<p>The code chunk below uses <code>dist()</code> to create a proximity matrix using the ’<strong>euclidean’ method</strong>. The function <code>dist()</code> also supports maximum, manhattan, canberra, binary and minkowski methods.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>proxmat <span class="ot">&lt;-</span> <span class="fu">dist</span>(shan_ict, <span class="at">method =</span> <span class="st">'euclidean'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The first 18 rows and 6 columns of the proximity matrix are shown in the image below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-3CE98365.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="computing-hierarchical-clustering" class="level2">
<h2 class="anchored" data-anchor-id="computing-hierarchical-clustering">Computing Hierarchical Clustering</h2>
<p>The code chunk below uses the function <code>hclust()</code> to create clusters using the agglomeration method. The <code>'method'</code> was set to ‘ward.D’, but the function support seven other algorithms namely: ward.D2, single, complete, average(UPGMA), mcquitty (WPGMA), median (WPGMC) and centroid (UPGMC).</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>hclust_ward <span class="ot">&lt;-</span> <span class="fu">hclust</span>(proxmat, <span class="at">method =</span> <span class="st">'ward.D'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
❔ I’M JUST WONDERING…
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Why are there two WARD methods (ward.D and ward.D2)?</strong></p>
<blockquote class="blockquote">
<p><em>“It basically boils down to the fact that the Ward algorithm is directly correctly implemented in just Ward2 (ward.D2), but Ward1 (ward.D) can also be used, if the Euclidean distances (from <code>dist()</code>) are squared before inputing them to the <code>hclust()</code> using the ward.D as the method.</em></p>
<p><em>For example, SPSS also implements Ward1, but warn the users that distances should be squared to obtain the Ward criterion. In such sense implementation of ward.D is not deprecated, and nonetheless it might be a good idea to retain it for backward compatibility.”</em></p>
<p>Source: <a href="https://stats.stackexchange.com/questions/109949/what-algorithm-does-ward-d-in-hclust-implement-if-it-is-not-wards-criterion">Statistics Stack Exchange Question</a></p>
</blockquote>
</div>
</div>
<p>We can then plot the tree using <code>plot()</code> as shown in the code chunk below:</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">"#cb6a82"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="the-optimal-clustering-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="the-optimal-clustering-algorithm">The Optimal Clustering Algorithm</h2>
<p>One of the challenge in performing hierarchical clustering is to identify stronger clustering structures. The issue can be solved by using the <code>agnes()</code> function. It functions like <code>hclust()</code>, however, with <code>agnes()</code> you can also get the <strong>agglomerative coefficient</strong>, which measures the amount of clustering structure found <strong>and values closer to 1 suggest strong clustering structure</strong>.</p>
<p>The code chunk below will be used to compute the agglomerative coefficients of hierarchical clustering algorithms, namely ‘average’, ‘single’, ‘complete’ and ‘ward’.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>ac <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">agnes</span>(shan_ict, <span class="at">method =</span> x)<span class="sc">$</span>ac</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(m, ac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  average    single  complete      ward 
0.8131144 0.6628705 0.8950702 0.9427730 </code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
💻 CODE REVIEW!
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>NEW FUNCTION UNLOCKED: <code>map_dbl()</code></strong></p>
<p>This function loops through a double vector (first argument) and applies the function (second argument). It returns a list with the results.</p>
<p><strong>NEW FUNCTION UNLOCKED: <code>names()</code></strong></p>
<p>This function is used to get or set the name of an Object. Length of value vector should be equal to the length of the object to be named.</p>
<p>In the context of the code chunk above, we set the name of vector <code>'m'</code> (which contains all the methods) for ease of visualizing the results. This means after mapping the <code>agnes()</code> function to the vector, the results are also labelled.</p>
</div>
</div>
<p>With reference to the output above, we can see that <strong>Ward's method provides the strongest clustering structure</strong> among the four methods assessed. Hence, in the subsequent analysis, only Ward's method will be used.</p>
</section>
<section id="determining-optimal-clusters" class="level2">
<h2 class="anchored" data-anchor-id="determining-optimal-clusters">Determining Optimal Clusters</h2>
<p>Another technical challenge faced by data analysts in performing clustering analysis is to determine the optimal clusters to retain.</p>
<p>There are <a href="https://statweb.stanford.edu/~gwalther/gap">three</a> commonly used methods to determine the optimal clusters, they are:</p>
<ul>
<li><p><a href="https://en.wikipedia.org/wiki/Elbow_method_(clustering)">Elbow Method</a></p></li>
<li><p><a href="https://www.sciencedirect.com/science/article/pii/0377042787901257?via%3Dihub">Average Silhouette Method</a></p></li>
<li><p><a href="http://www.web.stanford.edu/~hastie/Papers/gap.pdf">Gap Statistic Method</a></p></li>
</ul>
<section id="using-the-gap-statistic-method" class="level3">
<h3 class="anchored" data-anchor-id="using-the-gap-statistic-method">Using the Gap Statistic method</h3>
<p>The <a href="http://www.web.stanford.edu/~hastie/Papers/gap.pdf"><strong>gap statistic</strong></a> compares the total within intra-cluster variation for different values of k with their expected values under null reference distribution of the data. The estimate of the optimal clusters will be value that maximize the gap statistic (i.e., that yields the largest gap statistic). This means that the clustering structure is far away from the random uniform distribution of points.</p>
<p>To compute the gap statistic, <a href="https://www.rdocumentation.org/packages/cluster/versions/2.1.0/topics/clusGap"><code>clusGap()</code></a> of <a href="https://cran.r-project.org/web/packages/cluster/"><strong>cluster</strong></a> package will be used.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>gap_stat <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(shan_ict, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FUN =</span> hcut, </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nstart =</span> <span class="dv">25</span>, </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K.max =</span> <span class="dv">10</span>, </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">B =</span> <span class="dv">50</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gap_stat, <span class="at">method =</span> <span class="st">"firstmax"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Clustering Gap statistic ["clusGap"] from call:
clusGap(x = shan_ict, FUNcluster = hcut, K.max = 10, B = 50, nstart = 25)
B=50 simulated reference sets, k = 1..10; spaceH0="scaledPCA"
 --&gt; Number of clusters (method 'firstmax'): 1
          logW   E.logW       gap     SE.sim
 [1,] 8.407129 8.680794 0.2736651 0.04460994
 [2,] 8.130029 8.350712 0.2206824 0.03880130
 [3,] 7.992265 8.202550 0.2102844 0.03362652
 [4,] 7.862224 8.080655 0.2184311 0.03784781
 [5,] 7.756461 7.978022 0.2215615 0.03897071
 [6,] 7.665594 7.887777 0.2221833 0.03973087
 [7,] 7.590919 7.806333 0.2154145 0.04054939
 [8,] 7.526680 7.731619 0.2049390 0.04198644
 [9,] 7.458024 7.660795 0.2027705 0.04421874
[10,] 7.377412 7.593858 0.2164465 0.04540947</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_gap_stat</span>(gap_stat, <span class="at">linecolor =</span> <span class="st">"#cb6a82"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>With reference to the gap statistic graph above, the recommended number of clusters to retain is 1. However, it is not logical to retain only one cluster. By examining the gap statistic graph, the 6-cluster gives the largest gap statistic and should be the next best cluster to pick.</p>
</section>
</section>
<section id="interpreting-dendograms" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-dendograms">Interpreting Dendograms</h2>
<p>In the dendrogram displayed above, each leaf corresponds to one observation. As we move up the tree, observations that are similar to each other are combined into branches, which are themselves fused at a higher height.</p>
<p>The height of the fusion, provided on the vertical axis, indicates the (dis)similarity between two observations. The higher the height of the fusion, the less similar the observations are. Note that, conclusions about the proximity of two observations can be drawn only based on the height where branches containing those two observations first are fused. We cannot use the proximity of two observations along the horizontal axis as a criteria of their similarity.</p>
<p>It's also possible to draw the dendrogram with a border around the selected clusters by using <code>rect.hclust()</code> of R stats. The argument <em>border</em> is used to specify the border colors for the rectangles.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">col =</span> <span class="st">"#cb6a82"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(hclust_ward, </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">k =</span> <span class="dv">6</span>, </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="visually-driven-hierarchal-clustering-analysis" class="level2">
<h2 class="anchored" data-anchor-id="visually-driven-hierarchal-clustering-analysis">Visually-driven Hierarchal Clustering Analysis</h2>
<section id="transforming-the-data-frame-into-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="transforming-the-data-frame-into-a-matrix">Transforming the data frame into a matrix</h3>
<p>The data was loaded into a data frame, but it has to be a data matrix to make a heatmap.</p>
<p>The code chunk below will be used to transform ‘shan_ict’ data frame into a data matrix.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>shan_ict_mat <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(shan_ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plotting-interactive-cluster-heatmap-using-heatmaply" class="level3">
<h3 class="anchored" data-anchor-id="plotting-interactive-cluster-heatmap-using-heatmaply">Plotting interactive cluster heatmap using <code>heatmaply()</code></h3>
<p>In the code chunk below, we use <code>heatmaply()</code> to build an <strong>interactive</strong> cluster heatmap. By default, <code>normalize()</code> centers and scales the matrix values.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmaply</span>(<span class="fu">normalize</span>(shan_ict_mat),</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv=</span><span class="cn">NA</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dist_method =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclust_method =</span> <span class="st">"ward.D"</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">seriate =</span> <span class="st">"OLO"</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> RdPu,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_row =</span> <span class="dv">6</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">200</span>,<span class="dv">60</span>,<span class="cn">NA</span>),</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_row =</span> <span class="dv">4</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_col =</span> <span class="dv">5</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">"Geographic Segmentation of Shan State by ICT indicators"</span>,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"ICT Indicators"</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Townships of Shan State"</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-9eceb20dc2a931752ae4" style="width:100%;height:758px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9eceb20dc2a931752ae4">{"x":{"data":[{"x":[1,2,3,4,5],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55],"z":[[0.116978282802357,0.129468002916701,0.22051676674467,0.384613999201764,0],[0.119071471357574,0.345093075355747,0.146680718622619,0.689156011292375,0.0306923094501804],[0.448112949126574,0.552259924114501,0.105215687600081,0.574129014267529,0.484807392774743],[0.394726524387261,0.646477338669936,0.19477119473094,0.398016081357507,0.307033923303471],[0.409738609943887,0.667785462581825,0.205939628052291,0.480784254803859,0.310457200410047],[0.560359050607694,0.682160053201915,0.219828980006303,0.532717729177229,0.295696949383387],[0.509783518401058,0.705849662481414,0.235277615529988,0.56572881621916,0.184217142327857],[0.445367826108455,0.648475186589583,0.400725374496756,0.525729584351687,0.325727661622098],[0.303006324046602,0.491472190827421,0.393413634291369,0.434988683676573,0.25539117902522],[0.285460565623123,0.653167734189465,0.351129977629807,0.321903369400093,0.274683722730117],[0.186896495593756,0.473621686944799,0.177547109767516,0.219017992119371,0.219238039033904],[0.262948885760044,0.600934420551276,0.105588681661233,0.309844721395711,0.32244406175046],[0.348384569046878,0.550413307218695,0.0132133117776572,0.330600515260223,0.280505026346822],[0.372116151704965,0.374968621142249,0.125060804628556,0.363502861923713,0.208286637250586],[0.382049084643175,0.495293243751349,0.165281214256075,0.332852029421132,0.126911060390332],[0.398090757930385,0.467734047728609,0.165251926083381,0.248272216763125,0.125663315216338],[0.463675071811737,0.480273489712105,0.0495176036018547,0.278454014117194,0.102240256271893],[0.454391396013767,0.585943534900779,0.144172529109699,0.304817572789695,0.117641144346071],[0.572059422162612,0.603028579702235,0.18200927177224,0.320846100415741,0.0996532209950878],[0.64202483918062,0.577864390148239,0.207338745441228,0.255258118966462,0.176074057695434],[0.469637019864802,0.49275331606036,0.336403906718691,0.326463285635126,0.199643002704722],[0.472437575771037,0.708306581316802,0.181528926899385,0.0981964513254065,0.186836974506664],[0.487021825059319,0.536184545909484,0.1623692849231,0.155474604691974,0.0744963103413769],[0.534163143993451,0.455760556744961,0.109548536966956,0.076155538926932,0.106925771850934],[0.437590296823069,0.464204461437082,0.110874787457869,0.0984403758574017,0.0985978869506665],[0.452636675796627,0.377797614010294,0.113655496814988,0.0877697005887191,0.0640685752289788],[0.318011520183019,0.341693315696117,0.0982231808523387,0.141213400161106,0.0684535703034676],[0.303905626461184,0.295734660011411,0.122161422028907,0.220797228887767,0.0933576373559664],[0.125839377932289,0.271665869542777,0.146912934029539,0.111904436916593,0.0401203752296987],[0.1648181386917,0.163070599120654,0,0,0.050562923174398],[0.292778031055123,0,0.0180206673088627,0.0205146898168363,0.0573419602932674],[0.373857483778625,0.0995290076456667,0.0295999006447705,0.0262900696870936,0.00411244014094081],[0.481303842133627,0.142297506536797,0.0316650514783228,0.0125730639984617,0.030854020566576],[1,0.198958169425964,0.0512340297746273,0.119978472699803,0.0127547808735244],[0.855314778071882,0.535580295292678,0.0954404378234391,0.180215108968874,0.107759971325446],[0.789802194306684,0.707463556363309,0.160787084615829,0.406501651460893,0.207451038928221],[0.653022272989167,0.603518277436298,0.0907572048090615,0.450320578796944,0.139286867591449],[0.708316665856044,0.59451431070864,0.199599204123416,0.410008712407441,0.140105344905725],[0.828481634580948,0.533096150331035,0.222253044854804,0.49414581896158,0.245321426698747],[0.924414874434519,0.815706630141315,0.391551407290058,0.509561826896415,0.147799896773415],[0.554582082266574,0.857899290321775,0.667007964836916,0.411501854757207,0.135186676818821],[0.217633980358742,0.65209843040106,1,0.287788284692333,0.196437751553831],[0,0.23543567048956,0.932101354458042,0.401015569024513,0.0844217926569466],[0.109374929636258,0.623942179795541,0.622050632093838,0.618872994218249,0.107369754921389],[0.213613705288465,0.545980181296846,0.462858065656792,0.555883136314662,0.089979971244949],[0.229897462083034,0.606803420347241,0.441880181094265,0.645581402670746,0.238387780704064],[0.245824811756765,0.739869228579844,0.49811595358599,0.801230600000326,0.301658910303963],[0.0694967457544946,0.911879045679933,0.736263645750856,0.973268306969539,0.362172608061988],[0.131890106624229,0.766915045456103,0.471174055309928,0.742030952777324,0.665568016626695],[0.164829658497982,0.515216701198681,0.334570254727253,0.578557341817938,0.529033034945849],[0.531763581261236,0.718177853098515,0.338119112137043,0.645068858125427,0.496659923518642],[0.463214009841455,0.777367942019409,0.357599483272661,0.611463125655814,0.638873044291007],[0.742781450226171,0.879882415822816,0.440755998903745,0.787178952652566,0.873978634377844],[0.73856184642803,0.885602038677547,0.318801655583425,1,1],[0.334059480538155,1,0.765345298573847,0.967808669559975,0.987566110737814]],"text":[["row: Narphan<br>column: RADIO_PR<br>value: 0.116978","row: Narphan<br>column: TV_PR<br>value: 0.129468","row: Narphan<br>column: LLPHONE_PR<br>value: 0.220517","row: Narphan<br>column: MPHONE_PR<br>value: 0.384614","row: Narphan<br>column: COMPUTER_PR<br>value: 0.000000"],["row: Pangwaun<br>column: RADIO_PR<br>value: 0.119071","row: Pangwaun<br>column: TV_PR<br>value: 0.345093","row: Pangwaun<br>column: LLPHONE_PR<br>value: 0.146681","row: Pangwaun<br>column: MPHONE_PR<br>value: 0.689156","row: Pangwaun<br>column: COMPUTER_PR<br>value: 0.030692"],["row: Mongpan<br>column: RADIO_PR<br>value: 0.448113","row: Mongpan<br>column: TV_PR<br>value: 0.552260","row: Mongpan<br>column: LLPHONE_PR<br>value: 0.105216","row: Mongpan<br>column: MPHONE_PR<br>value: 0.574129","row: Mongpan<br>column: COMPUTER_PR<br>value: 0.484807"],["row: Nansang<br>column: RADIO_PR<br>value: 0.394727","row: Nansang<br>column: TV_PR<br>value: 0.646477","row: Nansang<br>column: LLPHONE_PR<br>value: 0.194771","row: Nansang<br>column: MPHONE_PR<br>value: 0.398016","row: Nansang<br>column: COMPUTER_PR<br>value: 0.307034"],["row: Kyaukme<br>column: RADIO_PR<br>value: 0.409739","row: Kyaukme<br>column: TV_PR<br>value: 0.667785","row: Kyaukme<br>column: LLPHONE_PR<br>value: 0.205940","row: Kyaukme<br>column: MPHONE_PR<br>value: 0.480784","row: Kyaukme<br>column: COMPUTER_PR<br>value: 0.310457"],["row: Kalaw<br>column: RADIO_PR<br>value: 0.560359","row: Kalaw<br>column: TV_PR<br>value: 0.682160","row: Kalaw<br>column: LLPHONE_PR<br>value: 0.219829","row: Kalaw<br>column: MPHONE_PR<br>value: 0.532718","row: Kalaw<br>column: COMPUTER_PR<br>value: 0.295697"],["row: Hseni<br>column: RADIO_PR<br>value: 0.509784","row: Hseni<br>column: TV_PR<br>value: 0.705850","row: Hseni<br>column: LLPHONE_PR<br>value: 0.235278","row: Hseni<br>column: MPHONE_PR<br>value: 0.565729","row: Hseni<br>column: COMPUTER_PR<br>value: 0.184217"],["row: Langkho<br>column: RADIO_PR<br>value: 0.445368","row: Langkho<br>column: TV_PR<br>value: 0.648475","row: Langkho<br>column: LLPHONE_PR<br>value: 0.400725","row: Langkho<br>column: MPHONE_PR<br>value: 0.525730","row: Langkho<br>column: COMPUTER_PR<br>value: 0.325728"],["row: Kunhing<br>column: RADIO_PR<br>value: 0.303006","row: Kunhing<br>column: TV_PR<br>value: 0.491472","row: Kunhing<br>column: LLPHONE_PR<br>value: 0.393414","row: Kunhing<br>column: MPHONE_PR<br>value: 0.434989","row: Kunhing<br>column: COMPUTER_PR<br>value: 0.255391"],["row: Laihka<br>column: RADIO_PR<br>value: 0.285461","row: Laihka<br>column: TV_PR<br>value: 0.653168","row: Laihka<br>column: LLPHONE_PR<br>value: 0.351130","row: Laihka<br>column: MPHONE_PR<br>value: 0.321903","row: Laihka<br>column: COMPUTER_PR<br>value: 0.274684"],["row: Monghsat<br>column: RADIO_PR<br>value: 0.186896","row: Monghsat<br>column: TV_PR<br>value: 0.473622","row: Monghsat<br>column: LLPHONE_PR<br>value: 0.177547","row: Monghsat<br>column: MPHONE_PR<br>value: 0.219018","row: Monghsat<br>column: COMPUTER_PR<br>value: 0.219238"],["row: Loilen<br>column: RADIO_PR<br>value: 0.262949","row: Loilen<br>column: TV_PR<br>value: 0.600934","row: Loilen<br>column: LLPHONE_PR<br>value: 0.105589","row: Loilen<br>column: MPHONE_PR<br>value: 0.309845","row: Loilen<br>column: COMPUTER_PR<br>value: 0.322444"],["row: Mongnai<br>column: RADIO_PR<br>value: 0.348385","row: Mongnai<br>column: TV_PR<br>value: 0.550413","row: Mongnai<br>column: LLPHONE_PR<br>value: 0.013213","row: Mongnai<br>column: MPHONE_PR<br>value: 0.330601","row: Mongnai<br>column: COMPUTER_PR<br>value: 0.280505"],["row: Mongton<br>column: RADIO_PR<br>value: 0.372116","row: Mongton<br>column: TV_PR<br>value: 0.374969","row: Mongton<br>column: LLPHONE_PR<br>value: 0.125061","row: Mongton<br>column: MPHONE_PR<br>value: 0.363503","row: Mongton<br>column: COMPUTER_PR<br>value: 0.208287"],["row: Hsipaw<br>column: RADIO_PR<br>value: 0.382049","row: Hsipaw<br>column: TV_PR<br>value: 0.495293","row: Hsipaw<br>column: LLPHONE_PR<br>value: 0.165281","row: Hsipaw<br>column: MPHONE_PR<br>value: 0.332852","row: Hsipaw<br>column: COMPUTER_PR<br>value: 0.126911"],["row: Hopong<br>column: RADIO_PR<br>value: 0.398091","row: Hopong<br>column: TV_PR<br>value: 0.467734","row: Hopong<br>column: LLPHONE_PR<br>value: 0.165252","row: Hopong<br>column: MPHONE_PR<br>value: 0.248272","row: Hopong<br>column: COMPUTER_PR<br>value: 0.125663"],["row: Monghsu<br>column: RADIO_PR<br>value: 0.463675","row: Monghsu<br>column: TV_PR<br>value: 0.480273","row: Monghsu<br>column: LLPHONE_PR<br>value: 0.049518","row: Monghsu<br>column: MPHONE_PR<br>value: 0.278454","row: Monghsu<br>column: COMPUTER_PR<br>value: 0.102240"],["row: Pinlaung<br>column: RADIO_PR<br>value: 0.454391","row: Pinlaung<br>column: TV_PR<br>value: 0.585944","row: Pinlaung<br>column: LLPHONE_PR<br>value: 0.144173","row: Pinlaung<br>column: MPHONE_PR<br>value: 0.304818","row: Pinlaung<br>column: COMPUTER_PR<br>value: 0.117641"],["row: Mongmit<br>column: RADIO_PR<br>value: 0.572059","row: Mongmit<br>column: TV_PR<br>value: 0.603029","row: Mongmit<br>column: LLPHONE_PR<br>value: 0.182009","row: Mongmit<br>column: MPHONE_PR<br>value: 0.320846","row: Mongmit<br>column: COMPUTER_PR<br>value: 0.099653"],["row: Pekon<br>column: RADIO_PR<br>value: 0.642025","row: Pekon<br>column: TV_PR<br>value: 0.577864","row: Pekon<br>column: LLPHONE_PR<br>value: 0.207339","row: Pekon<br>column: MPHONE_PR<br>value: 0.255258","row: Pekon<br>column: COMPUTER_PR<br>value: 0.176074"],["row: Kutkai<br>column: RADIO_PR<br>value: 0.469637","row: Kutkai<br>column: TV_PR<br>value: 0.492753","row: Kutkai<br>column: LLPHONE_PR<br>value: 0.336404","row: Kutkai<br>column: MPHONE_PR<br>value: 0.326463","row: Kutkai<br>column: COMPUTER_PR<br>value: 0.199643"],["row: Namtu<br>column: RADIO_PR<br>value: 0.472438","row: Namtu<br>column: TV_PR<br>value: 0.708307","row: Namtu<br>column: LLPHONE_PR<br>value: 0.181529","row: Namtu<br>column: MPHONE_PR<br>value: 0.098196","row: Namtu<br>column: COMPUTER_PR<br>value: 0.186837"],["row: Hsihseng<br>column: RADIO_PR<br>value: 0.487022","row: Hsihseng<br>column: TV_PR<br>value: 0.536185","row: Hsihseng<br>column: LLPHONE_PR<br>value: 0.162369","row: Hsihseng<br>column: MPHONE_PR<br>value: 0.155475","row: Hsihseng<br>column: COMPUTER_PR<br>value: 0.074496"],["row: Kyethi<br>column: RADIO_PR<br>value: 0.534163","row: Kyethi<br>column: TV_PR<br>value: 0.455761","row: Kyethi<br>column: LLPHONE_PR<br>value: 0.109549","row: Kyethi<br>column: MPHONE_PR<br>value: 0.076156","row: Kyethi<br>column: COMPUTER_PR<br>value: 0.106926"],["row: Tangyan<br>column: RADIO_PR<br>value: 0.437590","row: Tangyan<br>column: TV_PR<br>value: 0.464204","row: Tangyan<br>column: LLPHONE_PR<br>value: 0.110875","row: Tangyan<br>column: MPHONE_PR<br>value: 0.098440","row: Tangyan<br>column: COMPUTER_PR<br>value: 0.098598"],["row: Namhsan<br>column: RADIO_PR<br>value: 0.452637","row: Namhsan<br>column: TV_PR<br>value: 0.377798","row: Namhsan<br>column: LLPHONE_PR<br>value: 0.113655","row: Namhsan<br>column: MPHONE_PR<br>value: 0.087770","row: Namhsan<br>column: COMPUTER_PR<br>value: 0.064069"],["row: Mongyai<br>column: RADIO_PR<br>value: 0.318012","row: Mongyai<br>column: TV_PR<br>value: 0.341693","row: Mongyai<br>column: LLPHONE_PR<br>value: 0.098223","row: Mongyai<br>column: MPHONE_PR<br>value: 0.141213","row: Mongyai<br>column: COMPUTER_PR<br>value: 0.068454"],["row: Mongping<br>column: RADIO_PR<br>value: 0.303906","row: Mongping<br>column: TV_PR<br>value: 0.295735","row: Mongping<br>column: LLPHONE_PR<br>value: 0.122161","row: Mongping<br>column: MPHONE_PR<br>value: 0.220797","row: Mongping<br>column: COMPUTER_PR<br>value: 0.093358"],["row: Mongkhet<br>column: RADIO_PR<br>value: 0.125839","row: Mongkhet<br>column: TV_PR<br>value: 0.271666","row: Mongkhet<br>column: LLPHONE_PR<br>value: 0.146913","row: Mongkhet<br>column: MPHONE_PR<br>value: 0.111904","row: Mongkhet<br>column: COMPUTER_PR<br>value: 0.040120"],["row: Mawkmai<br>column: RADIO_PR<br>value: 0.164818","row: Mawkmai<br>column: TV_PR<br>value: 0.163071","row: Mawkmai<br>column: LLPHONE_PR<br>value: 0.000000","row: Mawkmai<br>column: MPHONE_PR<br>value: 0.000000","row: Mawkmai<br>column: COMPUTER_PR<br>value: 0.050563"],["row: Mongkaing<br>column: RADIO_PR<br>value: 0.292778","row: Mongkaing<br>column: TV_PR<br>value: 0.000000","row: Mongkaing<br>column: LLPHONE_PR<br>value: 0.018021","row: Mongkaing<br>column: MPHONE_PR<br>value: 0.020515","row: Mongkaing<br>column: COMPUTER_PR<br>value: 0.057342"],["row: Manton<br>column: RADIO_PR<br>value: 0.373857","row: Manton<br>column: TV_PR<br>value: 0.099529","row: Manton<br>column: LLPHONE_PR<br>value: 0.029600","row: Manton<br>column: MPHONE_PR<br>value: 0.026290","row: Manton<br>column: COMPUTER_PR<br>value: 0.004112"],["row: Matman<br>column: RADIO_PR<br>value: 0.481304","row: Matman<br>column: TV_PR<br>value: 0.142298","row: Matman<br>column: LLPHONE_PR<br>value: 0.031665","row: Matman<br>column: MPHONE_PR<br>value: 0.012573","row: Matman<br>column: COMPUTER_PR<br>value: 0.030854"],["row: Ywangan<br>column: RADIO_PR<br>value: 1.000000","row: Ywangan<br>column: TV_PR<br>value: 0.198958","row: Ywangan<br>column: LLPHONE_PR<br>value: 0.051234","row: Ywangan<br>column: MPHONE_PR<br>value: 0.119978","row: Ywangan<br>column: COMPUTER_PR<br>value: 0.012755"],["row: Pindaya<br>column: RADIO_PR<br>value: 0.855315","row: Pindaya<br>column: TV_PR<br>value: 0.535580","row: Pindaya<br>column: LLPHONE_PR<br>value: 0.095440","row: Pindaya<br>column: MPHONE_PR<br>value: 0.180215","row: Pindaya<br>column: COMPUTER_PR<br>value: 0.107760"],["row: Lawksawk<br>column: RADIO_PR<br>value: 0.789802","row: Lawksawk<br>column: TV_PR<br>value: 0.707464","row: Lawksawk<br>column: LLPHONE_PR<br>value: 0.160787","row: Lawksawk<br>column: MPHONE_PR<br>value: 0.406502","row: Lawksawk<br>column: COMPUTER_PR<br>value: 0.207451"],["row: Nyaungshwe<br>column: RADIO_PR<br>value: 0.653022","row: Nyaungshwe<br>column: TV_PR<br>value: 0.603518","row: Nyaungshwe<br>column: LLPHONE_PR<br>value: 0.090757","row: Nyaungshwe<br>column: MPHONE_PR<br>value: 0.450321","row: Nyaungshwe<br>column: COMPUTER_PR<br>value: 0.139287"],["row: Nawnghkio<br>column: RADIO_PR<br>value: 0.708317","row: Nawnghkio<br>column: TV_PR<br>value: 0.594514","row: Nawnghkio<br>column: LLPHONE_PR<br>value: 0.199599","row: Nawnghkio<br>column: MPHONE_PR<br>value: 0.410009","row: Nawnghkio<br>column: COMPUTER_PR<br>value: 0.140105"],["row: Monghpyak<br>column: RADIO_PR<br>value: 0.828482","row: Monghpyak<br>column: TV_PR<br>value: 0.533096","row: Monghpyak<br>column: LLPHONE_PR<br>value: 0.222253","row: Monghpyak<br>column: MPHONE_PR<br>value: 0.494146","row: Monghpyak<br>column: COMPUTER_PR<br>value: 0.245321"],["row: Mabein<br>column: RADIO_PR<br>value: 0.924415","row: Mabein<br>column: TV_PR<br>value: 0.815707","row: Mabein<br>column: LLPHONE_PR<br>value: 0.391551","row: Mabein<br>column: MPHONE_PR<br>value: 0.509562","row: Mabein<br>column: COMPUTER_PR<br>value: 0.147800"],["row: Mongyawng<br>column: RADIO_PR<br>value: 0.554582","row: Mongyawng<br>column: TV_PR<br>value: 0.857899","row: Mongyawng<br>column: LLPHONE_PR<br>value: 0.667008","row: Mongyawng<br>column: MPHONE_PR<br>value: 0.411502","row: Mongyawng<br>column: COMPUTER_PR<br>value: 0.135187"],["row: Kunlong<br>column: RADIO_PR<br>value: 0.217634","row: Kunlong<br>column: TV_PR<br>value: 0.652098","row: Kunlong<br>column: LLPHONE_PR<br>value: 1.000000","row: Kunlong<br>column: MPHONE_PR<br>value: 0.287788","row: Kunlong<br>column: COMPUTER_PR<br>value: 0.196438"],["row: Konkyan<br>column: RADIO_PR<br>value: 0.000000","row: Konkyan<br>column: TV_PR<br>value: 0.235436","row: Konkyan<br>column: LLPHONE_PR<br>value: 0.932101","row: Konkyan<br>column: MPHONE_PR<br>value: 0.401016","row: Konkyan<br>column: COMPUTER_PR<br>value: 0.084422"],["row: Mongyang<br>column: RADIO_PR<br>value: 0.109375","row: Mongyang<br>column: TV_PR<br>value: 0.623942","row: Mongyang<br>column: LLPHONE_PR<br>value: 0.622051","row: Mongyang<br>column: MPHONE_PR<br>value: 0.618873","row: Mongyang<br>column: COMPUTER_PR<br>value: 0.107370"],["row: Mongmao<br>column: RADIO_PR<br>value: 0.213614","row: Mongmao<br>column: TV_PR<br>value: 0.545980","row: Mongmao<br>column: LLPHONE_PR<br>value: 0.462858","row: Mongmao<br>column: MPHONE_PR<br>value: 0.555883","row: Mongmao<br>column: COMPUTER_PR<br>value: 0.089980"],["row: Hopang<br>column: RADIO_PR<br>value: 0.229897","row: Hopang<br>column: TV_PR<br>value: 0.606803","row: Hopang<br>column: LLPHONE_PR<br>value: 0.441880","row: Hopang<br>column: MPHONE_PR<br>value: 0.645581","row: Hopang<br>column: COMPUTER_PR<br>value: 0.238388"],["row: Namhkan<br>column: RADIO_PR<br>value: 0.245825","row: Namhkan<br>column: TV_PR<br>value: 0.739869","row: Namhkan<br>column: LLPHONE_PR<br>value: 0.498116","row: Namhkan<br>column: MPHONE_PR<br>value: 0.801231","row: Namhkan<br>column: COMPUTER_PR<br>value: 0.301659"],["row: Laukkaing<br>column: RADIO_PR<br>value: 0.069497","row: Laukkaing<br>column: TV_PR<br>value: 0.911879","row: Laukkaing<br>column: LLPHONE_PR<br>value: 0.736264","row: Laukkaing<br>column: MPHONE_PR<br>value: 0.973268","row: Laukkaing<br>column: COMPUTER_PR<br>value: 0.362173"],["row: Mongla<br>column: RADIO_PR<br>value: 0.131890","row: Mongla<br>column: TV_PR<br>value: 0.766915","row: Mongla<br>column: LLPHONE_PR<br>value: 0.471174","row: Mongla<br>column: MPHONE_PR<br>value: 0.742031","row: Mongla<br>column: COMPUTER_PR<br>value: 0.665568"],["row: Pangsang<br>column: RADIO_PR<br>value: 0.164830","row: Pangsang<br>column: TV_PR<br>value: 0.515217","row: Pangsang<br>column: LLPHONE_PR<br>value: 0.334570","row: Pangsang<br>column: MPHONE_PR<br>value: 0.578557","row: Pangsang<br>column: COMPUTER_PR<br>value: 0.529033"],["row: Kengtung<br>column: RADIO_PR<br>value: 0.531764","row: Kengtung<br>column: TV_PR<br>value: 0.718178","row: Kengtung<br>column: LLPHONE_PR<br>value: 0.338119","row: Kengtung<br>column: MPHONE_PR<br>value: 0.645069","row: Kengtung<br>column: COMPUTER_PR<br>value: 0.496660"],["row: Lashio<br>column: RADIO_PR<br>value: 0.463214","row: Lashio<br>column: TV_PR<br>value: 0.777368","row: Lashio<br>column: LLPHONE_PR<br>value: 0.357599","row: Lashio<br>column: MPHONE_PR<br>value: 0.611463","row: Lashio<br>column: COMPUTER_PR<br>value: 0.638873"],["row: Taunggyi<br>column: RADIO_PR<br>value: 0.742781","row: Taunggyi<br>column: TV_PR<br>value: 0.879882","row: Taunggyi<br>column: LLPHONE_PR<br>value: 0.440756","row: Taunggyi<br>column: MPHONE_PR<br>value: 0.787179","row: Taunggyi<br>column: COMPUTER_PR<br>value: 0.873979"],["row: Tachileik<br>column: RADIO_PR<br>value: 0.738562","row: Tachileik<br>column: TV_PR<br>value: 0.885602","row: Tachileik<br>column: LLPHONE_PR<br>value: 0.318802","row: Tachileik<br>column: MPHONE_PR<br>value: 1.000000","row: Tachileik<br>column: COMPUTER_PR<br>value: 1.000000"],["row: Muse<br>column: RADIO_PR<br>value: 0.334059","row: Muse<br>column: TV_PR<br>value: 1.000000","row: Muse<br>column: LLPHONE_PR<br>value: 0.765345","row: Muse<br>column: MPHONE_PR<br>value: 0.967809","row: Muse<br>column: COMPUTER_PR<br>value: 0.987566"]],"colorscale":[[0,"#FFF7F3"],[0.00411244014094081,"#FEF6F2"],[0.0125730639984617,"#FEF4F0"],[0.0127547808735244,"#FEF4F0"],[0.0132133117776572,"#FEF4F0"],[0.0180206673088627,"#FEF3EF"],[0.0205146898168363,"#FEF3EF"],[0.0262900696870936,"#FEF1EE"],[0.0295999006447705,"#FEF1ED"],[0.0306923094501804,"#FEF1ED"],[0.030854020566576,"#FEF1ED"],[0.0316650514783228,"#FEF1ED"],[0.0401203752296987,"#FEEFEC"],[0.0495176036018547,"#FEEDEA"],[0.050562923174398,"#FEEDEA"],[0.0512340297746273,"#FEEDEA"],[0.0573419602932674,"#FEECE8"],[0.0640685752289788,"#FDEBE7"],[0.0684535703034676,"#FDEAE7"],[0.0694967457544946,"#FDEAE6"],[0.0744963103413769,"#FDE9E5"],[0.076155538926932,"#FDE9E5"],[0.0844217926569466,"#FDE7E3"],[0.0877697005887191,"#FDE7E3"],[0.089979971244949,"#FDE6E3"],[0.0907572048090615,"#FDE6E3"],[0.0933576373559664,"#FDE5E2"],[0.0954404378234391,"#FDE5E2"],[0.0981964513254065,"#FDE4E1"],[0.0982231808523387,"#FDE4E1"],[0.0984403758574017,"#FDE4E1"],[0.0985978869506665,"#FDE4E1"],[0.0995290076456667,"#FDE4E1"],[0.0996532209950878,"#FDE4E1"],[0.102240256271893,"#FDE4E1"],[0.105215687600081,"#FDE3E0"],[0.105588681661233,"#FDE3E0"],[0.106925771850934,"#FDE3E0"],[0.107369754921389,"#FDE3E0"],[0.107759971325446,"#FDE3E0"],[0.109374929636258,"#FDE2DF"],[0.109548536966956,"#FDE2DF"],[0.110874787457869,"#FDE2DF"],[0.111904436916593,"#FDE2DE"],[0.113655496814988,"#FDE2DE"],[0.116978282802357,"#FDE1DE"],[0.117641144346071,"#FDE1DE"],[0.119071471357574,"#FDE1DE"],[0.119978472699803,"#FDE0DD"],[0.122161422028907,"#FDE0DD"],[0.125060804628556,"#FCDFDC"],[0.125663315216338,"#FCDFDC"],[0.125839377932289,"#FCDFDC"],[0.126911060390332,"#FCDFDC"],[0.129468002916701,"#FCDFDB"],[0.131890106624229,"#FCDEDB"],[0.135186676818821,"#FCDEDB"],[0.139286867591449,"#FCDCD9"],[0.140105344905725,"#FCDCD9"],[0.141213400161106,"#FCDCD9"],[0.142297506536797,"#FCDCD9"],[0.144172529109699,"#FCDBD8"],[0.146680718622619,"#FCDBD8"],[0.146912934029539,"#FCDBD8"],[0.147799896773415,"#FCDAD7"],[0.155474604691974,"#FCD9D5"],[0.160787084615829,"#FCD8D4"],[0.1623692849231,"#FCD8D4"],[0.163070599120654,"#FCD7D3"],[0.1648181386917,"#FCD7D3"],[0.164829658497982,"#FCD7D3"],[0.165251926083381,"#FCD7D3"],[0.165281214256075,"#FCD7D3"],[0.176074057695434,"#FCD4D1"],[0.177547109767516,"#FCD4D1"],[0.180215108968874,"#FCD4D0"],[0.181528926899385,"#FCD4D0"],[0.18200927177224,"#FCD4D0"],[0.184217142327857,"#FCD3CF"],[0.186836974506664,"#FCD2CE"],[0.186896495593756,"#FCD2CE"],[0.19477119473094,"#FCD0CC"],[0.196437751553831,"#FCD0CC"],[0.198958169425964,"#FCCFCB"],[0.199599204123416,"#FCCFCB"],[0.199643002704722,"#FCCFCB"],[0.205939628052291,"#FCCEC9"],[0.207338745441228,"#FCCEC9"],[0.207451038928221,"#FCCEC9"],[0.208286637250586,"#FCCEC9"],[0.213613705288465,"#FCCDC8"],[0.217633980358742,"#FCCCC7"],[0.219017992119371,"#FCCBC7"],[0.219238039033904,"#FCCBC7"],[0.219828980006303,"#FCCBC7"],[0.22051676674467,"#FCCBC7"],[0.220797228887767,"#FCCBC7"],[0.222253044854804,"#FCCAC6"],[0.229897462083034,"#FCC9C4"],[0.235277615529988,"#FCC8C3"],[0.23543567048956,"#FCC8C3"],[0.238387780704064,"#FCC7C2"],[0.245321426698747,"#FCC5C0"],[0.245824811756765,"#FCC5C0"],[0.248272216763125,"#FCC5C0"],[0.255258118966462,"#FBC3BF"],[0.25539117902522,"#FBC3BF"],[0.262948885760044,"#FBC1BE"],[0.271665869542777,"#FBBEBE"],[0.274683722730117,"#FBBDBD"],[0.278454014117194,"#FBBCBD"],[0.280505026346822,"#FBBBBD"],[0.285460565623123,"#FBB9BC"],[0.287788284692333,"#FBB9BC"],[0.292778031055123,"#FBB7BC"],[0.295696949383387,"#FBB7BC"],[0.295734660011411,"#FBB7BC"],[0.301658910303963,"#FBB5BB"],[0.303006324046602,"#FBB5BB"],[0.303905626461184,"#FBB5BB"],[0.304817572789695,"#FBB4BB"],[0.307033923303471,"#FBB3BB"],[0.309844721395711,"#FBB2BA"],[0.310457200410047,"#FBB2BA"],[0.318011520183019,"#FAB0BA"],[0.318801655583425,"#FAB0BA"],[0.320846100415741,"#FAAFB9"],[0.321903369400093,"#FAAFB9"],[0.32244406175046,"#FAAFB9"],[0.325727661622098,"#FAAEB9"],[0.326463285635126,"#FAAEB9"],[0.330600515260223,"#FAACB9"],[0.332852029421132,"#FAABB8"],[0.334059480538155,"#FAABB8"],[0.334570254727253,"#FAABB8"],[0.336403906718691,"#FAAAB8"],[0.338119112137043,"#FAAAB8"],[0.341693315696117,"#FAA9B7"],[0.345093075355747,"#FAA8B7"],[0.348384569046878,"#FAA6B7"],[0.351129977629807,"#FAA5B6"],[0.357599483272661,"#FAA4B6"],[0.362172608061988,"#FAA3B6"],[0.363502861923713,"#FAA2B5"],[0.372116151704965,"#FA9FB5"],[0.373857483778625,"#FA9FB5"],[0.374968621142249,"#F99EB4"],[0.377797614010294,"#F99DB4"],[0.382049084643175,"#F99BB4"],[0.384613999201764,"#F99AB3"],[0.391551407290058,"#F997B2"],[0.393413634291369,"#F996B2"],[0.394726524387261,"#F996B1"],[0.398016081357507,"#F994B1"],[0.398090757930385,"#F994B1"],[0.400725374496756,"#F993B1"],[0.401015569024513,"#F993B1"],[0.406501651460893,"#F991AF"],[0.409738609943887,"#F98FAF"],[0.410008712407441,"#F98FAF"],[0.411501854757207,"#F98EAF"],[0.434988683676573,"#F884AB"],[0.437590296823069,"#F883AA"],[0.440755998903745,"#F882AA"],[0.441880181094265,"#F881AA"],[0.445367826108455,"#F880A9"],[0.448112949126574,"#F87EA9"],[0.450320578796944,"#F87DA8"],[0.452636675796627,"#F87CA8"],[0.454391396013767,"#F87BA8"],[0.455760556744961,"#F87BA8"],[0.462858065656792,"#F778A6"],[0.463214009841455,"#F778A6"],[0.463675071811737,"#F778A6"],[0.464204461437082,"#F777A6"],[0.467734047728609,"#F775A6"],[0.469637019864802,"#F774A5"],[0.471174055309928,"#F774A5"],[0.472437575771037,"#F774A5"],[0.473621686944799,"#F773A5"],[0.480273489712105,"#F770A4"],[0.480784254803859,"#F770A3"],[0.481303842133627,"#F770A3"],[0.484807392774743,"#F76EA3"],[0.487021825059319,"#F76EA3"],[0.491472190827421,"#F76BA2"],[0.49275331606036,"#F76BA1"],[0.49414581896158,"#F76AA1"],[0.495293243751349,"#F769A1"],[0.496659923518642,"#F769A1"],[0.49811595358599,"#F768A1"],[0.509561826896415,"#F463A0"],[0.509783518401058,"#F463A0"],[0.515216701198681,"#F4619F"],[0.525729584351687,"#F15D9E"],[0.529033034945849,"#F05B9E"],[0.531763581261236,"#F05A9E"],[0.532717729177229,"#F05A9E"],[0.533096150331035,"#F05A9E"],[0.534163143993451,"#F05A9E"],[0.535580295292678,"#EF599E"],[0.536184545909484,"#EF599E"],[0.545980181296846,"#ED559D"],[0.550413307218695,"#EC529D"],[0.552259924114501,"#EB519C"],[0.554582082266574,"#EB519C"],[0.555883136314662,"#EB509C"],[0.560359050607694,"#EA4E9C"],[0.56572881621916,"#E94C9B"],[0.572059422162612,"#E7499B"],[0.574129014267529,"#E7499B"],[0.577864390148239,"#E7479A"],[0.578557341817938,"#E6479A"],[0.585943534900779,"#E5449A"],[0.59451431070864,"#E34099"],[0.600934420551276,"#E23E99"],[0.603028579702235,"#E13C98"],[0.603518277436298,"#E13C98"],[0.606803420347241,"#E03B98"],[0.611463125655814,"#DF3998"],[0.618872994218249,"#DE3697"],[0.622050632093838,"#DD3597"],[0.623942179795541,"#DD3497"],[0.638873044291007,"#D72E94"],[0.64202483918062,"#D62D93"],[0.645068858125427,"#D52B93"],[0.645581402670746,"#D52B92"],[0.646477338669936,"#D42A92"],[0.648475186589583,"#D42A92"],[0.65209843040106,"#D22891"],[0.653022272989167,"#D22891"],[0.653167734189465,"#D22891"],[0.665568016626695,"#CD238E"],[0.667007964836916,"#CD238E"],[0.667785462581825,"#CC228E"],[0.682160053201915,"#C71C8B"],[0.689156011292375,"#C41989"],[0.705849662481414,"#BE1386"],[0.707463556363309,"#BE1286"],[0.708306581316802,"#BD1286"],[0.708316665856044,"#BD1286"],[0.718177853098515,"#BA0E84"],[0.736263645750856,"#B30680"],[0.73856184642803,"#B20580"],[0.739869228579844,"#B1057F"],[0.742030952777324,"#B1047F"],[0.742781450226171,"#B0037F"],[0.765345298573847,"#A7017D"],[0.766915045456103,"#A6017C"],[0.777367942019409,"#A2017C"],[0.787178952652566,"#9E017B"],[0.789802194306684,"#9D017B"],[0.801230600000326,"#98017B"],[0.815706630141315,"#92017A"],[0.828481634580948,"#8D0179"],[0.855314778071882,"#820178"],[0.857899290321775,"#800177"],[0.873978634377844,"#7A0177"],[0.879882415822816,"#780076"],[0.885602038677547,"#750075"],[0.911879045679933,"#6B0072"],[0.924414874434519,"#660071"],[0.932101354458042,"#630070"],[0.967808669559975,"#55006D"],[0.973268306969539,"#53006C"],[0.987566110737814,"#4D006B"],[1,"#49006A"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_43f188579527a1d8a81fcfafeebf2f04","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#FFF7F3"],[0.00334448160535117,"#FEF6F2"],[0.00668896321070234,"#FEF5F1"],[0.0100334448160535,"#FEF4F0"],[0.0133779264214047,"#FEF4F0"],[0.0167224080267559,"#FEF4F0"],[0.020066889632107,"#FEF3EF"],[0.0234113712374582,"#FEF2EE"],[0.0267558528428094,"#FEF1EE"],[0.0301003344481605,"#FEF1ED"],[0.0334448160535117,"#FEF0EC"],[0.0367892976588629,"#FEF0EC"],[0.040133779264214,"#FEEFEC"],[0.0434782608695652,"#FEEFEB"],[0.0468227424749164,"#FEEEEA"],[0.0501672240802676,"#FEEDEA"],[0.0535117056856187,"#FEECE9"],[0.0568561872909699,"#FEECE9"],[0.0602006688963211,"#FEECE8"],[0.0635451505016722,"#FDEBE7"],[0.0668896321070234,"#FDEAE7"],[0.0702341137123746,"#FDEAE6"],[0.0735785953177257,"#FDE9E5"],[0.0769230769230769,"#FDE8E5"],[0.0802675585284281,"#FDE8E5"],[0.0836120401337793,"#FDE7E4"],[0.0869565217391304,"#FDE7E3"],[0.0903010033444816,"#FDE6E3"],[0.0936454849498328,"#FDE5E2"],[0.096989966555184,"#FDE4E1"],[0.100334448160535,"#FDE4E1"],[0.103678929765886,"#FDE4E1"],[0.107023411371237,"#FDE3E0"],[0.110367892976589,"#FDE2DF"],[0.11371237458194,"#FDE2DE"],[0.117056856187291,"#FDE1DE"],[0.120401337792642,"#FDE0DD"],[0.123745819397993,"#FCDFDC"],[0.127090301003344,"#FCDFDC"],[0.130434782608696,"#FCDFDB"],[0.133779264214047,"#FCDEDB"],[0.137123745819398,"#FCDDDA"],[0.140468227424749,"#FCDCD9"],[0.1438127090301,"#FCDBD8"],[0.147157190635451,"#FCDAD7"],[0.150501672240803,"#FCDAD7"],[0.153846153846154,"#FCD9D6"],[0.157190635451505,"#FCD9D5"],[0.160535117056856,"#FCD8D4"],[0.163879598662207,"#FCD7D3"],[0.167224080267559,"#FCD6D2"],[0.17056856187291,"#FCD6D2"],[0.173913043478261,"#FCD5D1"],[0.177257525083612,"#FCD4D1"],[0.180602006688963,"#FCD4D0"],[0.183946488294314,"#FCD3CF"],[0.187290969899666,"#FCD2CE"],[0.190635451505017,"#FCD1CD"],[0.193979933110368,"#FCD1CD"],[0.197324414715719,"#FCD0CC"],[0.20066889632107,"#FCCFCB"],[0.204013377926421,"#FCCECA"],[0.207357859531773,"#FCCEC9"],[0.210702341137124,"#FCCDC8"],[0.214046822742475,"#FCCCC7"],[0.217391304347826,"#FCCCC7"],[0.220735785953177,"#FCCBC7"],[0.224080267558528,"#FCCAC6"],[0.22742474916388,"#FCC9C5"],[0.230769230769231,"#FCC9C4"],[0.234113712374582,"#FCC8C3"],[0.237458193979933,"#FCC7C2"],[0.240802675585284,"#FCC7C2"],[0.244147157190635,"#FCC6C1"],[0.247491638795987,"#FCC5C0"],[0.250836120401338,"#FBC4BF"],[0.254180602006689,"#FBC3BF"],[0.25752508361204,"#FBC2BF"],[0.260869565217391,"#FBC1BE"],[0.264214046822742,"#FBC0BE"],[0.267558528428094,"#FBBFBE"],[0.270903010033445,"#FBBEBE"],[0.274247491638796,"#FBBDBD"],[0.277591973244147,"#FBBCBD"],[0.280936454849498,"#FBBBBD"],[0.284280936454849,"#FBBABD"],[0.287625418060201,"#FBB9BC"],[0.290969899665552,"#FBB8BC"],[0.294314381270903,"#FBB7BC"],[0.297658862876254,"#FBB6BB"],[0.301003344481605,"#FBB5BB"],[0.304347826086957,"#FBB4BB"],[0.307692307692308,"#FBB3BB"],[0.311036789297659,"#FBB2BA"],[0.31438127090301,"#FAB1BA"],[0.317725752508361,"#FAB0BA"],[0.321070234113712,"#FAAFB9"],[0.324414715719064,"#FAAEB9"],[0.327759197324415,"#FAADB9"],[0.331103678929766,"#FAACB9"],[0.334448160535117,"#FAABB8"],[0.337792642140468,"#FAAAB8"],[0.341137123745819,"#FAA9B7"],[0.344481605351171,"#FAA8B7"],[0.347826086956522,"#FAA7B7"],[0.351170568561873,"#FAA5B6"],[0.354515050167224,"#FAA5B6"],[0.357859531772575,"#FAA4B6"],[0.361204013377926,"#FAA3B6"],[0.364548494983278,"#FAA2B5"],[0.367892976588629,"#FAA0B5"],[0.37123745819398,"#FA9FB5"],[0.374581939799331,"#F99EB4"],[0.377926421404682,"#F99DB4"],[0.381270903010033,"#F99CB4"],[0.384615384615385,"#F99AB3"],[0.387959866220736,"#F999B2"],[0.391304347826087,"#F997B2"],[0.394648829431438,"#F996B1"],[0.397993311036789,"#F994B1"],[0.40133779264214,"#F993B1"],[0.404682274247492,"#F992B0"],[0.408026755852843,"#F990AF"],[0.411371237458194,"#F98EAF"],[0.414715719063545,"#F98DAE"],[0.418060200668896,"#F88CAD"],[0.421404682274247,"#F88AAD"],[0.424749163879599,"#F888AD"],[0.42809364548495,"#F887AC"],[0.431438127090301,"#F886AB"],[0.434782608695652,"#F884AB"],[0.438127090301003,"#F883AA"],[0.441471571906354,"#F881AA"],[0.444816053511706,"#F880AA"],[0.448160535117057,"#F87EA9"],[0.451505016722408,"#F87DA8"],[0.454849498327759,"#F87BA8"],[0.45819397993311,"#F77AA7"],[0.461538461538462,"#F779A6"],[0.464882943143813,"#F777A6"],[0.468227424749164,"#F775A6"],[0.471571906354515,"#F774A5"],[0.474916387959866,"#F773A5"],[0.478260869565217,"#F771A4"],[0.481605351170569,"#F76FA3"],[0.48494983277592,"#F76EA3"],[0.488294314381271,"#F76DA2"],[0.491638795986622,"#F76BA2"],[0.494983277591973,"#F76AA1"],[0.498327759197324,"#F768A1"],[0.501672240802676,"#F667A0"],[0.505016722408027,"#F565A0"],[0.508361204013378,"#F464A0"],[0.511705685618729,"#F463A0"],[0.51505016722408,"#F4619F"],[0.518394648829431,"#F3609F"],[0.521739130434783,"#F25F9F"],[0.525083612040134,"#F15D9E"],[0.528428093645485,"#F05C9E"],[0.531772575250836,"#F05A9E"],[0.535117056856187,"#F0599E"],[0.538461538461538,"#EF579E"],[0.54180602006689,"#EE569D"],[0.545150501672241,"#ED559D"],[0.548494983277592,"#EC539D"],[0.551839464882943,"#EB529C"],[0.555183946488294,"#EB509C"],[0.558528428093645,"#EB4F9C"],[0.561872909698997,"#EA4E9C"],[0.565217391304348,"#E94D9B"],[0.568561872909699,"#E84B9B"],[0.57190635451505,"#E7499B"],[0.575250836120401,"#E7489A"],[0.578595317725752,"#E6479A"],[0.581939799331104,"#E6459A"],[0.585284280936455,"#E5449A"],[0.588628762541806,"#E44399"],[0.591973244147157,"#E34199"],[0.595317725752508,"#E34099"],[0.598662207357859,"#E23F99"],[0.602006688963211,"#E13D98"],[0.605351170568562,"#E13C98"],[0.608695652173913,"#E03B98"],[0.612040133779264,"#DF3998"],[0.615384615384615,"#DE3797"],[0.618729096989967,"#DE3697"],[0.622073578595318,"#DD3597"],[0.625418060200669,"#DD3497"],[0.62876254180602,"#DB3296"],[0.632107023411371,"#DA3195"],[0.635451505016722,"#D92F94"],[0.638795986622074,"#D72E94"],[0.642140468227425,"#D62D93"],[0.645484949832776,"#D52B92"],[0.648829431438127,"#D42A92"],[0.652173913043478,"#D22891"],[0.655518394648829,"#D12791"],[0.658862876254181,"#D02690"],[0.662207357859532,"#CE248F"],[0.665551839464883,"#CD238E"],[0.668896321070234,"#CC228D"],[0.672240802675585,"#CB208D"],[0.675585284280936,"#C91F8D"],[0.678929765886288,"#C81E8C"],[0.682274247491639,"#C71C8B"],[0.68561872909699,"#C51A8A"],[0.688963210702341,"#C41989"],[0.692307692307692,"#C31889"],[0.695652173913043,"#C21789"],[0.698996655518395,"#C11688"],[0.702341137123746,"#C01487"],[0.705685618729097,"#BE1386"],[0.709030100334448,"#BD1186"],[0.712374581939799,"#BC1085"],[0.71571906354515,"#BA0E84"],[0.719063545150502,"#B90D84"],[0.722408026755853,"#B80C83"],[0.725752508361204,"#B70B82"],[0.729096989966555,"#B50982"],[0.732441471571906,"#B40781"],[0.735785953177257,"#B30680"],[0.739130434782609,"#B20580"],[0.74247491638796,"#B0037F"],[0.745819397993311,"#AF027E"],[0.749163879598662,"#AE017E"],[0.752508361204013,"#AC017D"],[0.755852842809364,"#AB017D"],[0.759197324414716,"#AA017D"],[0.762541806020067,"#A8017D"],[0.765886287625418,"#A7017D"],[0.769230769230769,"#A6017C"],[0.77257525083612,"#A4017C"],[0.775919732441472,"#A2017C"],[0.779264214046823,"#A1017C"],[0.782608695652174,"#A0017C"],[0.785953177257525,"#9F017C"],[0.789297658862876,"#9D017B"],[0.792642140468227,"#9C017B"],[0.795986622073579,"#9A017B"],[0.79933110367893,"#99017B"],[0.802675585284281,"#98017A"],[0.806020066889632,"#96017A"],[0.809364548494983,"#95017A"],[0.812709030100334,"#94017A"],[0.816053511705686,"#92017A"],[0.819397993311037,"#91017A"],[0.822742474916388,"#8F0179"],[0.826086956521739,"#8E0179"],[0.82943143812709,"#8C0179"],[0.832775919732441,"#8B0179"],[0.836120401337793,"#8A0179"],[0.839464882943144,"#880179"],[0.842809364548495,"#870178"],[0.846153846153846,"#850178"],[0.849498327759197,"#840178"],[0.852842809364548,"#830178"],[0.8561872909699,"#810178"],[0.859531772575251,"#800177"],[0.862876254180602,"#7F0177"],[0.866220735785953,"#7D0177"],[0.869565217391304,"#7C0177"],[0.872909698996655,"#7A0177"],[0.876254180602007,"#790177"],[0.879598662207358,"#780076"],[0.882943143812709,"#770076"],[0.88628762541806,"#750075"],[0.889632107023411,"#740075"],[0.892976588628763,"#730075"],[0.896321070234114,"#710074"],[0.899665551839465,"#700074"],[0.903010033444816,"#6E0074"],[0.906354515050167,"#6D0073"],[0.909698996655518,"#6C0073"],[0.91304347826087,"#6A0072"],[0.916387959866221,"#690072"],[0.919732441471572,"#680072"],[0.923076923076923,"#670072"],[0.926421404682274,"#660071"],[0.929765886287625,"#640071"],[0.933110367892977,"#630070"],[0.936454849498328,"#610070"],[0.939799331103679,"#600070"],[0.94314381270903,"#5F006F"],[0.946488294314381,"#5D006F"],[0.949832775919732,"#5C006F"],[0.953177257525084,"#5B006E"],[0.956521739130435,"#59006E"],[0.959866220735786,"#58006E"],[0.963210702341137,"#57006D"],[0.966555183946488,"#56006D"],[0.969899665551839,"#54006D"],[0.973244147157191,"#53006C"],[0.976588628762542,"#52006C"],[0.979933110367893,"#50006C"],[0.983277591973244,"#4F006B"],[0.986622073578595,"#4E006B"],[0.989966555183946,"#4D006B"],[0.993311036789298,"#4B006A"],[0.996655518394649,"#4A006A"],[1,"#49006A"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.09087788975901,1.09087788975901,null,1.09087788975901,0.500949721963311,null,0.500949721963311,0.500949721963311,null,0.500949721963311,0,null,0.500949721963311,0.500949721963311,null,0.500949721963311,0],"y":[45.609375,42.5,null,42.5,42.5,null,42.5,42,null,42,42,null,42.5,43,null,43,43],"text":["y: 1.09087789","y: 1.09087789",null,"y: 1.09087789","y: 1.09087789",null,"y: 0.50094972","y: 0.50094972",null,"y: 0.50094972","y: 0.50094972",null,"y: 0.50094972","y: 0.50094972",null,"y: 0.50094972","y: 0.50094972"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid)","legendgroup":"(#39BEB1,solid)","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.09087788975901,1.09087788975901,null,1.09087788975901,0.731800222126064,null,0.731800222126064,0.731800222126064,null,0.731800222126064,0.691159533269081,null,0.691159533269081,0.691159533269081,null,0.691159533269081,0.380627098188748,null,0.380627098188748,0.380627098188748,null,0.380627098188748,0.255264316891836,null,0.255264316891836,0.255264316891836,null,0.255264316891836,0,null,0.255264316891836,0.255264316891836,null,0.255264316891836,0.185675404080306,null,0.185675404080306,0.185675404080306,null,0.185675404080306,0,null,0.185675404080306,0.185675404080306,null,0.185675404080306,0,null,0.380627098188748,0.380627098188748,null,0.380627098188748,0,null,0.691159533269081,0.691159533269081,null,0.691159533269081,0,null,0.731800222126064,0.731800222126064,null,0.731800222126064,0.466807582689693,null,0.466807582689693,0.466807582689693,null,0.466807582689693,0.358417482296682,null,0.358417482296682,0.358417482296682,null,0.358417482296682,0,null,0.358417482296682,0.358417482296682,null,0.358417482296682,0,null,0.466807582689693,0.466807582689693,null,0.466807582689693,0.173019976310583,null,0.173019976310583,0.173019976310583,null,0.173019976310583,0,null,0.173019976310583,0.173019976310583,null,0.173019976310583,0],"y":[45.609375,48.71875,null,48.71875,48.71875,null,48.71875,46.9375,null,46.9375,46.9375,null,46.9375,45.875,null,45.875,45.875,null,45.875,44.75,null,44.75,44.75,null,44.75,44,null,44,44,null,44.75,45.5,null,45.5,45.5,null,45.5,45,null,45,45,null,45.5,46,null,46,46,null,45.875,47,null,47,47,null,46.9375,48,null,48,48,null,48.71875,50.5,null,50.5,50.5,null,50.5,49.5,null,49.5,49.5,null,49.5,49,null,49,49,null,49.5,50,null,50,50,null,50.5,51.5,null,51.5,51.5,null,51.5,51,null,51,51,null,51.5,52,null,52,52],"text":["y: 1.09087789","y: 1.09087789",null,"y: 1.09087789","y: 1.09087789",null,"y: 0.73180022","y: 0.73180022",null,"y: 0.73180022","y: 0.73180022",null,"y: 0.69115953","y: 0.69115953",null,"y: 0.69115953","y: 0.69115953",null,"y: 0.38062710","y: 0.38062710",null,"y: 0.38062710","y: 0.38062710",null,"y: 0.25526432","y: 0.25526432",null,"y: 0.25526432","y: 0.25526432",null,"y: 0.25526432","y: 0.25526432",null,"y: 0.25526432","y: 0.25526432",null,"y: 0.18567540","y: 0.18567540",null,"y: 0.18567540","y: 0.18567540",null,"y: 0.18567540","y: 0.18567540",null,"y: 0.18567540","y: 0.18567540",null,"y: 0.38062710","y: 0.38062710",null,"y: 0.38062710","y: 0.38062710",null,"y: 0.69115953","y: 0.69115953",null,"y: 0.69115953","y: 0.69115953",null,"y: 0.73180022","y: 0.73180022",null,"y: 0.73180022","y: 0.73180022",null,"y: 0.46680758","y: 0.46680758",null,"y: 0.46680758","y: 0.46680758",null,"y: 0.35841748","y: 0.35841748",null,"y: 0.35841748","y: 0.35841748",null,"y: 0.35841748","y: 0.35841748",null,"y: 0.35841748","y: 0.35841748",null,"y: 0.46680758","y: 0.46680758",null,"y: 0.46680758","y: 0.46680758",null,"y: 0.17301998","y: 0.17301998",null,"y: 0.17301998","y: 0.17301998",null,"y: 0.17301998","y: 0.17301998",null,"y: 0.17301998","y: 0.17301998"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(125,176,221,1)","dash":"solid"},"hoveron":"points","name":"(#7DB0DD,solid)","legendgroup":"(#7DB0DD,solid)","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.05439722722438,1.05439722722438,null,1.05439722722438,0.47350573521867,null,0.47350573521867,0.47350573521867,null,0.47350573521867,0,null,0.47350573521867,0.47350573521867,null,0.47350573521867,0],"y":[37.859375,40.5,null,40.5,40.5,null,40.5,40,null,40,40,null,40.5,41,null,41,41],"text":["y: 1.05439723","y: 1.05439723",null,"y: 1.05439723","y: 1.05439723",null,"y: 0.47350574","y: 0.47350574",null,"y: 0.47350574","y: 0.47350574",null,"y: 0.47350574","y: 0.47350574",null,"y: 0.47350574","y: 0.47350574"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(134,184,117,1)","dash":"solid"},"hoveron":"points","name":"(#86B875,solid)","legendgroup":"(#86B875,solid)","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.05439722722438,1.05439722722438,null,1.05439722722438,0.659367031899142,null,0.659367031899142,0.659367031899142,null,0.659367031899142,0,null,0.659367031899142,0.659367031899142,null,0.659367031899142,0.366446818172613,null,0.366446818172613,0.366446818172613,null,0.366446818172613,0,null,0.366446818172613,0.366446818172613,null,0.366446818172613,0.257294381800551,null,0.257294381800551,0.257294381800551,null,0.257294381800551,0.202445065633869,null,0.202445065633869,0.202445065633869,null,0.202445065633869,0,null,0.202445065633869,0.202445065633869,null,0.202445065633869,0.128883042294223,null,0.128883042294223,0.128883042294223,null,0.128883042294223,0,null,0.128883042294223,0.128883042294223,null,0.128883042294223,0,null,0.257294381800551,0.257294381800551,null,0.257294381800551,0],"y":[37.859375,35.21875,null,35.21875,35.21875,null,35.21875,34,null,34,34,null,35.21875,36.4375,null,36.4375,36.4375,null,36.4375,35,null,35,35,null,36.4375,37.875,null,37.875,37.875,null,37.875,36.75,null,36.75,36.75,null,36.75,36,null,36,36,null,36.75,37.5,null,37.5,37.5,null,37.5,37,null,37,37,null,37.5,38,null,38,38,null,37.875,39,null,39,39],"text":["y: 1.05439723","y: 1.05439723",null,"y: 1.05439723","y: 1.05439723",null,"y: 0.65936703","y: 0.65936703",null,"y: 0.65936703","y: 0.65936703",null,"y: 0.65936703","y: 0.65936703",null,"y: 0.65936703","y: 0.65936703",null,"y: 0.36644682","y: 0.36644682",null,"y: 0.36644682","y: 0.36644682",null,"y: 0.36644682","y: 0.36644682",null,"y: 0.36644682","y: 0.36644682",null,"y: 0.25729438","y: 0.25729438",null,"y: 0.25729438","y: 0.25729438",null,"y: 0.20244507","y: 0.20244507",null,"y: 0.20244507","y: 0.20244507",null,"y: 0.20244507","y: 0.20244507",null,"y: 0.20244507","y: 0.20244507",null,"y: 0.12888304","y: 0.12888304",null,"y: 0.12888304","y: 0.12888304",null,"y: 0.12888304","y: 0.12888304",null,"y: 0.12888304","y: 0.12888304",null,"y: 0.25729438","y: 0.25729438",null,"y: 0.25729438","y: 0.25729438"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(199,167,108,1)","dash":"solid"},"hoveron":"points","name":"(#C7A76C,solid)","legendgroup":"(#C7A76C,solid)","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.59417446669873,1.59417446669873,null,1.59417446669873,0.614248456260233,null,0.614248456260233,0.614248456260233,null,0.614248456260233,0.275857868808986,null,0.275857868808986,0.275857868808986,null,0.275857868808986,0,null,0.275857868808986,0.275857868808986,null,0.275857868808986,0,null,0.614248456260233,0.614248456260233,null,0.614248456260233,0],"y":[49.9296875,54.25,null,54.25,54.25,null,54.25,53.5,null,53.5,53.5,null,53.5,53,null,53,53,null,53.5,54,null,54,54,null,54.25,55,null,55,55],"text":["y: 1.59417447","y: 1.59417447",null,"y: 1.59417447","y: 1.59417447",null,"y: 0.61424846","y: 0.61424846",null,"y: 0.61424846","y: 0.61424846",null,"y: 0.27585787","y: 0.27585787",null,"y: 0.27585787","y: 0.27585787",null,"y: 0.27585787","y: 0.27585787",null,"y: 0.27585787","y: 0.27585787",null,"y: 0.61424846","y: 0.61424846",null,"y: 0.61424846","y: 0.61424846"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(205,153,216,1)","dash":"solid"},"hoveron":"points","name":"(#CD99D8,solid)","legendgroup":"(#CD99D8,solid)","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.20466483415084,1.20466483415084,null,1.20466483415084,0.95788286362071,null,0.95788286362071,0.95788286362071,null,0.95788286362071,0.794745500284792,null,0.794745500284792,0.794745500284792,null,0.794745500284792,0.381625693962732,null,0.381625693962732,0.381625693962732,null,0.381625693962732,0,null,0.381625693962732,0.381625693962732,null,0.381625693962732,0,null,0.794745500284792,0.794745500284792,null,0.794745500284792,0.666404776934707,null,0.666404776934707,0.666404776934707,null,0.666404776934707,0.367061621439879,null,0.367061621439879,0.367061621439879,null,0.367061621439879,0,null,0.367061621439879,0.367061621439879,null,0.367061621439879,0.248285826616636,null,0.248285826616636,0.248285826616636,null,0.248285826616636,0.0875581071177939,null,0.0875581071177939,0.0875581071177939,null,0.0875581071177939,0,null,0.0875581071177939,0.0875581071177939,null,0.0875581071177939,0,null,0.248285826616636,0.248285826616636,null,0.248285826616636,0.237569649714429,null,0.237569649714429,0.237569649714429,null,0.237569649714429,0.129904663635189,null,0.129904663635189,0.129904663635189,null,0.129904663635189,0,null,0.129904663635189,0.129904663635189,null,0.129904663635189,0,null,0.237569649714429,0.237569649714429,null,0.237569649714429,0,null,0.666404776934707,0.666404776934707,null,0.666404776934707,0.534875118690448,null,0.534875118690448,0.534875118690448,null,0.534875118690448,0.438363599370831,null,0.438363599370831,0.438363599370831,null,0.438363599370831,0.20347407832471,null,0.20347407832471,0.20347407832471,null,0.20347407832471,0,null,0.20347407832471,0.20347407832471,null,0.20347407832471,0,null,0.438363599370831,0.438363599370831,null,0.438363599370831,0.332059186086582,null,0.332059186086582,0.332059186086582,null,0.332059186086582,0.274199290988404,null,0.274199290988404,0.274199290988404,null,0.274199290988404,0,null,0.274199290988404,0.274199290988404,null,0.274199290988404,0.143438256757787,null,0.143438256757787,0.143438256757787,null,0.143438256757787,0,null,0.143438256757787,0.143438256757787,null,0.143438256757787,0,null,0.332059186086582,0.332059186086582,null,0.332059186086582,0.20894513119211,null,0.20894513119211,0.20894513119211,null,0.20894513119211,0,null,0.20894513119211,0.20894513119211,null,0.20894513119211,0.154458411843452,null,0.154458411843452,0.154458411843452,null,0.154458411843452,0.0903999281103318,null,0.0903999281103318,0.0903999281103318,null,0.0903999281103318,0,null,0.0903999281103318,0.0903999281103318,null,0.0903999281103318,0,null,0.154458411843452,0.154458411843452,null,0.154458411843452,0,null,0.534875118690448,0.534875118690448,null,0.534875118690448,0.372123275507687,null,0.372123275507687,0.372123275507687,null,0.372123275507687,0.35032421362806,null,0.35032421362806,0.35032421362806,null,0.35032421362806,0.243402838861005,null,0.243402838861005,0.243402838861005,null,0.243402838861005,0.212443162483461,null,0.212443162483461,0.212443162483461,null,0.212443162483461,0.127081711167596,null,0.127081711167596,0.127081711167596,null,0.127081711167596,0,null,0.127081711167596,0.127081711167596,null,0.127081711167596,0,null,0.212443162483461,0.212443162483461,null,0.212443162483461,0,null,0.243402838861005,0.243402838861005,null,0.243402838861005,0,null,0.35032421362806,0.35032421362806,null,0.35032421362806,0,null,0.372123275507687,0.372123275507687,null,0.372123275507687,0.182577335771184,null,0.182577335771184,0.182577335771184,null,0.182577335771184,0,null,0.182577335771184,0.182577335771184,null,0.182577335771184,0.121298312556643,null,0.121298312556643,0.121298312556643,null,0.121298312556643,0,null,0.121298312556643,0.121298312556643,null,0.121298312556643,0.0949020854651998,null,0.0949020854651998,0.0949020854651998,null,0.0949020854651998,0,null,0.0949020854651998,0.0949020854651998,null,0.0949020854651998,0,null,0.95788286362071,0.95788286362071,null,0.95788286362071,0.407830626686954,null,0.407830626686954,0.407830626686954,null,0.407830626686954,0.218154484501404,null,0.218154484501404,0.218154484501404,null,0.218154484501404,0.0991867532043192,null,0.0991867532043192,0.0991867532043192,null,0.0991867532043192,0,null,0.0991867532043192,0.0991867532043192,null,0.0991867532043192,0,null,0.218154484501404,0.218154484501404,null,0.218154484501404,0,null,0.407830626686954,0.407830626686954,null,0.407830626686954,0.319599624724541,null,0.319599624724541,0.319599624724541,null,0.319599624724541,0.209182472124278,null,0.209182472124278,0.209182472124278,null,0.209182472124278,0,null,0.209182472124278,0.209182472124278,null,0.209182472124278,0,null,0.319599624724541,0.319599624724541,null,0.319599624724541,0.119504801735496,null,0.119504801735496,0.119504801735496,null,0.119504801735496,0,null,0.119504801735496,0.119504801735496,null,0.119504801735496,0],"y":[27.923828125,17.98828125,null,17.98828125,17.98828125,null,17.98828125,6.1015625,null,6.1015625,6.1015625,null,6.1015625,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,6.1015625,10.703125,null,10.703125,10.703125,null,10.703125,4.4375,null,4.4375,4.4375,null,4.4375,3,null,3,3,null,4.4375,5.875,null,5.875,5.875,null,5.875,4.5,null,4.5,4.5,null,4.5,4,null,4,4,null,4.5,5,null,5,5,null,5.875,7.25,null,7.25,7.25,null,7.25,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,7.25,8,null,8,8,null,10.703125,16.96875,null,16.96875,16.96875,null,16.96875,11.46875,null,11.46875,11.46875,null,11.46875,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10,null,11.46875,13.4375,null,13.4375,13.4375,null,13.4375,11.75,null,11.75,11.75,null,11.75,11,null,11,11,null,11.75,12.5,null,12.5,12.5,null,12.5,12,null,12,12,null,12.5,13,null,13,13,null,13.4375,15.125,null,15.125,15.125,null,15.125,14,null,14,14,null,15.125,16.25,null,16.25,16.25,null,16.25,15.5,null,15.5,15.5,null,15.5,15,null,15,15,null,15.5,16,null,16,16,null,16.25,17,null,17,17,null,16.96875,22.46875,null,22.46875,22.46875,null,22.46875,21.0625,null,21.0625,21.0625,null,21.0625,20.125,null,20.125,20.125,null,20.125,19.25,null,19.25,19.25,null,19.25,18.5,null,18.5,18.5,null,18.5,18,null,18,18,null,18.5,19,null,19,19,null,19.25,20,null,20,20,null,20.125,21,null,21,21,null,21.0625,22,null,22,22,null,22.46875,23.875,null,23.875,23.875,null,23.875,23,null,23,23,null,23.875,24.75,null,24.75,24.75,null,24.75,24,null,24,24,null,24.75,25.5,null,25.5,25.5,null,25.5,25,null,25,25,null,25.5,26,null,26,26,null,17.98828125,29.875,null,29.875,29.875,null,29.875,28.25,null,28.25,28.25,null,28.25,27.5,null,27.5,27.5,null,27.5,27,null,27,27,null,27.5,28,null,28,28,null,28.25,29,null,29,29,null,29.875,31.5,null,31.5,31.5,null,31.5,30.5,null,30.5,30.5,null,30.5,30,null,30,30,null,30.5,31,null,31,31,null,31.5,32.5,null,32.5,32.5,null,32.5,32,null,32,32,null,32.5,33,null,33,33],"text":["y: 1.20466483","y: 1.20466483",null,"y: 1.20466483","y: 1.20466483",null,"y: 0.95788286","y: 0.95788286",null,"y: 0.95788286","y: 0.95788286",null,"y: 0.79474550","y: 0.79474550",null,"y: 0.79474550","y: 0.79474550",null,"y: 0.38162569","y: 0.38162569",null,"y: 0.38162569","y: 0.38162569",null,"y: 0.38162569","y: 0.38162569",null,"y: 0.38162569","y: 0.38162569",null,"y: 0.79474550","y: 0.79474550",null,"y: 0.79474550","y: 0.79474550",null,"y: 0.66640478","y: 0.66640478",null,"y: 0.66640478","y: 0.66640478",null,"y: 0.36706162","y: 0.36706162",null,"y: 0.36706162","y: 0.36706162",null,"y: 0.36706162","y: 0.36706162",null,"y: 0.36706162","y: 0.36706162",null,"y: 0.24828583","y: 0.24828583",null,"y: 0.24828583","y: 0.24828583",null,"y: 0.08755811","y: 0.08755811",null,"y: 0.08755811","y: 0.08755811",null,"y: 0.08755811","y: 0.08755811",null,"y: 0.08755811","y: 0.08755811",null,"y: 0.24828583","y: 0.24828583",null,"y: 0.24828583","y: 0.24828583",null,"y: 0.23756965","y: 0.23756965",null,"y: 0.23756965","y: 0.23756965",null,"y: 0.12990466","y: 0.12990466",null,"y: 0.12990466","y: 0.12990466",null,"y: 0.12990466","y: 0.12990466",null,"y: 0.12990466","y: 0.12990466",null,"y: 0.23756965","y: 0.23756965",null,"y: 0.23756965","y: 0.23756965",null,"y: 0.66640478","y: 0.66640478",null,"y: 0.66640478","y: 0.66640478",null,"y: 0.53487512","y: 0.53487512",null,"y: 0.53487512","y: 0.53487512",null,"y: 0.43836360","y: 0.43836360",null,"y: 0.43836360","y: 0.43836360",null,"y: 0.20347408","y: 0.20347408",null,"y: 0.20347408","y: 0.20347408",null,"y: 0.20347408","y: 0.20347408",null,"y: 0.20347408","y: 0.20347408",null,"y: 0.43836360","y: 0.43836360",null,"y: 0.43836360","y: 0.43836360",null,"y: 0.33205919","y: 0.33205919",null,"y: 0.33205919","y: 0.33205919",null,"y: 0.27419929","y: 0.27419929",null,"y: 0.27419929","y: 0.27419929",null,"y: 0.27419929","y: 0.27419929",null,"y: 0.27419929","y: 0.27419929",null,"y: 0.14343826","y: 0.14343826",null,"y: 0.14343826","y: 0.14343826",null,"y: 0.14343826","y: 0.14343826",null,"y: 0.14343826","y: 0.14343826",null,"y: 0.33205919","y: 0.33205919",null,"y: 0.33205919","y: 0.33205919",null,"y: 0.20894513","y: 0.20894513",null,"y: 0.20894513","y: 0.20894513",null,"y: 0.20894513","y: 0.20894513",null,"y: 0.20894513","y: 0.20894513",null,"y: 0.15445841","y: 0.15445841",null,"y: 0.15445841","y: 0.15445841",null,"y: 0.09039993","y: 0.09039993",null,"y: 0.09039993","y: 0.09039993",null,"y: 0.09039993","y: 0.09039993",null,"y: 0.09039993","y: 0.09039993",null,"y: 0.15445841","y: 0.15445841",null,"y: 0.15445841","y: 0.15445841",null,"y: 0.53487512","y: 0.53487512",null,"y: 0.53487512","y: 0.53487512",null,"y: 0.37212328","y: 0.37212328",null,"y: 0.37212328","y: 0.37212328",null,"y: 0.35032421","y: 0.35032421",null,"y: 0.35032421","y: 0.35032421",null,"y: 0.24340284","y: 0.24340284",null,"y: 0.24340284","y: 0.24340284",null,"y: 0.21244316","y: 0.21244316",null,"y: 0.21244316","y: 0.21244316",null,"y: 0.12708171","y: 0.12708171",null,"y: 0.12708171","y: 0.12708171",null,"y: 0.12708171","y: 0.12708171",null,"y: 0.12708171","y: 0.12708171",null,"y: 0.21244316","y: 0.21244316",null,"y: 0.21244316","y: 0.21244316",null,"y: 0.24340284","y: 0.24340284",null,"y: 0.24340284","y: 0.24340284",null,"y: 0.35032421","y: 0.35032421",null,"y: 0.35032421","y: 0.35032421",null,"y: 0.37212328","y: 0.37212328",null,"y: 0.37212328","y: 0.37212328",null,"y: 0.18257734","y: 0.18257734",null,"y: 0.18257734","y: 0.18257734",null,"y: 0.18257734","y: 0.18257734",null,"y: 0.18257734","y: 0.18257734",null,"y: 0.12129831","y: 0.12129831",null,"y: 0.12129831","y: 0.12129831",null,"y: 0.12129831","y: 0.12129831",null,"y: 0.12129831","y: 0.12129831",null,"y: 0.09490209","y: 0.09490209",null,"y: 0.09490209","y: 0.09490209",null,"y: 0.09490209","y: 0.09490209",null,"y: 0.09490209","y: 0.09490209",null,"y: 0.95788286","y: 0.95788286",null,"y: 0.95788286","y: 0.95788286",null,"y: 0.40783063","y: 0.40783063",null,"y: 0.40783063","y: 0.40783063",null,"y: 0.21815448","y: 0.21815448",null,"y: 0.21815448","y: 0.21815448",null,"y: 0.09918675","y: 0.09918675",null,"y: 0.09918675","y: 0.09918675",null,"y: 0.09918675","y: 0.09918675",null,"y: 0.09918675","y: 0.09918675",null,"y: 0.21815448","y: 0.21815448",null,"y: 0.21815448","y: 0.21815448",null,"y: 0.40783063","y: 0.40783063",null,"y: 0.40783063","y: 0.40783063",null,"y: 0.31959962","y: 0.31959962",null,"y: 0.31959962","y: 0.31959962",null,"y: 0.20918247","y: 0.20918247",null,"y: 0.20918247","y: 0.20918247",null,"y: 0.20918247","y: 0.20918247",null,"y: 0.20918247","y: 0.20918247",null,"y: 0.31959962","y: 0.31959962",null,"y: 0.31959962","y: 0.31959962",null,"y: 0.11950480","y: 0.11950480",null,"y: 0.11950480","y: 0.11950480",null,"y: 0.11950480","y: 0.11950480",null,"y: 0.11950480","y: 0.11950480"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid)","legendgroup":"(#E495A5,solid)","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.82287715348419,1.82287715348419,null,1.82287715348419,1.20466483415084,null,1.20466483415084,1.20466483415084,null,1.20466483415084,1.05439722722438,null,1.82287715348419,1.82287715348419,null,1.82287715348419,1.59417446669873,null,1.59417446669873,1.59417446669873,null,1.59417446669873,1.09087788975901],"y":[38.9267578125,27.923828125,null,27.923828125,27.923828125,null,27.923828125,37.859375,null,37.859375,37.859375,null,38.9267578125,49.9296875,null,49.9296875,49.9296875,null,49.9296875,45.609375,null,45.609375,45.609375],"text":["y: 1.82287715","y: 1.82287715",null,"y: 1.82287715","y: 1.82287715",null,"y: 1.20466483","y: 1.20466483",null,"y: 1.20466483","y: 1.20466483",null,"y: 1.82287715","y: 1.82287715",null,"y: 1.82287715","y: 1.82287715",null,"y: 1.59417447","y: 1.59417447",null,"y: 1.59417447","y: 1.59417447"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","name":"(black,solid)","legendgroup":"(black,solid)","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.82287715348419,1.20466483415084,0.95788286362071,0.794745500284792,0.381625693962732,0,0,0.666404776934707,0.367061621439879,0,0.248285826616636,0.0875581071177939,0,0,0.237569649714429,0.129904663635189,0,0,0,0.534875118690448,0.438363599370831,0.20347407832471,0,0,0.332059186086582,0.274199290988404,0,0.143438256757787,0,0,0.20894513119211,0,0.154458411843452,0.0903999281103318,0,0,0,0.372123275507687,0.35032421362806,0.243402838861005,0.212443162483461,0.127081711167596,0,0,0,0,0,0.182577335771184,0,0.121298312556643,0,0.0949020854651998,0,0,0.407830626686954,0.218154484501404,0.0991867532043192,0,0,0,0.319599624724541,0.209182472124278,0,0,0.119504801735496,0,0,1.05439722722438,0.659367031899142,0,0.366446818172613,0,0.257294381800551,0.202445065633869,0,0.128883042294223,0,0,0,0.47350573521867,0,0,1.59417446669873,1.09087788975901,0.500949721963311,0,0,0.731800222126064,0.691159533269081,0.380627098188748,0.255264316891836,0,0.185675404080306,0,0,0,0,0.466807582689693,0.358417482296682,0,0,0.173019976310583,0,0,0.614248456260233,0.275857868808986,0,0,0],"y":[38.9267578125,27.923828125,17.98828125,6.1015625,1.5,1,2,10.703125,4.4375,3,5.875,4.5,4,5,7.25,6.5,6,7,8,16.96875,11.46875,9.5,9,10,13.4375,11.75,11,12.5,12,13,15.125,14,16.25,15.5,15,16,17,22.46875,21.0625,20.125,19.25,18.5,18,19,20,21,22,23.875,23,24.75,24,25.5,25,26,29.875,28.25,27.5,27,28,29,31.5,30.5,30,31,32.5,32,33,37.859375,35.21875,34,36.4375,35,37.875,36.75,36,37.5,37,38,39,40.5,40,41,49.9296875,45.609375,42.5,42,43,48.71875,46.9375,45.875,44.75,44,45.5,45,46,47,48,50.5,49.5,49,50,51.5,51,52,54.25,53.5,53,54,55],"text":["y: 1.82287715","y: 1.20466483","y: 0.95788286","y: 0.79474550","y: 0.38162569","y: 0.00000000","y: 0.00000000","y: 0.66640478","y: 0.36706162","y: 0.00000000","y: 0.24828583","y: 0.08755811","y: 0.00000000","y: 0.00000000","y: 0.23756965","y: 0.12990466","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.53487512","y: 0.43836360","y: 0.20347408","y: 0.00000000","y: 0.00000000","y: 0.33205919","y: 0.27419929","y: 0.00000000","y: 0.14343826","y: 0.00000000","y: 0.00000000","y: 0.20894513","y: 0.00000000","y: 0.15445841","y: 0.09039993","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.37212328","y: 0.35032421","y: 0.24340284","y: 0.21244316","y: 0.12708171","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.18257734","y: 0.00000000","y: 0.12129831","y: 0.00000000","y: 0.09490209","y: 0.00000000","y: 0.00000000","y: 0.40783063","y: 0.21815448","y: 0.09918675","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.31959962","y: 0.20918247","y: 0.00000000","y: 0.00000000","y: 0.11950480","y: 0.00000000","y: 0.00000000","y: 1.05439723","y: 0.65936703","y: 0.00000000","y: 0.36644682","y: 0.00000000","y: 0.25729438","y: 0.20244507","y: 0.00000000","y: 0.12888304","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.47350574","y: 0.00000000","y: 0.00000000","y: 1.59417447","y: 1.09087789","y: 0.50094972","y: 0.00000000","y: 0.00000000","y: 0.73180022","y: 0.69115953","y: 0.38062710","y: 0.25526432","y: 0.00000000","y: 0.18567540","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.46680758","y: 0.35841748","y: 0.00000000","y: 0.00000000","y: 0.17301998","y: 0.00000000","y: 0.00000000","y: 0.61424846","y: 0.27585787","y: 0.00000000","y: 0.00000000","y: 0.00000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"automargin":true,"type":"linear","autorange":false,"range":[0.5,5.5],"tickmode":"array","ticktext":["RADIO_PR","TV_PR","LLPHONE_PR","MPHONE_PR","COMPUTER_PR"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["RADIO_PR","TV_PR","LLPHONE_PR","MPHONE_PR","COMPUTER_PR"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":6.6417600664176},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"ICT Indicators","hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1.82287715348419],"tickmode":"array","ticktext":["0.0","0.5","1.0","1.5"],"tickvals":[0,0.5,1,1.5],"categoryorder":"array","categoryarray":["0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":null,"family":null,"size":0}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,55.5],"tickmode":"array","ticktext":["Narphan","Pangwaun","Mongpan","Nansang","Kyaukme","Kalaw","Hseni","Langkho","Kunhing","Laihka","Monghsat","Loilen","Mongnai","Mongton","Hsipaw","Hopong","Monghsu","Pinlaung","Mongmit","Pekon","Kutkai","Namtu","Hsihseng","Kyethi","Tangyan","Namhsan","Mongyai","Mongping","Mongkhet","Mawkmai","Mongkaing","Manton","Matman","Ywangan","Pindaya","Lawksawk","Nyaungshwe","Nawnghkio","Monghpyak","Mabein","Mongyawng","Kunlong","Konkyan","Mongyang","Mongmao","Hopang","Namhkan","Laukkaing","Mongla","Pangsang","Kengtung","Lashio","Taunggyi","Tachileik","Muse"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55],"categoryorder":"array","categoryarray":["Narphan","Pangwaun","Mongpan","Nansang","Kyaukme","Kalaw","Hseni","Langkho","Kunhing","Laihka","Monghsat","Loilen","Mongnai","Mongton","Hsipaw","Hopong","Monghsu","Pinlaung","Mongmit","Pekon","Kutkai","Namtu","Hsihseng","Kyethi","Tangyan","Namhsan","Mongyai","Mongping","Mongkhet","Mawkmai","Mongkaing","Manton","Matman","Ywangan","Pindaya","Lawksawk","Nyaungshwe","Nawnghkio","Monghpyak","Mabein","Mongyawng","Kunlong","Konkyan","Mongyang","Mongmao","Hopang","Namhkan","Laukkaing","Mongla","Pangsang","Kengtung","Lashio","Taunggyi","Tachileik","Muse"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":5.31340805313408},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Townships of Shan State","hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":1}],"images":[],"margin":{"t":60,"r":null,"b":35.0684931506849,"l":200},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"y":1,"yanchor":"top"},"hovermode":"closest","barmode":"relative","title":"Geographic Segmentation of Shan State by ICT indicators"},"attrs":{"5b5429487333":{"x":{},"y":{},"fill":{},"text":{},"type":"heatmap"},"5b5472a45ad9":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"scatter"},"5b5477db6ae9":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>By hovering over the blocks, we can see the values of the variables to have a more specific and quantifiable idea of the cluster definitions.</p>
</section>
</section>
<section id="mapping-the-clusters" class="level2">
<h2 class="anchored" data-anchor-id="mapping-the-clusters">Mapping the Clusters</h2>
<p>With closed examination of the dendragram above, we have decided to retain six clusters.</p>
<p>The function <code>cutree()</code> will be used in the code chunk below to derive a 6-cluster model. It takes the resulting tree from <code>hclust()</code> and splits it to several groups by specifying the desired number of groups (<code>'k'</code> argument) or the cut heights.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(hclust_ward, <span class="at">k=</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In order to visualize the clusters, the ‘<em>groups’</em> object needs to be appended onto the’<em>shan_sf’</em> simple feature object.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>shan_sf_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below uses <code>qtm()</code> to plot the chloropleth map colored based on cluster groupings.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_cluster, <span class="st">"CLUSTER"</span>, <span class="at">fill.palette =</span> <span class="st">"Pastel1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>The choropleth map above reveals the clusters are very fragmented. The is one of the major limitation when non-spatial clustering algorithm such as hierarchical cluster analysis method is used.</p>
</section>
</section>
<section id="spatially-constrained-clustering-skater-approach" class="level1">
<h1>Spatially Constrained Clustering: SKATER Approach</h1>
<p>SKATER stands for “<strong>S</strong>patial <strong>K</strong>luster <strong>A</strong>nalysis by <strong>T</strong>ree <strong>E</strong>dge <strong>R</strong>emoval” and it is a regionalization method for clustering based on the location by spatial autocorrelation and spatial patterns. It constructs the minimum spanning tree from the adjacency matrix and cuts the tree to achieve maximum internal homogeneity.</p>
<section id="converting-to-spatialpolygonsdataframe" class="level2">
<h2 class="anchored" data-anchor-id="converting-to-spatialpolygonsdataframe">Converting to SpatialPolygonsDataFrame</h2>
<p>The <code>skater()</code> function only supports sp objects like SpatialPolygonDataFrame. This is because the <code>sf</code> package was created later than the when the <code>skater()</code> function was made, so there is no support yet for simple features objects.</p>
<p>The code chunk uses <code>as_Spatial()</code> function converts ‘<em>shan_sf</em>’ to a SpatialPolygonDataFrame called ’<em>shan_sp’.</em></p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>shan_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(shan_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="computing-neighbor-list" class="level2">
<h2 class="anchored" data-anchor-id="computing-neighbor-list">Computing Neighbor List</h2>
<p>Since we’ve established that the SKATER method takes into account spatial patterns, we need to figure out the different neighbors of each feature.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>shan.nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(shan_sp)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan.nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 55 
Number of nonzero links: 264 
Percentage nonzero weights: 8.727273 
Average number of links: 4.8 
Link number distribution:

 2  3  4  5  6  7  8  9 
 5  9  7 21  4  3  5  1 
5 least connected regions:
3 5 7 9 47 with 2 links
1 most connected region:
8 with 9 links</code></pre>
</div>
</div>
<p>The code chunk below produces a plot that shows the links made between the neighboring townships.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="fu">grey</span>(.<span class="dv">5</span>))</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan.nb, </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"#cb6a82"</span>, </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="computing-minimum-spanning-tree" class="level2">
<h2 class="anchored" data-anchor-id="computing-minimum-spanning-tree">Computing Minimum Spanning Tree</h2>
<section id="calculating-edge-costs" class="level3">
<h3 class="anchored" data-anchor-id="calculating-edge-costs">Calculating edge costs</h3>
<p>The code chunk below uses <code>nbcosts()</code> to compute the cost of each edge given the neighbors list and clustering variables.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>lcosts <span class="ot">&lt;-</span> <span class="fu">nbcosts</span>(shan.nb, shan_ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For each observation, this gives the pairwise dissimilarity between its values on the five variables and the values for the neighbouring observation (from the neighbor list). Basically, this is the notion of a generalised weight for a spatial weights matrix.</p>
<p>Next, We will incorporate these costs into a weights object in the same way as we did in the calculation of inverse of distance weights. In other words, we will convert the neighbor list to a list weights object by specifying the just computed <code>'lcosts'</code> as the weights.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>shan.w <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(shan.nb, </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                   lcosts, </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"B"</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan.w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 55 
Number of nonzero links: 264 
Percentage nonzero weights: 8.727273 
Average number of links: 4.8 
Link number distribution:

 2  3  4  5  6  7  8  9 
 5  9  7 21  4  3  5  1 
5 least connected regions:
3 5 7 9 47 with 2 links
1 most connected region:
8 with 9 links

Weights style: B 
Weights constants summary:
   n   nn       S0       S1        S2
B 55 3025 76267.65 58260785 522016004</code></pre>
</div>
</div>
</section>
<section id="computing-minimum-spanning-tree-1" class="level3">
<h3 class="anchored" data-anchor-id="computing-minimum-spanning-tree-1">Computing minimum spanning tree</h3>
<p>The code chunk below uses the function <code>mstree()</code> to compute for the minimum spanning tree.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>shan.mst <span class="ot">&lt;-</span> <span class="fu">mstree</span>(shan.w)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(shan.mst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "mst"    "matrix"</code></pre>
</div>
</div>
<p>The <code>class()</code> function tells us the class of the object. This tells us ‘shan.mst’ is an mst object that inherits from a matrix object.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(shan.mst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54  3</code></pre>
</div>
</div>
<p>The dimension is 54 and not 55 (which is the number of townships) because the minimum spanning tree consists of n-1 edges (links) in order to traverse all nods.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shan.mst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]      [,3]
[1,]   31   25 229.44658
[2,]   25   10 163.95741
[3,]   10    1 144.02475
[4,]   10    9 157.04230
[5,]    9    8  90.82891
[6,]    8    6 140.01101</code></pre>
</div>
</div>
<p>The plot method for the MST include a way to show the observation numbers of the nodes in addition to the edge. As before, we plot this together with the township boundaries. We can see how the initial neighbour list is simplified to just one edge connecting each of the nodes, while passing through all the nodes.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.mst</span>(shan.mst, </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"#cb6a82"</span>, </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.lab=</span><span class="fl">0.7</span>, </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.circles=</span><span class="fl">0.005</span>, </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
</section>
<section id="computing-spatial-constrained-clusters-using-the-skater-method" class="level2">
<h2 class="anchored" data-anchor-id="computing-spatial-constrained-clusters-using-the-skater-method">Computing Spatial Constrained Clusters using the SKATER Method</h2>
<p>The code chunk below computes spatially constrained clusters using <code>skater()</code> function.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>clust6 <span class="ot">&lt;-</span> <span class="fu">skater</span>(<span class="at">edges =</span> shan.mst[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> shan_ict, </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"euclidean"</span>, </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncuts =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>skater()</code> takes three mandatory arguments: - the first two columns of the MST matrix (i.e.&nbsp;not the cost), - the data matrix (to update the costs as units are being grouped), and - the number of cuts <strong>(which is one less than the number of clusters</strong>).</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(clust6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>List of 8
 $ groups      : num [1:55] 3 3 6 3 3 3 3 3 3 3 ...
 $ edges.groups:List of 6
  ..$ :List of 3
  .. ..$ node: num [1:22] 13 48 54 55 45 37 34 16 25 31 ...
  .. ..$ edge: num [1:21, 1:3] 48 55 54 37 34 16 45 31 13 13 ...
  .. ..$ ssw : num 3423
  ..$ :List of 3
  .. ..$ node: num [1:18] 47 27 53 38 42 15 41 51 43 32 ...
  .. ..$ edge: num [1:17, 1:3] 53 15 42 38 41 51 15 27 15 43 ...
  .. ..$ ssw : num 3759
  ..$ :List of 3
  .. ..$ node: num [1:11] 2 6 8 1 36 4 10 9 46 5 ...
  .. ..$ edge: num [1:10, 1:3] 6 1 8 36 4 6 8 10 10 9 ...
  .. ..$ ssw : num 1458
  ..$ :List of 3
  .. ..$ node: num [1:2] 44 20
  .. ..$ edge: num [1, 1:3] 44 20 95
  .. ..$ ssw : num 95
  ..$ :List of 3
  .. ..$ node: num 23
  .. ..$ edge: num[0 , 1:3] 
  .. ..$ ssw : num 0
  ..$ :List of 3
  .. ..$ node: num 3
  .. ..$ edge: num[0 , 1:3] 
  .. ..$ ssw : num 0
 $ not.prune   : NULL
 $ candidates  : int [1:6] 1 2 3 4 5 6
 $ ssto        : num 12613
 $ ssw         : num [1:6] 12613 10977 9962 9540 9123 ...
 $ crit        : num [1:2] 1 Inf
 $ vec.crit    : num [1:55] 1 1 1 1 1 1 1 1 1 1 ...
 - attr(*, "class")= chr "skater"</code></pre>
</div>
</div>
<p>We can check the cluster assignment by using the code chunk below.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>ccs6 <span class="ot">&lt;-</span> clust6<span class="sc">$</span>groups</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>ccs6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 3 3 6 3 3 3 3 3 3 3 2 1 1 1 2 1 1 1 2 4 1 2 5 1 1 1 2 1 2 2 1 2 2 1 1 3 1 2
[39] 2 2 2 2 2 4 1 3 2 1 1 1 2 1 2 1 1</code></pre>
</div>
</div>
<p>We can find out how many observations are in each cluster by means of the <code>table()</code> command.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ccs6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ccs6
 1  2  3  4  5  6 
22 18 11  2  1  1 </code></pre>
</div>
</div>
<p>Lastly, we can also plot the pruned tree that shows the five clusters on top of the township area.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clust6, </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab=</span>.<span class="dv">7</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">groups.colors=</span><span class="fu">c</span>(<span class="st">"#e3879e"</span>,<span class="st">"#af7cb6"</span>,<span class="st">"#a7c7e7"</span>, <span class="st">"#C1E1C1"</span>, <span class="st">"red"</span>),</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.circles=</span><span class="fl">0.005</span>, </span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="visualizing-spatially-constrained-clusters" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-spatially-constrained-clusters">Visualizing Spatially Constrained Clusters</h2>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>groups_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(clust6<span class="sc">$</span>groups)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>shan_sf_spatialcluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf_cluster, <span class="fu">as.factor</span>(groups_mat)) <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">SP_CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.factor.groups_mat.</span><span class="st">`</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_spatialcluster, <span class="st">"SP_CLUSTER"</span>, <span class="at">fill.palette =</span> <span class="st">"Pastel1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>For easy comparison, it will be better to place both the hierarchical clustering and spatially constrained hierarchical clustering maps next to each other.</p>
<div class="cell">
<details open="">
<summary>Press to toggle code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>hclust.map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(shan_sf_cluster,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"CLUSTER"</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill.palette =</span> <span class="st">"Pastel1"</span>) <span class="sc">+</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>shclust.map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(shan_sf_spatialcluster,</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SP_CLUSTER"</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill.palette =</span> <span class="st">"Pastel1"</span>) <span class="sc">+</span> </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(hclust.map, </span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>             shclust.map,</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, </span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex3_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>The ‘SP_CLUSTER’ chloropleth map is a lot more pleasing to the eyes, no?</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb78" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Hands-on Exercise 3: Geographical Segmentation with Spatially Constrained Clustering Techniques"</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>This is a hands-on exercise based on <span class="co">[</span><span class="ot">Chapter 5</span><span class="co">](https://r4gdsa.netlify.app/chap05.html "R4GDSA: Geographical Segmentation with Spatially Constrained Clustering Techniques")</span> of <span class="co">[</span><span class="ot">R for Geospatial Data Science and Analytics</span><span class="co">](https://r4gdsa.netlify.app/)</span> by Dr. Kam Tin Seong and is a requirement under the class ISS624: Geospatial Analytics and Applications.</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objectives</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>The objective of this hands-on exercise is to learn how to delineate homogeneous regions using geographically referenced multivariate data. There are two major analysis, namely: hierarchical cluster analysis and spatially constrained cluster analysis.</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>This hands-on exercise has the following learning outcomes:</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>to convert GIS polygon data into R's simple feature data.frame by using appropriate functions of **`sf`** package of R;</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>to convert simple feature data.frame into R's SpatialPolygonDataFrame object by using appropriate **sf** of package of R;</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>to perform cluster analysis by using <span class="in">`hclust()`</span> of Base R;</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>to perform spatially constrained cluster analysis using <span class="in">`skater()`</span> of Base R; and</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>to visualize the analysis output by using **`ggplot2`** and **`tmap`** package.</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Analytical Question</span></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>In geobusiness and spatial policy, it is a common practice to delineate the market or planning area into homogeneous regions by using multivariate data. In this hands-on exercise, we are interested to delineate <span class="co">[</span><span class="ot">Shan State</span><span class="co">](https://en.wikipedia.org/wiki/Shan_State)</span>, <span class="co">[</span><span class="ot">Myanmar</span><span class="co">](https://en.wikipedia.org/wiki/Myanmar)</span> into homogeneous regions by using multiple Information and Communication Technology (ICT) measures, namely: Radio, Television, Landline phone, Mobile phone, Computer, and Internet at home.</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Datasets</span></span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Myanmar Township Boundary Data (i.e.&nbsp;*myanmar_township_boundaries*) : This is a GIS data in ESRI shapefile format. It consists of township boundary information of Myanmar. The spatial data are captured in polygon features. Under GIS Resources <span class="sc">\&gt;</span> MIMU Geospatial Data.</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Shan-ICT.csv*: This is an extract of [**The 2014 Myanmar Population and Housing Census Myanmar**](https://myanmar.unfpa.org/en/publications/2014-population-and-housing-census-myanmar-data-sheet) at the township level.</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>Both data sets are download from <span class="co">[</span><span class="ot">Myanmar Information Management Unit (MIMU)</span><span class="co">](http://themimu.info/)</span>.</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a><span class="fu"># Getting Started</span></span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Required R Packages</span></span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>The code chunk below installs and loads the different required packages for this exercise using <span class="in">`p_load()`</span>:</span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(rgdal, spdep, tmap, sf, ggpubr, cluster, factoextra, NbClust, heatmaply, corrplot, psych, tidyverse)</span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon="false"}</span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## 🎮 LEVEL UP!</span></span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-56"><a href="#cb78-56" aria-hidden="true" tabindex="-1"></a>**NEW LIBRARIES UNLOCKED**!</span>
<span id="cb78-57"><a href="#cb78-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-58"><a href="#cb78-58" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**`rgdal`**</span><span class="co">](https://cran.r-project.org/web/packages/rgdal/index.html)</span> - the GDAL in 'rgdal' stands for 'Geospatial Data Abstraction Library' which is a translator library for raster and vector geospatial data format; it also has projection/transformation operations from the 'PROJ' library</span>
<span id="cb78-59"><a href="#cb78-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-60"><a href="#cb78-60" aria-hidden="true" tabindex="-1"></a><span class="at">    &gt; **This library will be retired by the end of 2023!**</span></span>
<span id="cb78-61"><a href="#cb78-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-62"><a href="#cb78-62" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**`corrplot`**</span><span class="co">](https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html)</span>  - used for visualization of the correlation matrix</span>
<span id="cb78-63"><a href="#cb78-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-64"><a href="#cb78-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**`ggpubr`**</span><span class="co">](https://cran.r-project.org/web/packages/ggpubr/index.html)</span>  - provides easy-to-use functions for creating publication ready plots built on <span class="in">`ggplot2`</span></span>
<span id="cb78-65"><a href="#cb78-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-66"><a href="#cb78-66" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**`heatmaply`**</span><span class="co">](https://cran.r-project.org/web/packages/heatmaply/vignettes/heatmaply.html)</span>  - used to make interactive heatmaps that allow the inspection of specific value by hovering the mouse over a cell</span>
<span id="cb78-67"><a href="#cb78-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-68"><a href="#cb78-68" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**`cluster`**</span><span class="co">](https://cran.r-project.org/web/packages/cluster/index.html)</span>  - contains functions for cluster analysis</span>
<span id="cb78-69"><a href="#cb78-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-70"><a href="#cb78-70" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**`NbClust`**</span><span class="co">](https://www.rdocumentation.org/packages/NbClust/versions/3.0.1/topics/NbClust)</span>  - used to figure out the best clustering scheme from the different results obtained by varying all combinations of number of clusters, distance measures, and clustering methods</span>
<span id="cb78-71"><a href="#cb78-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-72"><a href="#cb78-72" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**`factoextra`**</span><span class="co">](https://cran.r-project.org/web/packages/factoextra/index.html)</span>  - easy-to-use functions to extract and visualize the output of multivariate data analyses</span>
<span id="cb78-73"><a href="#cb78-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-74"><a href="#cb78-74" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">**`psych`**</span><span class="co">](https://cran.r-project.org/web/packages/psych/index.html)</span>  - general purpose toolbox for personality, psychometric theory and experimental psychology which provides multivariate analysis and scale construction using factor analysis, principal component analysis, cluster analysis and reliability analysis (although others provide basic descriptive statistics)</span>
<span id="cb78-75"><a href="#cb78-75" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb78-76"><a href="#cb78-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-77"><a href="#cb78-77" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importing the Data</span></span>
<span id="cb78-78"><a href="#cb78-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-79"><a href="#cb78-79" aria-hidden="true" tabindex="-1"></a><span class="fu">### Importing geospatial data into the R environment</span></span>
<span id="cb78-80"><a href="#cb78-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-81"><a href="#cb78-81" aria-hidden="true" tabindex="-1"></a>The code chunk below uses <span class="in">`st_read()`</span> to import the shapefile containing the administrative boundaries of Myanmar.</span>
<span id="cb78-82"><a href="#cb78-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-85"><a href="#cb78-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-86"><a href="#cb78-86" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, <span class="at">layer =</span> <span class="st">"myanmar_township_boundaries"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ST <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Shan (East)"</span>, <span class="st">"Shan (North)"</span>, <span class="st">"Shan (South)"</span>))</span>
<span id="cb78-87"><a href="#cb78-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-88"><a href="#cb78-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-89"><a href="#cb78-89" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb78-90"><a href="#cb78-90" aria-hidden="true" tabindex="-1"></a><span class="fu">## 💻 CODE REVIEW!</span></span>
<span id="cb78-91"><a href="#cb78-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-92"><a href="#cb78-92" aria-hidden="true" tabindex="-1"></a>**WHAT DOES THE OPERATOR `%in%` DO?**</span>
<span id="cb78-93"><a href="#cb78-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-94"><a href="#cb78-94" aria-hidden="true" tabindex="-1"></a>So in the context of the code chunk above, the records are filtered to only extract those with <span class="in">`'ST'`</span> equals to either "Shan (East)", "Shan (North)", "Shan (South)".</span>
<span id="cb78-95"><a href="#cb78-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-96"><a href="#cb78-96" aria-hidden="true" tabindex="-1"></a>In the context of our data, <span class="in">`'ST'`</span> refers to the state, region or union territory, which are the first level administrative boundaries of Myanmar. We are focusing on the "Shan" state of Myanmar.</span>
<span id="cb78-97"><a href="#cb78-97" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb78-98"><a href="#cb78-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-101"><a href="#cb78-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-102"><a href="#cb78-102" aria-hidden="true" tabindex="-1"></a>shan_sf</span>
<span id="cb78-103"><a href="#cb78-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-104"><a href="#cb78-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-107"><a href="#cb78-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-108"><a href="#cb78-108" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(shan_sf<span class="sc">$</span>TS)</span>
<span id="cb78-109"><a href="#cb78-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-110"><a href="#cb78-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-111"><a href="#cb78-111" aria-hidden="true" tabindex="-1"></a>As shown above we have 55 features, and each feature represents a township in Myanmar since the <span class="in">`'TS'`</span> variable is unique for all records. The terms "feature", "polygon", and "township" will be used interchangeably in this exercise.</span>
<span id="cb78-112"><a href="#cb78-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-113"><a href="#cb78-113" aria-hidden="true" tabindex="-1"></a><span class="fu">### Importing aspatial data into the R environment</span></span>
<span id="cb78-114"><a href="#cb78-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-115"><a href="#cb78-115" aria-hidden="true" tabindex="-1"></a>The code chunk below uses <span class="in">`read_csv`</span> to import</span>
<span id="cb78-116"><a href="#cb78-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-119"><a href="#cb78-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-120"><a href="#cb78-120" aria-hidden="true" tabindex="-1"></a>ict <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/Shan-ICT.csv"</span>)</span>
<span id="cb78-121"><a href="#cb78-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-122"><a href="#cb78-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-125"><a href="#cb78-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-126"><a href="#cb78-126" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ict)</span>
<span id="cb78-127"><a href="#cb78-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-128"><a href="#cb78-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-129"><a href="#cb78-129" aria-hidden="true" tabindex="-1"></a>The summary above confirms that there are 55 townships.</span>
<span id="cb78-130"><a href="#cb78-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-131"><a href="#cb78-131" aria-hidden="true" tabindex="-1"></a><span class="fu">### Deriving new variables using **`dplyr`** package</span></span>
<span id="cb78-132"><a href="#cb78-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-133"><a href="#cb78-133" aria-hidden="true" tabindex="-1"></a>The unit of measurement of the variables is number of households. Using these values is not fairs because the townships with relatively higher total number of households will also have higher number of households owning a radio, TV, etc.</span>
<span id="cb78-134"><a href="#cb78-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-135"><a href="#cb78-135" aria-hidden="true" tabindex="-1"></a>In order to overcome this problem, we will derive the penetration rate of each ICT variable by using the code chunk below.</span>
<span id="cb78-136"><a href="#cb78-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-139"><a href="#cb78-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-140"><a href="#cb78-140" aria-hidden="true" tabindex="-1"></a>ict_derived <span class="ot">&lt;-</span> ict <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Radio</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-141"><a href="#cb78-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">TV_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Television</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-142"><a href="#cb78-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">LLPHONE_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-143"><a href="#cb78-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">MPHONE_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-144"><a href="#cb78-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">COMPUTER_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Computer</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-145"><a href="#cb78-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">INTERNET_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>)</span>
<span id="cb78-146"><a href="#cb78-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-147"><a href="#cb78-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-150"><a href="#cb78-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-151"><a href="#cb78-151" aria-hidden="true" tabindex="-1"></a>ict_derived <span class="ot">&lt;-</span> ict_derived  <span class="sc">%&gt;%</span>  </span>
<span id="cb78-152"><a href="#cb78-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">DT_PCODE</span><span class="st">`</span> <span class="ot">=</span><span class="st">`</span><span class="at">District Pcode</span><span class="st">`</span>,</span>
<span id="cb78-153"><a href="#cb78-153" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">DT</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">District Name</span><span class="st">`</span>,</span>
<span id="cb78-154"><a href="#cb78-154" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TS_PCODE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Township Pcode</span><span class="st">`</span>, </span>
<span id="cb78-155"><a href="#cb78-155" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TS</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Township Name</span><span class="st">`</span>,</span>
<span id="cb78-156"><a href="#cb78-156" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TT_HOUSEHOLDS</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span>, </span>
<span id="cb78-157"><a href="#cb78-157" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">RADIO</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Radio</span><span class="st">`</span>, </span>
<span id="cb78-158"><a href="#cb78-158" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TV</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Television</span><span class="st">`</span>, </span>
<span id="cb78-159"><a href="#cb78-159" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">LLPHONE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span>, </span>
<span id="cb78-160"><a href="#cb78-160" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">MPHONE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span>,</span>
<span id="cb78-161"><a href="#cb78-161" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">COMPUTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Computer</span><span class="st">`</span>, </span>
<span id="cb78-162"><a href="#cb78-162" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">INTERNET</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span>) </span>
<span id="cb78-163"><a href="#cb78-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-164"><a href="#cb78-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-167"><a href="#cb78-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-168"><a href="#cb78-168" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ict_derived)</span>
<span id="cb78-169"><a href="#cb78-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-170"><a href="#cb78-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-171"><a href="#cb78-171" aria-hidden="true" tabindex="-1"></a>The new variables we created two code chunks ago (<span class="in">`'RADIO_PR'`</span>, <span class="in">`'TV_PR'`</span>, <span class="in">`'LLPHONE_PR'`</span>, <span class="in">`'MPHONE_PR'`</span>, <span class="in">`'COMPUTER_PR'`</span>, and <span class="in">`'INTERNET_PR'`</span>) are now in our new dataframe 'ict_derived'.</span>
<span id="cb78-172"><a href="#cb78-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-173"><a href="#cb78-173" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exploratory Data Analysis</span></span>
<span id="cb78-174"><a href="#cb78-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-175"><a href="#cb78-175" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using Histogram for Distribution</span></span>
<span id="cb78-176"><a href="#cb78-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-177"><a href="#cb78-177" aria-hidden="true" tabindex="-1"></a><span class="fu">### Original `'RADIO'` Distribution</span></span>
<span id="cb78-178"><a href="#cb78-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-181"><a href="#cb78-181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-182"><a href="#cb78-182" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-183"><a href="#cb78-183" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-184"><a href="#cb78-184" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb78-185"><a href="#cb78-185" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-186"><a href="#cb78-186" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">"#704276"</span>, </span>
<span id="cb78-187"><a href="#cb78-187" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-188"><a href="#cb78-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-189"><a href="#cb78-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-192"><a href="#cb78-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-193"><a href="#cb78-193" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-194"><a href="#cb78-194" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-195"><a href="#cb78-195" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb78-196"><a href="#cb78-196" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"#704276"</span>, </span>
<span id="cb78-197"><a href="#cb78-197" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-198"><a href="#cb78-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-199"><a href="#cb78-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-200"><a href="#cb78-200" aria-hidden="true" tabindex="-1"></a>::: {.callout-important icon="false"}</span>
<span id="cb78-201"><a href="#cb78-201" aria-hidden="true" tabindex="-1"></a><span class="fu">## 🌸 FIRST IMPRESSIONS!</span></span>
<span id="cb78-202"><a href="#cb78-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-203"><a href="#cb78-203" aria-hidden="true" tabindex="-1"></a>Based on the histogram above, it seems that most townships have around 10,000 households with radios, but there are a few townships that have around 30,000 households with radios. The data on households with radios looks skewed to the right.\</span>
<span id="cb78-204"><a href="#cb78-204" aria-hidden="true" tabindex="-1"></a>The succeeding bloxplot shows that there are 2 townships that are minor outliers and 1 township is a major outlier affecting the observed skewness from the histogram.</span>
<span id="cb78-205"><a href="#cb78-205" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb78-206"><a href="#cb78-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-207"><a href="#cb78-207" aria-hidden="true" tabindex="-1"></a><span class="fu">### Derived `'RADIO_PR'` Distribution</span></span>
<span id="cb78-208"><a href="#cb78-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-211"><a href="#cb78-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-212"><a href="#cb78-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-213"><a href="#cb78-213" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-214"><a href="#cb78-214" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-215"><a href="#cb78-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-216"><a href="#cb78-216" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-217"><a href="#cb78-217" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-218"><a href="#cb78-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-219"><a href="#cb78-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-222"><a href="#cb78-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-223"><a href="#cb78-223" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-224"><a href="#cb78-224" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-225"><a href="#cb78-225" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb78-226"><a href="#cb78-226" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-227"><a href="#cb78-227" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-228"><a href="#cb78-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-229"><a href="#cb78-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-230"><a href="#cb78-230" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb78-231"><a href="#cb78-231" aria-hidden="true" tabindex="-1"></a><span class="fu">## 🌸 NEW OBSERVATION!</span></span>
<span id="cb78-232"><a href="#cb78-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-233"><a href="#cb78-233" aria-hidden="true" tabindex="-1"></a>The new histogram using <span class="in">`'RADIO_PR'`</span> which was derived is visually more well-distributed than the original one using <span class="in">`'RADIO'`</span>. It looks closer to a normal distribution.</span>
<span id="cb78-234"><a href="#cb78-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-235"><a href="#cb78-235" aria-hidden="true" tabindex="-1"></a>The new boxplot using <span class="in">`'RADIO_PR'`</span> now only has one outlier compared to the three points earlier. The median is now closer to the center as well.</span>
<span id="cb78-236"><a href="#cb78-236" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb78-237"><a href="#cb78-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-240"><a href="#cb78-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-241"><a href="#cb78-241" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-242"><a href="#cb78-242" aria-hidden="true" tabindex="-1"></a>radio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-243"><a href="#cb78-243" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-244"><a href="#cb78-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-245"><a href="#cb78-245" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-246"><a href="#cb78-246" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-247"><a href="#cb78-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-248"><a href="#cb78-248" aria-hidden="true" tabindex="-1"></a>tv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-249"><a href="#cb78-249" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">TV</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-250"><a href="#cb78-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-251"><a href="#cb78-251" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-252"><a href="#cb78-252" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-253"><a href="#cb78-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-254"><a href="#cb78-254" aria-hidden="true" tabindex="-1"></a>llphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-255"><a href="#cb78-255" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">LLPHONE</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-256"><a href="#cb78-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-257"><a href="#cb78-257" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-258"><a href="#cb78-258" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-259"><a href="#cb78-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-260"><a href="#cb78-260" aria-hidden="true" tabindex="-1"></a>mphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-261"><a href="#cb78-261" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">MPHONE</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-262"><a href="#cb78-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-263"><a href="#cb78-263" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-264"><a href="#cb78-264" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-265"><a href="#cb78-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-266"><a href="#cb78-266" aria-hidden="true" tabindex="-1"></a>computer <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-267"><a href="#cb78-267" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">COMPUTER</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-268"><a href="#cb78-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-269"><a href="#cb78-269" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-270"><a href="#cb78-270" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-271"><a href="#cb78-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-272"><a href="#cb78-272" aria-hidden="true" tabindex="-1"></a>internet <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-273"><a href="#cb78-273" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">INTERNET</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-274"><a href="#cb78-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-275"><a href="#cb78-275" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-276"><a href="#cb78-276" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-277"><a href="#cb78-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-278"><a href="#cb78-278" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(radio, tv, llphone, mphone, computer, internet, </span>
<span id="cb78-279"><a href="#cb78-279" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb78-280"><a href="#cb78-280" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb78-281"><a href="#cb78-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-282"><a href="#cb78-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-285"><a href="#cb78-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-286"><a href="#cb78-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-287"><a href="#cb78-287" aria-hidden="true" tabindex="-1"></a>radio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-288"><a href="#cb78-288" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-289"><a href="#cb78-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-290"><a href="#cb78-290" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-291"><a href="#cb78-291" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-292"><a href="#cb78-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-293"><a href="#cb78-293" aria-hidden="true" tabindex="-1"></a>tv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-294"><a href="#cb78-294" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">TV_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-295"><a href="#cb78-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-296"><a href="#cb78-296" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-297"><a href="#cb78-297" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-298"><a href="#cb78-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-299"><a href="#cb78-299" aria-hidden="true" tabindex="-1"></a>llphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-300"><a href="#cb78-300" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">LLPHONE_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-301"><a href="#cb78-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-302"><a href="#cb78-302" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-303"><a href="#cb78-303" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-304"><a href="#cb78-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-305"><a href="#cb78-305" aria-hidden="true" tabindex="-1"></a>mphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-306"><a href="#cb78-306" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">MPHONE_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-307"><a href="#cb78-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-308"><a href="#cb78-308" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-309"><a href="#cb78-309" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-310"><a href="#cb78-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-311"><a href="#cb78-311" aria-hidden="true" tabindex="-1"></a>computer <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-312"><a href="#cb78-312" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">COMPUTER_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-313"><a href="#cb78-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-314"><a href="#cb78-314" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-315"><a href="#cb78-315" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-316"><a href="#cb78-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-317"><a href="#cb78-317" aria-hidden="true" tabindex="-1"></a>internet <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-318"><a href="#cb78-318" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">INTERNET_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-319"><a href="#cb78-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-320"><a href="#cb78-320" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-321"><a href="#cb78-321" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>)</span>
<span id="cb78-322"><a href="#cb78-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-323"><a href="#cb78-323" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(radio, tv, llphone, mphone, computer, internet, </span>
<span id="cb78-324"><a href="#cb78-324" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb78-325"><a href="#cb78-325" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb78-326"><a href="#cb78-326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-327"><a href="#cb78-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-328"><a href="#cb78-328" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using Chloropleth Map for Distribution</span></span>
<span id="cb78-329"><a href="#cb78-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-330"><a href="#cb78-330" aria-hidden="true" tabindex="-1"></a><span class="fu">### Joining geospatial data with aspatial data </span></span>
<span id="cb78-331"><a href="#cb78-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-332"><a href="#cb78-332" aria-hidden="true" tabindex="-1"></a>Before being able to make a chloropleth map of the different variables across the different townships, we need to join our aspatial data to the geospatial data. The code chunk below using <span class="in">`left_join()`</span> to join 'shan_sf' and 'ict_derived' into one simple feature dataframe. The column <span class="in">`'TS_PCODE'`</span> is used as the unique identifier to join the objects.</span>
<span id="cb78-333"><a href="#cb78-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-336"><a href="#cb78-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-337"><a href="#cb78-337" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(shan_sf, </span>
<span id="cb78-338"><a href="#cb78-338" aria-hidden="true" tabindex="-1"></a>                     ict_derived, </span>
<span id="cb78-339"><a href="#cb78-339" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by=</span><span class="fu">c</span>(<span class="st">"TS_PCODE"</span><span class="ot">=</span><span class="st">"TS_PCODE"</span>))</span>
<span id="cb78-340"><a href="#cb78-340" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(shan_sf, <span class="st">"data/rds/shan_sf.rds"</span>)</span>
<span id="cb78-341"><a href="#cb78-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-342"><a href="#cb78-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-343"><a href="#cb78-343" aria-hidden="true" tabindex="-1"></a>We also right the resulting dataframe into an RDS file using <span class="in">`write_rds()`</span> .</span>
<span id="cb78-344"><a href="#cb78-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-345"><a href="#cb78-345" aria-hidden="true" tabindex="-1"></a><span class="fu">### Preparing the cloropleth map</span></span>
<span id="cb78-346"><a href="#cb78-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-347"><a href="#cb78-347" aria-hidden="true" tabindex="-1"></a>The code chunk below uses <span class="in">`qtm()`</span> function to quickly prepare the chloropleth map of <span class="in">`'RADIO_PR'`</span>.</span>
<span id="cb78-348"><a href="#cb78-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-351"><a href="#cb78-351" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-352"><a href="#cb78-352" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-353"><a href="#cb78-353" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf, <span class="st">"RADIO_PR"</span>, </span>
<span id="cb78-354"><a href="#cb78-354" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill.palette =</span> <span class="st">"RdPu"</span>)</span>
<span id="cb78-355"><a href="#cb78-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-356"><a href="#cb78-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-357"><a href="#cb78-357" aria-hidden="true" tabindex="-1"></a>The code chunk below shows both the chloropleth map of <span class="in">`'TT_HOUSEHOLDS'`</span> and <span class="in">`'RADIO'`</span> to show the relationship between number of households and number of households with radios.</span>
<span id="cb78-358"><a href="#cb78-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-361"><a href="#cb78-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-362"><a href="#cb78-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-363"><a href="#cb78-363" aria-hidden="true" tabindex="-1"></a>TT_HOUSEHOLDS.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span> </span>
<span id="cb78-364"><a href="#cb78-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"TT_HOUSEHOLDS"</span>,</span>
<span id="cb78-365"><a href="#cb78-365" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb78-366"><a href="#cb78-366" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>, </span>
<span id="cb78-367"><a href="#cb78-367" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Total households"</span>,</span>
<span id="cb78-368"><a href="#cb78-368" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdPu"</span>) <span class="sc">+</span> </span>
<span id="cb78-369"><a href="#cb78-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb78-370"><a href="#cb78-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-371"><a href="#cb78-371" aria-hidden="true" tabindex="-1"></a>RADIO.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span> </span>
<span id="cb78-372"><a href="#cb78-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"RADIO"</span>,</span>
<span id="cb78-373"><a href="#cb78-373" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb78-374"><a href="#cb78-374" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>,</span>
<span id="cb78-375"><a href="#cb78-375" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Number Radio "</span>,</span>
<span id="cb78-376"><a href="#cb78-376" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdPu"</span>) <span class="sc">+</span> </span>
<span id="cb78-377"><a href="#cb78-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb78-378"><a href="#cb78-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-379"><a href="#cb78-379" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(TT_HOUSEHOLDS.map, RADIO.map,</span>
<span id="cb78-380"><a href="#cb78-380" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb78-381"><a href="#cb78-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-382"><a href="#cb78-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-383"><a href="#cb78-383" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb78-384"><a href="#cb78-384" aria-hidden="true" tabindex="-1"></a><span class="fu">## 🌸 FIRST IMPRESSION!</span></span>
<span id="cb78-385"><a href="#cb78-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-386"><a href="#cb78-386" aria-hidden="true" tabindex="-1"></a>It seems that the townships with more households, also have more radios. But logically, of course there would be some sort of bias between higher households and having a higher number of radios. So we should look at the <span class="in">`'RADIO_PR'`</span> variable instead.</span>
<span id="cb78-387"><a href="#cb78-387" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb78-388"><a href="#cb78-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-391"><a href="#cb78-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-392"><a href="#cb78-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-393"><a href="#cb78-393" aria-hidden="true" tabindex="-1"></a>TT_HOUSEHOLDS.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span> </span>
<span id="cb78-394"><a href="#cb78-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"TT_HOUSEHOLDS"</span>,</span>
<span id="cb78-395"><a href="#cb78-395" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb78-396"><a href="#cb78-396" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>, </span>
<span id="cb78-397"><a href="#cb78-397" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Total households"</span>,</span>
<span id="cb78-398"><a href="#cb78-398" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdPu"</span>) <span class="sc">+</span> </span>
<span id="cb78-399"><a href="#cb78-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb78-400"><a href="#cb78-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-401"><a href="#cb78-401" aria-hidden="true" tabindex="-1"></a>RADIO_PR.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span> </span>
<span id="cb78-402"><a href="#cb78-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"RADIO_PR"</span>,</span>
<span id="cb78-403"><a href="#cb78-403" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb78-404"><a href="#cb78-404" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>,</span>
<span id="cb78-405"><a href="#cb78-405" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Radio PR"</span>,</span>
<span id="cb78-406"><a href="#cb78-406" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdPu"</span>) <span class="sc">+</span> </span>
<span id="cb78-407"><a href="#cb78-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb78-408"><a href="#cb78-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-409"><a href="#cb78-409" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(TT_HOUSEHOLDS.map, RADIO_PR.map,</span>
<span id="cb78-410"><a href="#cb78-410" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb78-411"><a href="#cb78-411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-412"><a href="#cb78-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-415"><a href="#cb78-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-416"><a href="#cb78-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-417"><a href="#cb78-417" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(RADIO.map, RADIO_PR.map,</span>
<span id="cb78-418"><a href="#cb78-418" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb78-419"><a href="#cb78-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-420"><a href="#cb78-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-421"><a href="#cb78-421" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb78-422"><a href="#cb78-422" aria-hidden="true" tabindex="-1"></a><span class="fu">## 🌸 NEW OBSERVATION!</span></span>
<span id="cb78-423"><a href="#cb78-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-424"><a href="#cb78-424" aria-hidden="true" tabindex="-1"></a>Comparing the chloropleth map of the number of radios to that of the radio PR, there is an obvious difference to the mapping visually. As an example, the top left township seems to have a lower number of household with radios, however when considering per 1000 households, it actually has one of the highest radio penetration rates. There are also townships with the opposite case where they have high number of radios but low radio penetration rates.</span>
<span id="cb78-425"><a href="#cb78-425" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb78-426"><a href="#cb78-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-427"><a href="#cb78-427" aria-hidden="true" tabindex="-1"></a><span class="fu"># Correlation Analysis </span></span>
<span id="cb78-428"><a href="#cb78-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-429"><a href="#cb78-429" aria-hidden="true" tabindex="-1"></a>Before we perform cluster analysis, it is important for us to ensure that the cluster variables are not highly correlated.</span>
<span id="cb78-430"><a href="#cb78-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-431"><a href="#cb78-431" aria-hidden="true" tabindex="-1"></a>The <span class="in">`cor()`</span> function is used to measure the correlation coefficient between all our variables from 'ict_derived'.</span>
<span id="cb78-432"><a href="#cb78-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-435"><a href="#cb78-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-436"><a href="#cb78-436" aria-hidden="true" tabindex="-1"></a>cluster_vars.cor <span class="ot">=</span> <span class="fu">cor</span>(ict_derived[,<span class="dv">12</span><span class="sc">:</span><span class="dv">17</span>])</span>
<span id="cb78-437"><a href="#cb78-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-438"><a href="#cb78-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-439"><a href="#cb78-439" aria-hidden="true" tabindex="-1"></a>The code chunk below uses the <span class="in">`corrplot.mixed()`</span> function to visualize and analyze the correlation of the input variables. It's a special function used for mixed visualization style, where we can set the visual methods for the lower and upper triangle separately.</span>
<span id="cb78-440"><a href="#cb78-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-443"><a href="#cb78-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-444"><a href="#cb78-444" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-445"><a href="#cb78-445" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 13</span></span>
<span id="cb78-446"><a href="#cb78-446" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(cluster_vars.cor,</span>
<span id="cb78-447"><a href="#cb78-447" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb78-448"><a href="#cb78-448" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper =</span> <span class="st">"number"</span>,</span>
<span id="cb78-449"><a href="#cb78-449" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.pos =</span> <span class="st">"lt"</span>,</span>
<span id="cb78-450"><a href="#cb78-450" aria-hidden="true" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">"l"</span>,</span>
<span id="cb78-451"><a href="#cb78-451" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.col =</span> <span class="st">"#cb6a82"</span>)</span>
<span id="cb78-452"><a href="#cb78-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-453"><a href="#cb78-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-454"><a href="#cb78-454" aria-hidden="true" tabindex="-1"></a>The correlation plot above shows that <span class="in">`'COMPUTER_PR'`</span> and <span class="in">`'INTERNET_PR'`</span> are highly correlated. (This makes sense, since if you think about it, when you get a computer, you also install internet connection.) This suggest that only one of them should be used in the cluster analysis instead of both.</span>
<span id="cb78-455"><a href="#cb78-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-456"><a href="#cb78-456" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hierarchy Cluster Analysis </span></span>
<span id="cb78-457"><a href="#cb78-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-458"><a href="#cb78-458" aria-hidden="true" tabindex="-1"></a><span class="fu">## Extracting Cluster Variables</span></span>
<span id="cb78-459"><a href="#cb78-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-460"><a href="#cb78-460" aria-hidden="true" tabindex="-1"></a>The code chunk below, uses <span class="in">`st_set_geometry()`</span> to extract the data.frame from the simple features object by setting it to **'NULL**'. Using <span class="in">`select()`</span> we get only the variables needed including the township name.</span>
<span id="cb78-461"><a href="#cb78-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-464"><a href="#cb78-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-465"><a href="#cb78-465" aria-hidden="true" tabindex="-1"></a>cluster_vars <span class="ot">&lt;-</span> shan_sf <span class="sc">%&gt;%</span></span>
<span id="cb78-466"><a href="#cb78-466" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-467"><a href="#cb78-467" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="st">"TS.x"</span>, <span class="st">"RADIO_PR"</span>, <span class="st">"TV_PR"</span>, <span class="st">"LLPHONE_PR"</span>, <span class="st">"MPHONE_PR"</span>, <span class="st">"COMPUTER_PR"</span>)</span>
<span id="cb78-468"><a href="#cb78-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-469"><a href="#cb78-469" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span>
<span id="cb78-470"><a href="#cb78-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-471"><a href="#cb78-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-472"><a href="#cb78-472" aria-hidden="true" tabindex="-1"></a>Because of the correlation analysis done earlier, we did not include <span class="in">`'INTERNET_PR'`</span> in our clustering variables.</span>
<span id="cb78-473"><a href="#cb78-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-474"><a href="#cb78-474" aria-hidden="true" tabindex="-1"></a>The code chunk below changes the row ID to township names.</span>
<span id="cb78-475"><a href="#cb78-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-478"><a href="#cb78-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-479"><a href="#cb78-479" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(cluster_vars) <span class="ot">&lt;-</span> cluster_vars<span class="sc">$</span><span class="st">"TS.x"</span></span>
<span id="cb78-480"><a href="#cb78-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-481"><a href="#cb78-481" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span>
<span id="cb78-482"><a href="#cb78-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-483"><a href="#cb78-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-484"><a href="#cb78-484" aria-hidden="true" tabindex="-1"></a>Instead of row numbers, we now have the township name as the unique identifier of each row. Now we can remove the column <span class="in">`'TS.'`</span> using the code chunk below.</span>
<span id="cb78-485"><a href="#cb78-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-488"><a href="#cb78-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-489"><a href="#cb78-489" aria-hidden="true" tabindex="-1"></a>shan_ict <span class="ot">&lt;-</span> <span class="fu">select</span>(cluster_vars, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb78-490"><a href="#cb78-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-491"><a href="#cb78-491" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shan_ict, <span class="dv">10</span>)</span>
<span id="cb78-492"><a href="#cb78-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-493"><a href="#cb78-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-494"><a href="#cb78-494" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Standardization </span></span>
<span id="cb78-495"><a href="#cb78-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-496"><a href="#cb78-496" aria-hidden="true" tabindex="-1"></a>In general, multiple variables will be used in cluster analysis. It is not unusual that the range of values we work with per variable will be different. For example, comparing percentages and counts. In order to avoid a cluster analysis result that is biased to clustering variables with large values, it is useful to standardise the input variables before performing cluster analysis.</span>
<span id="cb78-497"><a href="#cb78-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-498"><a href="#cb78-498" aria-hidden="true" tabindex="-1"></a><span class="fu">### Min-Max Standardization</span></span>
<span id="cb78-499"><a href="#cb78-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-500"><a href="#cb78-500" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb78-501"><a href="#cb78-501" aria-hidden="true" tabindex="-1"></a><span class="fu">## 📖 LECTURE REVIEW!</span></span>
<span id="cb78-502"><a href="#cb78-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-503"><a href="#cb78-503" aria-hidden="true" tabindex="-1"></a>This is a common standardization technique where the maximum value gets transformed into a 1 and the minimum value gets transformed to 0. All variable will then be scaled to to values that are decimal values between 0 and 1. The formula is as follows:</span>
<span id="cb78-504"><a href="#cb78-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-505"><a href="#cb78-505" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb78-506"><a href="#cb78-506" aria-hidden="true" tabindex="-1"></a> MM(x_{ij}) = \dfrac{x_{ij}-x_{min}}{x_{max}-x_{min}}</span>
<span id="cb78-507"><a href="#cb78-507" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb78-508"><a href="#cb78-508" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb78-509"><a href="#cb78-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-512"><a href="#cb78-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-513"><a href="#cb78-513" aria-hidden="true" tabindex="-1"></a>shan_ict.std <span class="ot">&lt;-</span> <span class="fu">normalize</span>(shan_ict)</span>
<span id="cb78-514"><a href="#cb78-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-515"><a href="#cb78-515" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan_ict.std)</span>
<span id="cb78-516"><a href="#cb78-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-517"><a href="#cb78-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-518"><a href="#cb78-518" aria-hidden="true" tabindex="-1"></a>According to the summary, the range of values for all PRs is between 0-1.</span>
<span id="cb78-519"><a href="#cb78-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-520"><a href="#cb78-520" aria-hidden="true" tabindex="-1"></a><span class="fu">### Z-score standardization </span></span>
<span id="cb78-521"><a href="#cb78-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-522"><a href="#cb78-522" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb78-523"><a href="#cb78-523" aria-hidden="true" tabindex="-1"></a><span class="fu">## 📖 LECTURE REVIEW!</span></span>
<span id="cb78-524"><a href="#cb78-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-525"><a href="#cb78-525" aria-hidden="true" tabindex="-1"></a>This is used for standardizing scores on the same scale by dividing a score's deviation by the standard deviation in a data set. This should be used when all variables are assumed to come from some normal distribution.</span>
<span id="cb78-526"><a href="#cb78-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-527"><a href="#cb78-527" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb78-528"><a href="#cb78-528" aria-hidden="true" tabindex="-1"></a>Z(x_{ij}) = \dfrac{x_{ij}-\bar{x}_j}{\sigma_j}</span>
<span id="cb78-529"><a href="#cb78-529" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb78-530"><a href="#cb78-530" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb78-531"><a href="#cb78-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-532"><a href="#cb78-532" aria-hidden="true" tabindex="-1"></a>The code chunk below uses the <span class="in">`scale()`</span> function to perform z-score standardization on the our clustering variables.</span>
<span id="cb78-533"><a href="#cb78-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-536"><a href="#cb78-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-537"><a href="#cb78-537" aria-hidden="true" tabindex="-1"></a>shan_ict.z <span class="ot">&lt;-</span> <span class="fu">scale</span>(shan_ict)</span>
<span id="cb78-538"><a href="#cb78-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-539"><a href="#cb78-539" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(shan_ict.z)</span>
<span id="cb78-540"><a href="#cb78-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-541"><a href="#cb78-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-542"><a href="#cb78-542" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb78-543"><a href="#cb78-543" aria-hidden="true" tabindex="-1"></a><span class="fu">## 🎮 LEVEL UP!</span></span>
<span id="cb78-544"><a href="#cb78-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-545"><a href="#cb78-545" aria-hidden="true" tabindex="-1"></a>**NEW FUNCTION UNLOCKED:** <span class="co">[</span><span class="ot">`describe()`</span><span class="co">](https://www.programmingr.com/statistics/describe-in-r/)</span></span>
<span id="cb78-546"><a href="#cb78-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-547"><a href="#cb78-547" aria-hidden="true" tabindex="-1"></a>This function accepts any data type and produces a contingency table supplying information about the data. The content depends on the data structure being analyzed. In this case, we're being given summary statistics for each variable.</span>
<span id="cb78-548"><a href="#cb78-548" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb78-549"><a href="#cb78-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-550"><a href="#cb78-550" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualizing the standardized clustering variables</span></span>
<span id="cb78-551"><a href="#cb78-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-554"><a href="#cb78-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-555"><a href="#cb78-555" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-556"><a href="#cb78-556" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-557"><a href="#cb78-557" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-558"><a href="#cb78-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-559"><a href="#cb78-559" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-560"><a href="#cb78-560" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>) <span class="sc">+</span></span>
<span id="cb78-561"><a href="#cb78-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values"</span>)</span>
<span id="cb78-562"><a href="#cb78-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-563"><a href="#cb78-563" aria-hidden="true" tabindex="-1"></a>shan_ict_s_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.std)</span>
<span id="cb78-564"><a href="#cb78-564" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_s_df, </span>
<span id="cb78-565"><a href="#cb78-565" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-566"><a href="#cb78-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-567"><a href="#cb78-567" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-568"><a href="#cb78-568" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>) <span class="sc">+</span></span>
<span id="cb78-569"><a href="#cb78-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max"</span>)</span>
<span id="cb78-570"><a href="#cb78-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-571"><a href="#cb78-571" aria-hidden="true" tabindex="-1"></a>shan_ict_z_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.z)</span>
<span id="cb78-572"><a href="#cb78-572" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_z_df, </span>
<span id="cb78-573"><a href="#cb78-573" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-574"><a href="#cb78-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb78-575"><a href="#cb78-575" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb78-576"><a href="#cb78-576" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"#e3879e"</span>) <span class="sc">+</span></span>
<span id="cb78-577"><a href="#cb78-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score"</span>)</span>
<span id="cb78-578"><a href="#cb78-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-579"><a href="#cb78-579" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb78-580"><a href="#cb78-580" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb78-581"><a href="#cb78-581" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb78-582"><a href="#cb78-582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-583"><a href="#cb78-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-584"><a href="#cb78-584" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb78-585"><a href="#cb78-585" aria-hidden="true" tabindex="-1"></a><span class="fu">## 🌸 NEW OBSERVATION!</span></span>
<span id="cb78-586"><a href="#cb78-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-587"><a href="#cb78-587" aria-hidden="true" tabindex="-1"></a>Visually, from first look, the weight of the count leans the left half of the graph. Applying the standardization techniques seemed to create a normal distribution where there's greatest count is towards the center of the graph.</span>
<span id="cb78-588"><a href="#cb78-588" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb78-589"><a href="#cb78-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-592"><a href="#cb78-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-593"><a href="#cb78-593" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-594"><a href="#cb78-594" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb78-595"><a href="#cb78-595" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-596"><a href="#cb78-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb78-597"><a href="#cb78-597" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"#e3879e"</span>) <span class="sc">+</span></span>
<span id="cb78-598"><a href="#cb78-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values"</span>)</span>
<span id="cb78-599"><a href="#cb78-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-600"><a href="#cb78-600" aria-hidden="true" tabindex="-1"></a>shan_ict_s_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.std)</span>
<span id="cb78-601"><a href="#cb78-601" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_s_df, </span>
<span id="cb78-602"><a href="#cb78-602" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-603"><a href="#cb78-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb78-604"><a href="#cb78-604" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"#e3879e"</span>) <span class="sc">+</span></span>
<span id="cb78-605"><a href="#cb78-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max"</span>)</span>
<span id="cb78-606"><a href="#cb78-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-607"><a href="#cb78-607" aria-hidden="true" tabindex="-1"></a>shan_ict_z_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.z)</span>
<span id="cb78-608"><a href="#cb78-608" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_z_df, </span>
<span id="cb78-609"><a href="#cb78-609" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb78-610"><a href="#cb78-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb78-611"><a href="#cb78-611" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"#e3879e"</span>) <span class="sc">+</span></span>
<span id="cb78-612"><a href="#cb78-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score Standardization"</span>)</span>
<span id="cb78-613"><a href="#cb78-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-614"><a href="#cb78-614" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb78-615"><a href="#cb78-615" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb78-616"><a href="#cb78-616" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb78-617"><a href="#cb78-617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-618"><a href="#cb78-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-619"><a href="#cb78-619" aria-hidden="true" tabindex="-1"></a><span class="fu">## Proximity Matrix </span></span>
<span id="cb78-620"><a href="#cb78-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-621"><a href="#cb78-621" aria-hidden="true" tabindex="-1"></a>The code chunk below uses <span class="in">`dist()`</span> to create a proximity matrix using the '**euclidean' method**. The function <span class="in">`dist()`</span> also supports maximum, manhattan, canberra, binary and minkowski methods.</span>
<span id="cb78-622"><a href="#cb78-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-625"><a href="#cb78-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-626"><a href="#cb78-626" aria-hidden="true" tabindex="-1"></a>proxmat <span class="ot">&lt;-</span> <span class="fu">dist</span>(shan_ict, <span class="at">method =</span> <span class="st">'euclidean'</span>)</span>
<span id="cb78-627"><a href="#cb78-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-628"><a href="#cb78-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-629"><a href="#cb78-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-630"><a href="#cb78-630" aria-hidden="true" tabindex="-1"></a>The first 18 rows and 6 columns of the proximity matrix are shown in the image below.</span>
<span id="cb78-631"><a href="#cb78-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-632"><a href="#cb78-632" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/paste-3CE98365.png)</span>{fig-align="center"}</span>
<span id="cb78-633"><a href="#cb78-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-634"><a href="#cb78-634" aria-hidden="true" tabindex="-1"></a><span class="fu">## Computing Hierarchical Clustering</span></span>
<span id="cb78-635"><a href="#cb78-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-636"><a href="#cb78-636" aria-hidden="true" tabindex="-1"></a>The code chunk below uses the function <span class="in">`hclust()`</span> to create clusters using the agglomeration method. The <span class="in">`'method'`</span> was set to 'ward.D', but the function support seven other algorithms namely: ward.D2, single, complete, average(UPGMA), mcquitty (WPGMA), median (WPGMC) and centroid (UPGMC).</span>
<span id="cb78-637"><a href="#cb78-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-640"><a href="#cb78-640" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-641"><a href="#cb78-641" aria-hidden="true" tabindex="-1"></a>hclust_ward <span class="ot">&lt;-</span> <span class="fu">hclust</span>(proxmat, <span class="at">method =</span> <span class="st">'ward.D'</span>)</span>
<span id="cb78-642"><a href="#cb78-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-643"><a href="#cb78-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-644"><a href="#cb78-644" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb78-645"><a href="#cb78-645" aria-hidden="true" tabindex="-1"></a><span class="fu">## ❔ I'M JUST WONDERING...</span></span>
<span id="cb78-646"><a href="#cb78-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-647"><a href="#cb78-647" aria-hidden="true" tabindex="-1"></a>**Why are there two WARD methods (ward.D and ward.D2)?**</span>
<span id="cb78-648"><a href="#cb78-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-649"><a href="#cb78-649" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"It basically boils down to the fact that the Ward algorithm is directly correctly implemented in just Ward2 (ward.D2), but Ward1 (ward.D) can also be used, if the Euclidean distances (from `dist()`) are squared before inputing them to the `hclust()` using the ward.D as the method.*</span></span>
<span id="cb78-650"><a href="#cb78-650" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb78-651"><a href="#cb78-651" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *For example, SPSS also implements Ward1, but warn the users that distances should be squared to obtain the Ward criterion. In such sense implementation of ward.D is not deprecated, and nonetheless it might be a good idea to retain it for backward compatibility."*</span></span>
<span id="cb78-652"><a href="#cb78-652" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb78-653"><a href="#cb78-653" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Source: </span><span class="co">[</span><span class="ot">Statistics Stack Exchange Question</span><span class="co">](https://stats.stackexchange.com/questions/109949/what-algorithm-does-ward-d-in-hclust-implement-if-it-is-not-wards-criterion)</span></span>
<span id="cb78-654"><a href="#cb78-654" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb78-655"><a href="#cb78-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-656"><a href="#cb78-656" aria-hidden="true" tabindex="-1"></a>We can then plot the tree using <span class="in">`plot()`</span> as shown in the code chunk below:</span>
<span id="cb78-657"><a href="#cb78-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-660"><a href="#cb78-660" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-661"><a href="#cb78-661" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-662"><a href="#cb78-662" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb78-663"><a href="#cb78-663" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">"#cb6a82"</span>)</span>
<span id="cb78-664"><a href="#cb78-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-665"><a href="#cb78-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-666"><a href="#cb78-666" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Optimal Clustering Algorithm</span></span>
<span id="cb78-667"><a href="#cb78-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-668"><a href="#cb78-668" aria-hidden="true" tabindex="-1"></a>One of the challenge in performing hierarchical clustering is to identify stronger clustering structures. The issue can be solved by using the <span class="in">`agnes()`</span> function. It functions like <span class="in">`hclust()`</span>, however, with <span class="in">`agnes()`</span> you can also get the **agglomerative coefficient**, which measures the amount of clustering structure found **and values closer to 1 suggest strong clustering structure**.</span>
<span id="cb78-669"><a href="#cb78-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-670"><a href="#cb78-670" aria-hidden="true" tabindex="-1"></a>The code chunk below will be used to compute the agglomerative coefficients of hierarchical clustering algorithms, namely 'average', 'single', 'complete' and 'ward'.</span>
<span id="cb78-671"><a href="#cb78-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-674"><a href="#cb78-674" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-675"><a href="#cb78-675" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb78-676"><a href="#cb78-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-677"><a href="#cb78-677" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb78-678"><a href="#cb78-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-679"><a href="#cb78-679" aria-hidden="true" tabindex="-1"></a>ac <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb78-680"><a href="#cb78-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">agnes</span>(shan_ict, <span class="at">method =</span> x)<span class="sc">$</span>ac</span>
<span id="cb78-681"><a href="#cb78-681" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-682"><a href="#cb78-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-683"><a href="#cb78-683" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(m, ac)</span>
<span id="cb78-684"><a href="#cb78-684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-685"><a href="#cb78-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-686"><a href="#cb78-686" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb78-687"><a href="#cb78-687" aria-hidden="true" tabindex="-1"></a><span class="fu">## 💻 CODE REVIEW!</span></span>
<span id="cb78-688"><a href="#cb78-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-689"><a href="#cb78-689" aria-hidden="true" tabindex="-1"></a>**NEW FUNCTION UNLOCKED: `map_dbl()`**</span>
<span id="cb78-690"><a href="#cb78-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-691"><a href="#cb78-691" aria-hidden="true" tabindex="-1"></a>This function loops through a double vector (first argument) and applies the function (second argument). It returns a list with the results.</span>
<span id="cb78-692"><a href="#cb78-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-693"><a href="#cb78-693" aria-hidden="true" tabindex="-1"></a>**NEW FUNCTION UNLOCKED: `names()`**</span>
<span id="cb78-694"><a href="#cb78-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-695"><a href="#cb78-695" aria-hidden="true" tabindex="-1"></a>This function is used to get or set the name of an Object. Length of value vector should be equal to the length of the object to be named.</span>
<span id="cb78-696"><a href="#cb78-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-697"><a href="#cb78-697" aria-hidden="true" tabindex="-1"></a>In the context of the code chunk above, we set the name of vector <span class="in">`'m'`</span> (which contains all the methods) for ease of visualizing the results. This means after mapping the <span class="in">`agnes()`</span> function to the vector, the results are also labelled.</span>
<span id="cb78-698"><a href="#cb78-698" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb78-699"><a href="#cb78-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-700"><a href="#cb78-700" aria-hidden="true" tabindex="-1"></a>With reference to the output above, we can see that **Ward\'s method provides the strongest clustering structure** among the four methods assessed. Hence, in the subsequent analysis, only Ward\'s method will be used.</span>
<span id="cb78-701"><a href="#cb78-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-702"><a href="#cb78-702" aria-hidden="true" tabindex="-1"></a><span class="fu">## Determining Optimal Clusters</span></span>
<span id="cb78-703"><a href="#cb78-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-704"><a href="#cb78-704" aria-hidden="true" tabindex="-1"></a>Another technical challenge faced by data analysts in performing clustering analysis is to determine the optimal clusters to retain.</span>
<span id="cb78-705"><a href="#cb78-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-706"><a href="#cb78-706" aria-hidden="true" tabindex="-1"></a>There are <span class="co">[</span><span class="ot">three</span><span class="co">](https://statweb.stanford.edu/~gwalther/gap)</span> commonly used methods to determine the optimal clusters, they are:</span>
<span id="cb78-707"><a href="#cb78-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-708"><a href="#cb78-708" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Elbow Method</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Elbow_method_(clustering))</span>
<span id="cb78-709"><a href="#cb78-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-710"><a href="#cb78-710" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Average Silhouette Method</span><span class="co">](https://www.sciencedirect.com/science/article/pii/0377042787901257?via%3Dihub)</span></span>
<span id="cb78-711"><a href="#cb78-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-712"><a href="#cb78-712" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Gap Statistic Method</span><span class="co">](http://www.web.stanford.edu/~hastie/Papers/gap.pdf)</span></span>
<span id="cb78-713"><a href="#cb78-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-714"><a href="#cb78-714" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using the Gap Statistic method</span></span>
<span id="cb78-715"><a href="#cb78-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-716"><a href="#cb78-716" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">**gap statistic**</span><span class="co">](http://www.web.stanford.edu/~hastie/Papers/gap.pdf)</span> compares the total within intra-cluster variation for different values of k with their expected values under null reference distribution of the data. The estimate of the optimal clusters will be value that maximize the gap statistic (i.e., that yields the largest gap statistic). This means that the clustering structure is far away from the random uniform distribution of points.</span>
<span id="cb78-717"><a href="#cb78-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-718"><a href="#cb78-718" aria-hidden="true" tabindex="-1"></a>To compute the gap statistic, <span class="co">[</span><span class="ot">`clusGap()`</span><span class="co">](https://www.rdocumentation.org/packages/cluster/versions/2.1.0/topics/clusGap)</span> of <span class="co">[</span><span class="ot">**cluster**</span><span class="co">](https://cran.r-project.org/web/packages/cluster/)</span> package will be used.</span>
<span id="cb78-719"><a href="#cb78-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-722"><a href="#cb78-722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-723"><a href="#cb78-723" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb78-724"><a href="#cb78-724" aria-hidden="true" tabindex="-1"></a>gap_stat <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(shan_ict, </span>
<span id="cb78-725"><a href="#cb78-725" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FUN =</span> hcut, </span>
<span id="cb78-726"><a href="#cb78-726" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nstart =</span> <span class="dv">25</span>, </span>
<span id="cb78-727"><a href="#cb78-727" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K.max =</span> <span class="dv">10</span>, </span>
<span id="cb78-728"><a href="#cb78-728" aria-hidden="true" tabindex="-1"></a>                    <span class="at">B =</span> <span class="dv">50</span>)</span>
<span id="cb78-729"><a href="#cb78-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-730"><a href="#cb78-730" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gap_stat, <span class="at">method =</span> <span class="st">"firstmax"</span>)</span>
<span id="cb78-731"><a href="#cb78-731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-732"><a href="#cb78-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-735"><a href="#cb78-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-736"><a href="#cb78-736" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-737"><a href="#cb78-737" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_gap_stat</span>(gap_stat, <span class="at">linecolor =</span> <span class="st">"#cb6a82"</span>)</span>
<span id="cb78-738"><a href="#cb78-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-739"><a href="#cb78-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-740"><a href="#cb78-740" aria-hidden="true" tabindex="-1"></a>With reference to the gap statistic graph above, the recommended number of clusters to retain is 1. However, it is not logical to retain only one cluster. By examining the gap statistic graph, the 6-cluster gives the largest gap statistic and should be the next best cluster to pick.</span>
<span id="cb78-741"><a href="#cb78-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-742"><a href="#cb78-742" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpreting Dendograms</span></span>
<span id="cb78-743"><a href="#cb78-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-744"><a href="#cb78-744" aria-hidden="true" tabindex="-1"></a>In the dendrogram displayed above, each leaf corresponds to one observation. As we move up the tree, observations that are similar to each other are combined into branches, which are themselves fused at a higher height.</span>
<span id="cb78-745"><a href="#cb78-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-746"><a href="#cb78-746" aria-hidden="true" tabindex="-1"></a>The height of the fusion, provided on the vertical axis, indicates the (dis)similarity between two observations. The higher the height of the fusion, the less similar the observations are. Note that, conclusions about the proximity of two observations can be drawn only based on the height where branches containing those two observations first are fused. We cannot use the proximity of two observations along the horizontal axis as a criteria of their similarity.</span>
<span id="cb78-747"><a href="#cb78-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-748"><a href="#cb78-748" aria-hidden="true" tabindex="-1"></a>It\'s also possible to draw the dendrogram with a border around the selected clusters by using <span class="in">`rect.hclust()`</span> of R stats. The argument *border* is used to specify the border colors for the rectangles.</span>
<span id="cb78-749"><a href="#cb78-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-752"><a href="#cb78-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-753"><a href="#cb78-753" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-754"><a href="#cb78-754" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">col =</span> <span class="st">"#cb6a82"</span>)</span>
<span id="cb78-755"><a href="#cb78-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-756"><a href="#cb78-756" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(hclust_ward, </span>
<span id="cb78-757"><a href="#cb78-757" aria-hidden="true" tabindex="-1"></a>            <span class="at">k =</span> <span class="dv">6</span>, </span>
<span id="cb78-758"><a href="#cb78-758" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb78-759"><a href="#cb78-759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-760"><a href="#cb78-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-761"><a href="#cb78-761" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visually-driven Hierarchal Clustering Analysis</span></span>
<span id="cb78-762"><a href="#cb78-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-763"><a href="#cb78-763" aria-hidden="true" tabindex="-1"></a><span class="fu">### Transforming the data frame into a matrix</span></span>
<span id="cb78-764"><a href="#cb78-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-765"><a href="#cb78-765" aria-hidden="true" tabindex="-1"></a>The data was loaded into a data frame, but it has to be a data matrix to make a heatmap.</span>
<span id="cb78-766"><a href="#cb78-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-767"><a href="#cb78-767" aria-hidden="true" tabindex="-1"></a>The code chunk below will be used to transform 'shan_ict' data frame into a data matrix.</span>
<span id="cb78-768"><a href="#cb78-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-771"><a href="#cb78-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-772"><a href="#cb78-772" aria-hidden="true" tabindex="-1"></a>shan_ict_mat <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(shan_ict)</span>
<span id="cb78-773"><a href="#cb78-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-774"><a href="#cb78-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-775"><a href="#cb78-775" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plotting interactive cluster heatmap using `heatmaply()`</span></span>
<span id="cb78-776"><a href="#cb78-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-777"><a href="#cb78-777" aria-hidden="true" tabindex="-1"></a>In the code chunk below, we use <span class="in">`heatmaply()`</span> to build an **interactive** cluster heatmap. By default, <span class="in">`normalize()`</span> centers and scales the matrix values.</span>
<span id="cb78-778"><a href="#cb78-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-781"><a href="#cb78-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-782"><a href="#cb78-782" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-783"><a href="#cb78-783" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 14</span></span>
<span id="cb78-784"><a href="#cb78-784" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmaply</span>(<span class="fu">normalize</span>(shan_ict_mat),</span>
<span id="cb78-785"><a href="#cb78-785" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv=</span><span class="cn">NA</span>,</span>
<span id="cb78-786"><a href="#cb78-786" aria-hidden="true" tabindex="-1"></a>          <span class="at">dist_method =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb78-787"><a href="#cb78-787" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclust_method =</span> <span class="st">"ward.D"</span>,</span>
<span id="cb78-788"><a href="#cb78-788" aria-hidden="true" tabindex="-1"></a>          <span class="at">seriate =</span> <span class="st">"OLO"</span>,</span>
<span id="cb78-789"><a href="#cb78-789" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> RdPu,</span>
<span id="cb78-790"><a href="#cb78-790" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_row =</span> <span class="dv">6</span>,</span>
<span id="cb78-791"><a href="#cb78-791" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">200</span>,<span class="dv">60</span>,<span class="cn">NA</span>),</span>
<span id="cb78-792"><a href="#cb78-792" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_row =</span> <span class="dv">4</span>,</span>
<span id="cb78-793"><a href="#cb78-793" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_col =</span> <span class="dv">5</span>,</span>
<span id="cb78-794"><a href="#cb78-794" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">"Geographic Segmentation of Shan State by ICT indicators"</span>,</span>
<span id="cb78-795"><a href="#cb78-795" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"ICT Indicators"</span>,</span>
<span id="cb78-796"><a href="#cb78-796" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Townships of Shan State"</span></span>
<span id="cb78-797"><a href="#cb78-797" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb78-798"><a href="#cb78-798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-799"><a href="#cb78-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-800"><a href="#cb78-800" aria-hidden="true" tabindex="-1"></a>By hovering over the blocks, we can see the values of the variables to have a more specific and quantifiable idea of the cluster definitions.</span>
<span id="cb78-801"><a href="#cb78-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-802"><a href="#cb78-802" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mapping the Clusters </span></span>
<span id="cb78-803"><a href="#cb78-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-804"><a href="#cb78-804" aria-hidden="true" tabindex="-1"></a>With closed examination of the dendragram above, we have decided to retain six clusters.</span>
<span id="cb78-805"><a href="#cb78-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-806"><a href="#cb78-806" aria-hidden="true" tabindex="-1"></a>The function <span class="in">`cutree()`</span> will be used in the code chunk below to derive a 6-cluster model. It takes the resulting tree from <span class="in">`hclust()`</span> and splits it to several groups by specifying the desired number of groups (<span class="in">`'k'`</span> argument) or the cut heights.</span>
<span id="cb78-807"><a href="#cb78-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-810"><a href="#cb78-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-811"><a href="#cb78-811" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(hclust_ward, <span class="at">k=</span><span class="dv">6</span>))</span>
<span id="cb78-812"><a href="#cb78-812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-813"><a href="#cb78-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-814"><a href="#cb78-814" aria-hidden="true" tabindex="-1"></a>In order to visualize the clusters, the '*groups'* object needs to be appended onto the '*shan_sf'* simple feature object.</span>
<span id="cb78-815"><a href="#cb78-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-818"><a href="#cb78-818" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-819"><a href="#cb78-819" aria-hidden="true" tabindex="-1"></a>shan_sf_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb78-820"><a href="#cb78-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span>
<span id="cb78-821"><a href="#cb78-821" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-822"><a href="#cb78-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-823"><a href="#cb78-823" aria-hidden="true" tabindex="-1"></a>The code chunk below uses <span class="in">`qtm()`</span> to plot the chloropleth map colored based on cluster groupings.</span>
<span id="cb78-824"><a href="#cb78-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-827"><a href="#cb78-827" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-828"><a href="#cb78-828" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-829"><a href="#cb78-829" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_cluster, <span class="st">"CLUSTER"</span>, <span class="at">fill.palette =</span> <span class="st">"Pastel1"</span>)</span>
<span id="cb78-830"><a href="#cb78-830" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-831"><a href="#cb78-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-832"><a href="#cb78-832" aria-hidden="true" tabindex="-1"></a>The choropleth map above reveals the clusters are very fragmented. The is one of the major limitation when non-spatial clustering algorithm such as hierarchical cluster analysis method is used.</span>
<span id="cb78-833"><a href="#cb78-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-834"><a href="#cb78-834" aria-hidden="true" tabindex="-1"></a><span class="fu"># Spatially Constrained Clustering: SKATER Approach</span></span>
<span id="cb78-835"><a href="#cb78-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-836"><a href="#cb78-836" aria-hidden="true" tabindex="-1"></a>SKATER stands for "**S**patial **K**luster **A**nalysis by **T**ree **E**dge **R**emoval" and it is a regionalization method for clustering based on the location by spatial autocorrelation and spatial patterns. It constructs the minimum spanning tree from the adjacency matrix and cuts the tree to achieve maximum internal homogeneity.</span>
<span id="cb78-837"><a href="#cb78-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-838"><a href="#cb78-838" aria-hidden="true" tabindex="-1"></a><span class="fu">## Converting to SpatialPolygonsDataFrame</span></span>
<span id="cb78-839"><a href="#cb78-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-840"><a href="#cb78-840" aria-hidden="true" tabindex="-1"></a>The <span class="in">`skater()`</span> function only supports sp objects like SpatialPolygonDataFrame. This is because the <span class="in">`sf`</span> package was created later than the when the <span class="in">`skater()`</span> function was made, so there is no support yet for simple features objects.</span>
<span id="cb78-841"><a href="#cb78-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-842"><a href="#cb78-842" aria-hidden="true" tabindex="-1"></a>The code chunk uses <span class="in">`as_Spatial()`</span> function converts '*shan_sf*' to a SpatialPolygonDataFrame called '*shan_sp'.*</span>
<span id="cb78-843"><a href="#cb78-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-846"><a href="#cb78-846" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-847"><a href="#cb78-847" aria-hidden="true" tabindex="-1"></a>shan_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(shan_sf)</span>
<span id="cb78-848"><a href="#cb78-848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-849"><a href="#cb78-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-850"><a href="#cb78-850" aria-hidden="true" tabindex="-1"></a><span class="fu">## Computing Neighbor List</span></span>
<span id="cb78-851"><a href="#cb78-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-852"><a href="#cb78-852" aria-hidden="true" tabindex="-1"></a>Since we've established that the SKATER method takes into account spatial patterns, we need to figure out the different neighbors of each feature.</span>
<span id="cb78-853"><a href="#cb78-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-856"><a href="#cb78-856" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-857"><a href="#cb78-857" aria-hidden="true" tabindex="-1"></a>shan.nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(shan_sp)</span>
<span id="cb78-858"><a href="#cb78-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-859"><a href="#cb78-859" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan.nb)</span>
<span id="cb78-860"><a href="#cb78-860" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-861"><a href="#cb78-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-862"><a href="#cb78-862" aria-hidden="true" tabindex="-1"></a>The code chunk below produces a plot that shows the links made between the neighboring townships.</span>
<span id="cb78-863"><a href="#cb78-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-866"><a href="#cb78-866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-867"><a href="#cb78-867" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-868"><a href="#cb78-868" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, </span>
<span id="cb78-869"><a href="#cb78-869" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="fu">grey</span>(.<span class="dv">5</span>))</span>
<span id="cb78-870"><a href="#cb78-870" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan.nb, </span>
<span id="cb78-871"><a href="#cb78-871" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb78-872"><a href="#cb78-872" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"#cb6a82"</span>, </span>
<span id="cb78-873"><a href="#cb78-873" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb78-874"><a href="#cb78-874" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-875"><a href="#cb78-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-876"><a href="#cb78-876" aria-hidden="true" tabindex="-1"></a><span class="fu">## Computing Minimum Spanning Tree</span></span>
<span id="cb78-877"><a href="#cb78-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-878"><a href="#cb78-878" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculating edge costs</span></span>
<span id="cb78-879"><a href="#cb78-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-880"><a href="#cb78-880" aria-hidden="true" tabindex="-1"></a>The code chunk below uses <span class="in">`nbcosts()`</span> to compute the cost of each edge given the neighbors list and clustering variables.</span>
<span id="cb78-881"><a href="#cb78-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-884"><a href="#cb78-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-885"><a href="#cb78-885" aria-hidden="true" tabindex="-1"></a>lcosts <span class="ot">&lt;-</span> <span class="fu">nbcosts</span>(shan.nb, shan_ict)</span>
<span id="cb78-886"><a href="#cb78-886" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-887"><a href="#cb78-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-888"><a href="#cb78-888" aria-hidden="true" tabindex="-1"></a>For each observation, this gives the pairwise dissimilarity between its values on the five variables and the values for the neighbouring observation (from the neighbor list). Basically, this is the notion of a generalised weight for a spatial weights matrix.</span>
<span id="cb78-889"><a href="#cb78-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-890"><a href="#cb78-890" aria-hidden="true" tabindex="-1"></a>Next, We will incorporate these costs into a weights object in the same way as we did in the calculation of inverse of distance weights. In other words, we will convert the neighbor list to a list weights object by specifying the just computed <span class="in">`'lcosts'`</span> as the weights.</span>
<span id="cb78-891"><a href="#cb78-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-894"><a href="#cb78-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-895"><a href="#cb78-895" aria-hidden="true" tabindex="-1"></a>shan.w <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(shan.nb, </span>
<span id="cb78-896"><a href="#cb78-896" aria-hidden="true" tabindex="-1"></a>                   lcosts, </span>
<span id="cb78-897"><a href="#cb78-897" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"B"</span>)</span>
<span id="cb78-898"><a href="#cb78-898" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan.w)</span>
<span id="cb78-899"><a href="#cb78-899" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-900"><a href="#cb78-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-901"><a href="#cb78-901" aria-hidden="true" tabindex="-1"></a><span class="fu">### Computing minimum spanning tree</span></span>
<span id="cb78-902"><a href="#cb78-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-903"><a href="#cb78-903" aria-hidden="true" tabindex="-1"></a>The code chunk below uses the function <span class="in">`mstree()`</span> to compute for the minimum spanning tree.</span>
<span id="cb78-904"><a href="#cb78-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-907"><a href="#cb78-907" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-908"><a href="#cb78-908" aria-hidden="true" tabindex="-1"></a>shan.mst <span class="ot">&lt;-</span> <span class="fu">mstree</span>(shan.w)</span>
<span id="cb78-909"><a href="#cb78-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-910"><a href="#cb78-910" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(shan.mst)</span>
<span id="cb78-911"><a href="#cb78-911" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-912"><a href="#cb78-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-913"><a href="#cb78-913" aria-hidden="true" tabindex="-1"></a>The <span class="in">`class()`</span> function tells us the class of the object. This tells us 'shan.mst' is an mst object that inherits from a matrix object.</span>
<span id="cb78-914"><a href="#cb78-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-917"><a href="#cb78-917" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-918"><a href="#cb78-918" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(shan.mst)</span>
<span id="cb78-919"><a href="#cb78-919" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-920"><a href="#cb78-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-921"><a href="#cb78-921" aria-hidden="true" tabindex="-1"></a>The dimension is 54 and not 55 (which is the number of townships) because the minimum spanning tree consists of n-1 edges (links) in order to traverse all nods.</span>
<span id="cb78-922"><a href="#cb78-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-925"><a href="#cb78-925" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-926"><a href="#cb78-926" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shan.mst)</span>
<span id="cb78-927"><a href="#cb78-927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-928"><a href="#cb78-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-929"><a href="#cb78-929" aria-hidden="true" tabindex="-1"></a>The plot method for the MST include a way to show the observation numbers of the nodes in addition to the edge. As before, we plot this together with the township boundaries. We can see how the initial neighbour list is simplified to just one edge connecting each of the nodes, while passing through all the nodes.</span>
<span id="cb78-930"><a href="#cb78-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-933"><a href="#cb78-933" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-934"><a href="#cb78-934" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-935"><a href="#cb78-935" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb78-936"><a href="#cb78-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-937"><a href="#cb78-937" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.mst</span>(shan.mst, </span>
<span id="cb78-938"><a href="#cb78-938" aria-hidden="true" tabindex="-1"></a>         <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb78-939"><a href="#cb78-939" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"#cb6a82"</span>, </span>
<span id="cb78-940"><a href="#cb78-940" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.lab=</span><span class="fl">0.7</span>, </span>
<span id="cb78-941"><a href="#cb78-941" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.circles=</span><span class="fl">0.005</span>, </span>
<span id="cb78-942"><a href="#cb78-942" aria-hidden="true" tabindex="-1"></a>         <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb78-943"><a href="#cb78-943" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-944"><a href="#cb78-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-945"><a href="#cb78-945" aria-hidden="true" tabindex="-1"></a><span class="fu">## Computing Spatial Constrained Clusters using the SKATER Method</span></span>
<span id="cb78-946"><a href="#cb78-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-947"><a href="#cb78-947" aria-hidden="true" tabindex="-1"></a>The code chunk below computes spatially constrained clusters using <span class="in">`skater()`</span> function.</span>
<span id="cb78-948"><a href="#cb78-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-951"><a href="#cb78-951" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-952"><a href="#cb78-952" aria-hidden="true" tabindex="-1"></a>clust6 <span class="ot">&lt;-</span> <span class="fu">skater</span>(<span class="at">edges =</span> shan.mst[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb78-953"><a href="#cb78-953" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> shan_ict, </span>
<span id="cb78-954"><a href="#cb78-954" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"euclidean"</span>, </span>
<span id="cb78-955"><a href="#cb78-955" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncuts =</span> <span class="dv">5</span>)</span>
<span id="cb78-956"><a href="#cb78-956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-957"><a href="#cb78-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-958"><a href="#cb78-958" aria-hidden="true" tabindex="-1"></a>The <span class="in">`skater()`</span> takes three mandatory arguments: - the first two columns of the MST matrix (i.e.&nbsp;not the cost), - the data matrix (to update the costs as units are being grouped), and - the number of cuts **(which is one less than the number of clusters**).</span>
<span id="cb78-959"><a href="#cb78-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-962"><a href="#cb78-962" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-963"><a href="#cb78-963" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(clust6)</span>
<span id="cb78-964"><a href="#cb78-964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-965"><a href="#cb78-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-966"><a href="#cb78-966" aria-hidden="true" tabindex="-1"></a>We can check the cluster assignment by using the code chunk below.</span>
<span id="cb78-967"><a href="#cb78-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-970"><a href="#cb78-970" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-971"><a href="#cb78-971" aria-hidden="true" tabindex="-1"></a>ccs6 <span class="ot">&lt;-</span> clust6<span class="sc">$</span>groups</span>
<span id="cb78-972"><a href="#cb78-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-973"><a href="#cb78-973" aria-hidden="true" tabindex="-1"></a>ccs6</span>
<span id="cb78-974"><a href="#cb78-974" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-975"><a href="#cb78-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-976"><a href="#cb78-976" aria-hidden="true" tabindex="-1"></a>We can find out how many observations are in each cluster by means of the <span class="in">`table()`</span> command.</span>
<span id="cb78-977"><a href="#cb78-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-980"><a href="#cb78-980" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-981"><a href="#cb78-981" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ccs6)</span>
<span id="cb78-982"><a href="#cb78-982" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-983"><a href="#cb78-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-984"><a href="#cb78-984" aria-hidden="true" tabindex="-1"></a>Lastly, we can also plot the pruned tree that shows the five clusters on top of the township area.</span>
<span id="cb78-985"><a href="#cb78-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-988"><a href="#cb78-988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-989"><a href="#cb78-989" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-990"><a href="#cb78-990" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb78-991"><a href="#cb78-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-992"><a href="#cb78-992" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clust6, </span>
<span id="cb78-993"><a href="#cb78-993" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb78-994"><a href="#cb78-994" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab=</span>.<span class="dv">7</span>,</span>
<span id="cb78-995"><a href="#cb78-995" aria-hidden="true" tabindex="-1"></a>     <span class="at">groups.colors=</span><span class="fu">c</span>(<span class="st">"#e3879e"</span>,<span class="st">"#af7cb6"</span>,<span class="st">"#a7c7e7"</span>, <span class="st">"#C1E1C1"</span>, <span class="st">"red"</span>),</span>
<span id="cb78-996"><a href="#cb78-996" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.circles=</span><span class="fl">0.005</span>, </span>
<span id="cb78-997"><a href="#cb78-997" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb78-998"><a href="#cb78-998" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-999"><a href="#cb78-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-1000"><a href="#cb78-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualizing Spatially Constrained Clusters</span></span>
<span id="cb78-1001"><a href="#cb78-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-1004"><a href="#cb78-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-1005"><a href="#cb78-1005" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-1006"><a href="#cb78-1006" aria-hidden="true" tabindex="-1"></a>groups_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(clust6<span class="sc">$</span>groups)</span>
<span id="cb78-1007"><a href="#cb78-1007" aria-hidden="true" tabindex="-1"></a>shan_sf_spatialcluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf_cluster, <span class="fu">as.factor</span>(groups_mat)) <span class="sc">%&gt;%</span></span>
<span id="cb78-1008"><a href="#cb78-1008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">SP_CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.factor.groups_mat.</span><span class="st">`</span>)</span>
<span id="cb78-1009"><a href="#cb78-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-1010"><a href="#cb78-1010" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_spatialcluster, <span class="st">"SP_CLUSTER"</span>, <span class="at">fill.palette =</span> <span class="st">"Pastel1"</span>)</span>
<span id="cb78-1011"><a href="#cb78-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-1012"><a href="#cb78-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-1013"><a href="#cb78-1013" aria-hidden="true" tabindex="-1"></a>For easy comparison, it will be better to place both the hierarchical clustering and spatially constrained hierarchical clustering maps next to each other.</span>
<span id="cb78-1014"><a href="#cb78-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-1017"><a href="#cb78-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb78-1018"><a href="#cb78-1018" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb78-1019"><a href="#cb78-1019" aria-hidden="true" tabindex="-1"></a>hclust.map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(shan_sf_cluster,</span>
<span id="cb78-1020"><a href="#cb78-1020" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"CLUSTER"</span>,</span>
<span id="cb78-1021"><a href="#cb78-1021" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill.palette =</span> <span class="st">"Pastel1"</span>) <span class="sc">+</span> </span>
<span id="cb78-1022"><a href="#cb78-1022" aria-hidden="true" tabindex="-1"></a>              <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb78-1023"><a href="#cb78-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-1024"><a href="#cb78-1024" aria-hidden="true" tabindex="-1"></a>shclust.map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(shan_sf_spatialcluster,</span>
<span id="cb78-1025"><a href="#cb78-1025" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SP_CLUSTER"</span>,</span>
<span id="cb78-1026"><a href="#cb78-1026" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill.palette =</span> <span class="st">"Pastel1"</span>) <span class="sc">+</span> </span>
<span id="cb78-1027"><a href="#cb78-1027" aria-hidden="true" tabindex="-1"></a>              <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb78-1028"><a href="#cb78-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-1029"><a href="#cb78-1029" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(hclust.map, </span>
<span id="cb78-1030"><a href="#cb78-1030" aria-hidden="true" tabindex="-1"></a>             shclust.map,</span>
<span id="cb78-1031"><a href="#cb78-1031" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, </span>
<span id="cb78-1032"><a href="#cb78-1032" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb78-1033"><a href="#cb78-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-1034"><a href="#cb78-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb78-1035"><a href="#cb78-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-1036"><a href="#cb78-1036" aria-hidden="true" tabindex="-1"></a>The 'SP_CLUSTER' chloropleth map is a lot more pleasing to the eyes, no?</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>